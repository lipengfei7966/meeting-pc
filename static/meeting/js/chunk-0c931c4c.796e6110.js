(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0c931c4c"],{"34b2":function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{class:e.isCheck?"see_demand box":"create_demand box"},[t("div",{staticClass:"path"},[t("ul",[t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.$router.replace({path:"/DMCeventlist"})}}},[e._v("我的会议")]),e.$route.query.type?t("li",{staticStyle:{color:"#7c7f82"}},[e._v(">")]):e._e(),e.$route.query.type?t("li",{staticStyle:{color:"#409EFF",cursor:"pointer"},on:{click:function(t){return e.$router.replace({path:`/DMCEventDetail?id=${e.$route.query.id}&name=${e.$route.query.name}&eventSearchType=${e.$route.query.eventSearchType}`})}}},[e._v("会议详情 ("+e._s(e.$route.query.name)+")")]):e._e(),t("li",{staticStyle:{color:"#7c7f82"}},[e._v(">")]),e.$route.query.type?t("li",{staticStyle:{color:"#409EFF",cursor:"pointer"},on:{click:function(t){return e.$router.replace({path:`/DMCcreateEvent?id=${e.$route.query.id}&name=${e.$route.query.name}&eventSearchType=${e.$route.query.eventSearchType}&type=${e.$route.query.type}`})}}},[e._v("创建会议")]):e._e(),t("li",{staticStyle:{color:"#7c7f82"}},[e._v(">")]),t("li",{staticStyle:{color:"#7c7f82"}},[e._v("采购需求")])],1)]),e.isCheck?e._e():t("div",{staticClass:"edit_base_info"},[e._v(" 已根据会议基本信息的会议时间自动匹配好需求可选日期，若有误请您先 "),t("span",{on:{click:e.goEdit}},[e._v("修改会议基本信息>")])]),t("div",{staticClass:"demand_title"}),t("div",{staticClass:"guestRoom_demand"},[e._m(0),e.dateArr.length?t("room",{ref:"room",attrs:{dateArr:e.roomDate,outDate:e.outDate,isDMC:!0,isCheck:e.isCheck}}):e._e(),e.dateArr.length?t("event",{ref:"event",attrs:{dateArr:e.dateArr,swingList:e.swingList,isDMC:!0,isCheck:e.isCheck}}):e._e(),e.dateArr.length?t("foodDemand",{ref:"food",attrs:{dateArr:e.allDate,foodList:e.foodList,isDMC:!0,isCheck:e.isCheck}}):e._e(),e.dateArr.length?t("foodOutDemand",{ref:"foodOut",attrs:{dateArr:e.allDate,foodList:e.foodList,isDMC:!0,isCheck:e.isCheck}}):e._e(),e.dateArr.length?t("intercity",{ref:"intercity",attrs:{dateArr:e.allDate,trafficType:e.trafficType,isDMC:!0,isCheck:e.isCheck}}):e._e(),e.dateArr.length?t("car",{ref:"car",attrs:{carType:e.carType,dateArr:e.allDate,purposeList:e.purposeList,isDMC:!0,isCheck:e.isCheck}}):e._e(),t("other",{ref:"other",attrs:{isDMC:!0,isCheck:e.isCheck}})],1),t("div",{staticClass:"sub_part"},[e.isCheck?t("el-button",{staticClass:"sub_btn back",attrs:{type:"primary",plain:""},on:{click:e.backPrePage}},[t("img",{attrs:{src:i("5f25"),alt:""}}),e._v("  返回 ")]):e._e(),e.isCheck?e._e():t("el-button",{staticClass:"sub_btn",on:{click:e.backPrePage}},[t("span",{staticClass:"el-icon-circle-close"}),e._v(" 取消 ")]),e.isCheck?e._e():t("el-button",{staticClass:"sub_btn",attrs:{type:"primary"},on:{click:function(t){return e.subTap(0)}}},[t("span",{staticClass:"el-icon-download"}),e._v(" 保存 ")])],1),t("el-dialog",{attrs:{title:"保存成功",visible:e.nextDialog,align:"center",top:"200px"},on:{"update:visible":function(t){e.nextDialog=t}}},[t("el-table",{ref:"multipleTable",staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{data:e.tableData,fit:"","show-header":!1,"tooltip-effect":"dark"},on:{"row-click":e.checkedRow,"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection"}}),t("el-table-column",{attrs:{label:"询价单"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" 询价单号【"+e._s(t.row.inquiry_sheet_code)+"】 ")]}}])}),t("el-table-column",{attrs:{prop:"company_name",label:"公司","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"total_amount",label:"金额",width:"100"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",{staticStyle:{color:"#f91"}},[e._v("￥"+e._s(e.positiveFloat(i.row.total_amount)))])]}}])}),t("el-table-column",{attrs:{prop:"name",width:"100",label:"状态","show-overflow-tooltip":""}})],1),t("el-button",{staticClass:"mar_lr20",attrs:{size:"small",type:"primary"},on:{click:function(t){return e.goNext(1)}}},[e._v("生成新询价单，立即报价")]),t("el-button",{staticClass:"mar_lr20",attrs:{size:"small",type:"primary"},on:{click:function(t){return e.goNext(2)}}},[e._v("更新询价单，更新报价")]),t("el-button",{attrs:{size:"small"},on:{click:function(t){return e.goNext(5)}}},[e._v("返回会议详情")])],1),t("el-dialog",{attrs:{visible:e.isDemandHotel,width:"30%",align:"center"},on:{"update:visible":function(t){e.isDemandHotel=t}}},[t("span",[e._v("请选择会议服务商进行采购的方式")]),t("span",{staticClass:"dialog-footer flex_row justify_center",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.goNext(3)}}},[e._v("立即采购(不含酒店)")]),t("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.goNext(4)}}},[e._v("立即采购(含酒店)")])],1)]),t("el-dialog",{attrs:{title:"请完善信息",visible:e.perfectDialog,align:"left",top:"200px"},on:{"update:visible":function(t){e.perfectDialog=t}}},[t("p",{staticStyle:{"font-size":"16px","line-height":"20px"},domProps:{innerHTML:e._s(e.perfectMsg)}})])],1)},s=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"demand_item_title"},[t("span",[e._v("填写会议采购需求")]),e._v("Event Requirements ")])}],a=i("6813"),o=i("2905"),n=i("e99c"),c=i("e885"),l=i("a365"),d=function(){var e=this,t=e._self._c;return t("div",{staticClass:"car"},[t("div",{staticClass:"demand_item"},[t("div",{staticClass:"demand_top flex_row justify_between"},[t("div",{staticClass:"demand_name flex_row align_center"},[t("h2",{staticStyle:{"margin-right":"20px"}},[e._v("地面交通")]),t("el-switch",{model:{value:e.is_car_rental,callback:function(t){e.is_car_rental=t},expression:"is_car_rental"}})],1)]),t("div",{directives:[{name:"show",rawName:"v-show",value:"1"==e.is_car_rental,expression:"is_car_rental == '1'"}]},[e._l(e.carList,(function(i,r){return t("div",[t("div",{staticClass:"flex_row"},[e.isCheck?e._e():t("div",{staticClass:"demand_date mar_t20 mar_l20"},[t("span",[e._v("日期")]),t("el-select",{attrs:{size:"small"},on:{change:e.selectDateTap},model:{value:i.car_date,callback:function(t){e.$set(i,"car_date",t)},expression:"item.car_date"}},e._l(e.dateArr,(function(i,r){return t("el-option",{attrs:{disabled:e.getDisTap(i),label:i,value:i}})})),1)],1),t("el-button",{staticClass:"mar_20 add_new_item",attrs:{type:"text",size:"medium"},on:{click:function(t){return e.addOtherCar(r)}}},[e._v("添加该日交通需求 ")])],1),t("el-table",{attrs:{border:"",data:i.car}},[e.isCheck?t("el-table-column",{attrs:{label:"日期",width:"180",align:"center"}},[[t("p",{staticClass:"text_left"},[t("span",[e._v(e._s(i.car_date))])])]],2):e._e(),t("el-table-column",{attrs:{label:"用车目的",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[e.isCheck?t("p",{staticClass:"text_left"},e._l(e.purposeList,(function(r){return t("span",{directives:[{name:"show",rawName:"v-show",value:r.key==i.row.purpose,expression:"item.key == scope.row.purpose"}],key:r.key},[e._v(e._s(r.value))])})),0):e._e(),e.isCheck?e._e():t("el-select",{staticClass:"demand_120",attrs:{size:"small"},model:{value:i.row.purpose,callback:function(t){e.$set(i.row,"purpose",t)},expression:"scope.row.purpose"}},e._l(e.purposeList,(function(e){return t("el-option",{attrs:{label:e.value,value:e.key}})})),1)]}}],null,!0)}),t("el-table-column",{attrs:{label:"用车类型",prop:"is_important",width:e.isCheck?180:140,align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[e.isCheck?t("p",{staticClass:"text_left"},e._l(e.carType,(function(r){return t("span",{directives:[{name:"show",rawName:"v-show",value:r.key==i.row.vehicle_type,expression:"item.key == scope.row.vehicle_type"}],key:r.key},[e._v(e._s(r.value))])})),0):e._e(),e.isCheck?e._e():t("el-select",{staticClass:"demand_120",attrs:{size:"small"},on:{change:function(t){return e.selectTraffic(i.row.vehicle_type)}},model:{value:i.row.vehicle_type,callback:function(t){e.$set(i.row,"vehicle_type",t)},expression:"scope.row.vehicle_type"}},e._l(e.carType,(function(e){return t("el-option",{attrs:{label:e.value,value:e.key}})})),1)]}}],null,!0)}),t("el-table-column",{attrs:{label:"用车数量",prop:"is_important",width:e.isCheck?110:140,align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[e.isCheck?t("p",{staticClass:"text_right"},[t("span",[e._v(e._s(i.row.car_count))])]):e._e(),e.isCheck?e._e():t("el-input",{directives:[{name:"input-filter",rawName:"v-input-filter:int",arg:"int"}],attrs:{size:"small",placeholder:"必填"},model:{value:i.row.car_count,callback:function(t){e.$set(i.row,"car_count",e._n(t))},expression:"scope.row.car_count"}})]}}],null,!0)}),t("el-table-column",{attrs:{label:"搭乘人数",prop:"is_important",width:e.isCheck?125:140,align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[e.isCheck?t("p",{staticClass:"text_right"},[t("span",[e._v(e._s(i.row.vehicle_count))])]):e._e(),e.isCheck?e._e():t("el-input",{directives:[{name:"input-filter",rawName:"v-input-filter:int",arg:"int"}],attrs:{size:"small",placeholder:"非必填"},model:{value:i.row.vehicle_count,callback:function(t){e.$set(i.row,"vehicle_count",t)},expression:"scope.row.vehicle_count"}})]}}],null,!0)}),t("el-table-column",{attrs:{label:"用车城市",prop:"is_important",width:e.isCheck?130:140,align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[e.isCheck?t("p",{staticClass:"text_left"},[t("span",[e._v(e._s(i.row.city_name))])]):e._e(),e.isCheck?e._e():t("el-input",{attrs:{type:"text",size:"small",placeholder:e.非必填},model:{value:i.row.city_name,callback:function(t){e.$set(i.row,"city_name",t)},expression:"scope.row.city_name"}})]}}],null,!0)}),t("el-table-column",{attrs:{label:"用车说明",align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[e.isCheck?t("p",{staticClass:"text_left"},[t("span",[e._v(e._s(i.row.explain))])]):e._e(),e.isCheck?e._e():t("el-input",{attrs:{type:"text",rows:5,size:"small",placeholder:"请填写用车说明"},model:{value:i.row.explain,callback:function(t){e.$set(i.row,"explain",t)},expression:"scope.row.explain"}})]}}],null,!0)}),e.isCheck?e._e():t("el-table-column",{attrs:{label:"操作",prop:"is_important",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-tooltip",{attrs:{effect:"light",content:"删除",offset:"10",placement:"top-start"}},[t("el-button",{staticClass:"el-icon-delete",staticStyle:{"font-size":"18px"},attrs:{type:"text"},on:{click:function(t){return e.deleteCar(r,i.$index)}}})],1)]}}],null,!0)})],1)],1)})),t("div",{staticClass:"bottom_tr"},[t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.carList.length<e.dateArr.length,expression:"carList.length < dateArr.length"}],staticClass:"mar_5",attrs:{type:"primary",size:"medium"},on:{click:e.addOther}},[e._v("添加其他日期地面交通")])],1)],2)])])},_=[],h=i("393b"),u={name:"car",props:["purposeList","carType","dateArr","isCheck"],directives:{inputFilter:h["a"]},data(){return{is_car_rental:"1",car_rental_budget:0,eventCity:"",carDate:[],disCarDate:[],carList:[{car_date:"",car:[{id:"",event_info_id:"",purpose:"",vehicle_type:"",car_count:"",vehicle_count:"",city_name:this.eventCity,explain:"",is_delete:0}]}]}},mounted(){this.$nextTick(()=>{this.addDate(),this.carList.forEach(e=>{e.car.forEach(e=>{var t;e.city_name=null!==(t=e.city_name)&&void 0!==t?t:this.eventCity})})})},updated(){this.carList.forEach(e=>{e.car.forEach(e=>{e.city_name=e.city_name?e.city_name:this.eventCity})})},methods:{formatNum(){let e=this.car_rental_budget.toString();e=e.replace(/。/g,"."),e=e.replace(/\b(0+)/gi,""),e=e.replace(/[^\d.]/g,""),e=e.replace(/^\./g,""),e=e.replace(/\.{2,}/g,""),e=e.replace(".","$#$").replace(/\./g,"").replace("$#$","."),e=e.replace(/^(\-)*(\d+)\.(\d\d).*$/,"$1$2.$3"),this.car_rental_budget=e},addDate(){this.carList.forEach(e=>{!e.car_date&&this.carDate.length&&(e.car_date=this.carDate[0],-1===this.disCarDate.indexOf(e.car_date)&&this.disCarDate.push(e.car_date))})},selectDateTap(){this.disCarDate=[],this.carList.forEach(e=>{e.car_date&&this.disCarDate.push(e.car_date)})},getDisTap(e){return-1!==this.disCarDate.indexOf(e)},selectTraffic(e){},addOtherCar(e){let t=this.carList[e].car.length,i={...this.carList[e].car[t-1]};i.id="",this.carList[e].car.push(i)},deleteCar(e,t){1===this.carList.length?1===this.carList[e].car.length?this.is_car_rental="0":this.carList[e].car.splice(t,1):0!==t?this.carList[e].car.splice(t,1):this.carList.splice(e,1),this.selectDateTap()},addOther(){let e=this.carDate.filter(e=>-1===this.disCarDate.indexOf(e)),t={car_date:e.length?e[0]:"",car:[{id:"",event_info_id:"",purpose:"",vehicle_type:"",car_count:"",vehicle_count:"",city_name:this.eventCity,explain:"",is_delete:0}]},i=this.carList.length;"0"===this.is_car_rental?this.is_car_rental="1":this.carList.splice(i,0,t),this.selectDateTap()}}},p=u,f=i("0b56"),m=Object(f["a"])(p,d,_,!1,null,"390ff7c6",null),g=m.exports,b=i("e45d"),v=i("cf45"),y=i("2654"),$={name:"EventDemand",data(){return{isDemandHotel:!1,eventId:"",eventName:"",tableData:[],hasCheckedRow:!1,dateArr:[],allDate:[],roomDate:[],outDate:[],demandList:[],swingList:[],equipmentList:[],foodList:[],trafficType:[],purposeList:[],carType:[],otherService:[],nextDialog:!1,perfectDialog:!1,perfectMsg:"",purchaseId:"",isShowHotelBtn:0,isCheck:!1,InquirySheetObjectID:""}},components:{room:a["a"],event:o["a"],intercity:n["a"],foodDemand:c["a"],foodOutDemand:l["a"],car:g,other:b["a"]},mounted(){this.eventId=this.$route.query.id,this.getDemandList().then(e=>{let t=[],i=e.BeginTime.substring(0,10),r=Object(v["h"])(i,-1),s=Object(v["h"])(i,-2),a=Object(v["h"])(i,-3),o=Object(v["h"])(this.dateArr[this.dateArr.length-1],1),n=Object(v["h"])(this.dateArr[this.dateArr.length-1],2),c=Object(v["h"])(this.dateArr[this.dateArr.length-1],3);this.roomDate=[a,s,r,...this.dateArr,o].filter(e=>e),this.outDate=[a,s,r,...this.dateArr,o,n].filter(e=>e),this.allDate=[a,s,r,...this.dateArr,o,n,c].filter(e=>e),this.roomDate.forEach(e=>{let i={id:"",check_in_date:e,twin_bed_count:"",king_bed_count:"",superior_room_count:"",other_requirements:"",is_delete:0};t.push(i)}),this.$refs.event.meetDate=this.dateArr,this.$refs.intercity.interDate=this.allDate,this.$refs.intercity.eventEndTime=this.demandList.EndTime.substring(0,10),this.$refs.car.carDate=this.allDate,this.$refs.room.room=JSON.parse(JSON.stringify(t)),this.$refs.room.orgRoom=JSON.parse(JSON.stringify(t)),this.swingList=this.demandList.Tower,this.$refs.foodOut.FoodOutside=this.demandList.FoodOutside,this.$refs.foodOut.dateArr=this.allDate,this.$refs.food.dateArr=this.allDate;let l=this.demandList.Equipment;this.equipmentList=l,this.$refs.event.conferenceList[0].conference[0].equipment=JSON.parse(JSON.stringify(l)),this.$refs.event.tagList=JSON.parse(JSON.stringify(l)),this.foodList=this.demandList.Food,this.$refs.intercity.trafficType=this.demandList.Car,this.$refs.intercity.init(),this.purposeList=this.demandList.Purpose,this.carType=this.demandList.CarType;let d=this.demandList.OtherService;d.forEach(e=>{e.is_delete=1}),this.$refs.other.otherList=JSON.parse(JSON.stringify(d));let _=this.$route.query;_&&_.type&&"check"===_.type&&(this.isCheck=!0),this.getDemandDetail()})},methods:{positiveFloat:v["m"],checkedRow(e,t,i){1==e.state&&this.$refs.multipleTable.toggleRowSelection(e,!0)},handleSelectionChange(e){e.length>0&&(this.hasCheckedRow=!0),this.InquirySheetObjectID=e[0].id},subTap(){let e=this.$refs.room.room,t=this.$refs.event.conferenceList,i=[];t.forEach(e=>{e.conference.forEach(t=>{i.push({...t,conference_date:e.conference_date})})});this.$refs.food.foodBudgetList;let r=this.$refs.intercity.transportationList,s=[];r.forEach(e=>{e.transportation.forEach(t=>{s.push({...t,transportation_date:e.transportation_date.substring(0,10)})})});let a=this.$refs.car.carList,o=[];a.forEach(e=>{e.car.forEach(t=>{o.push({...t,car_date:e.car_date})})}),o.forEach(e=>{e.airport_id="",e.vehicle_id||(e.vehicle_id=""),e.city_code||(e.city_code=""),e.brand_name||(e.brand_name=""),e.purpose_name||(e.purpose_name=""),e.vehicle_name||(e.vehicle_name="")});let n=this.$refs.other.otherAddList;console.log(JSON.stringify(n));let c=this.$refs.other.otherCustom,l={is_guest_room:this.$refs.room.is_guest_room,guest_room_budget:Number(this.$refs.room.guest_room_budget),check_in_date:this.$refs.room.check_in_date,out_date:this.$refs.room.out_date,night_budget:Number(this.$refs.room.night_budget),is_networks:this.$refs.room.is_networks?1:0,is_breakfast:this.$refs.room.is_breakfast?1:0,is_Inside_outside:this.$refs.room.is_Inside_outside,is_conference_rooms:this.$refs.event.is_conference_rooms,conference_rooms_budget:Number(this.$refs.event.conference_rooms_budget),is_food_beverage:this.$refs.food.is_food_beverage,food_beverage_budget:Number(this.$refs.food.food_beverage_budget),is_food_outside:this.$refs.foodOut.is_food_outside,food_outside_budget:Number(this.$refs.foodOut.food_outside_budget),is_intercity_transportation:this.$refs.intercity.is_intercity_transportation,intercity_transportation_budget:Number(this.$refs.intercity.intercity_transportation_budget),is_car_rental:this.$refs.car.is_car_rental,car_rental_budget:Number(this.$refs.car.car_rental_budget),is_other:1,other_budget:Number(this.$refs.other.other_budget),order_describe:this.$refs.other.order_describe,is_delete:"0",id:this.purchaseId,event_info_id:this.eventId},d={meetingid:this.eventId,meeting_type:1,purchase:l,room:"1"==this.$refs.room.is_guest_room?e:[],other:n,otherCustom:c,car:"1"==this.$refs.car.is_car_rental?o:[],transportation:"1"==this.$refs.intercity.is_intercity_transportation?s:[],food:"1"==this.$refs.food.is_food_beverage?this.$refs.food.foodBudgetList:[],foodOutside:"1"==this.$refs.foodOut.is_food_outside?this.$refs.foodOut.foodBudgetList:[],conference:"1"==this.$refs.event.is_conference_rooms?t:[]},_="",h="",u="",p="";if(d.conference.forEach((e,t)=>{e.index=t+1}),d.room.forEach((e,t)=>{if("1"==this.$refs.room.is_Inside_outside){let t=parseFloat(e.in_twin_bed_count)?parseFloat(e.in_twin_bed_count):0,i=parseFloat(e.out_twin_bed_count)?parseFloat(e.out_twin_bed_count):0;e.twin_bed_count=t+i;let r=parseFloat(e.in_king_bed_count)?parseFloat(e.in_king_bed_count):0,s=parseFloat(e.out_king_bed_count)?parseFloat(e.out_king_bed_count):0;e.king_bed_count=r+s;let a=parseFloat(e.in_superior_room_count)?parseFloat(e.in_superior_room_count):0,o=parseFloat(e.out_superior_room_count)?parseFloat(e.out_superior_room_count):0;e.superior_room_count=a+o}"0"==this.$refs.room.is_Inside_outside&&(e.in_twin_bed_count=0,e.out_twin_bed_count=e.twin_bed_count,e.in_king_bed_count=0,e.out_king_bed_count=e.king_bed_count,e.in_superior_room_count=0,e.out_superior_room_count=e.superior_room_count),e.index=t+1}),d.food.forEach((e,t)=>{e.index=t+1}),d.foodOutside.forEach((e,t)=>{e.index=t+1}),d.conference.forEach(e=>{e.conference.forEach(t=>{t.conference_start_time&&t.conference_end_time&&t.attendees&&t.room_setup_type&&(1!==t.is_setting_in_advance||t.setting_in_advance_date&&t.rehearsal_date)||(_+="<b>"+e.conference_date+"</b>会场需求 ",t.conference_start_time||(_+=" 会场开始时间未填写 "),t.conference_end_time||(_+=" 会场结束时间未填写 "),t.attendees||(_+=" 参与人数未填写 "),t.room_setup_type||(_+=" 摆台形式未填写 "),1===t.is_setting_in_advance&&(t.setting_in_advance_date||(_+=" 搭建入场时间未填写 "),t.rehearsal_date||(_+=" 彩排完成时间未填写 ")))})}),d.transportation.forEach((e,t)=>{e.origin_city&&e.destination_city&&e.passenger_count&&e.trans_type||(h+="<br/><b>"+e.transportation_date+"</b>大交通需求 ",e.origin_city||(h+=" 始发地未填写 "),e.destination_city||(h+=" 目的地未填写 "),e.passenger_count||(h+=" 搭乘人数未填写 "),e.trans_type||(h+=" 交通工具未填写 ")),e.index=t+1}),d.car.forEach((e,t)=>{e.purpose&&e.vehicle_type&&e.car_count||(u+="<br/><b>"+e.car_date+"</b>地面交通需求 ",e.purpose||(u+=" 用车目的未填写 "),e.vehicle_type||(u+=" 用车类型未填写 "),e.car_count||(u+=" 用车数量未填写 ")),e.index=t+1}),d.other.some((e,t)=>{1===e.type||e.participate_count||(p+="<br/>其他需求-"+e.order_name+" 数量未填写"),1!==e.type||e.describe||(p+="<br/>其他需求-"+e.order_name+" 需求描述未填写"),e.index=t+1}),d.otherCustom.some((e,t)=>{e.describe||(p+="<br/>其他需求 描述未填写"),e.index=d.other.length+t+1}),p||_||h||u)return this.perfectDialog=!0,void(this.perfectMsg=_+h+u+p);this.$api.addPurchase({Parameter:JSON.stringify(d)},"POST").then(e=>{e&&(this.$message.success("保存成功"),this.getHotelBtn(),this.GetEditInquirySheet(),this.nextDialog=!0)})},GetEditInquirySheet(){this.$api.GetEditInquirySheet({MeetingID:this.eventId},"POST").then(e=>{this.tableData=e})},getHotelBtn(){this.$api.getPurchase({MeetingID:this.eventId},"POST").then(e=>{this.isShowHotelBtn=e.type})},goNext(e){localStorage.getItem("event_city_code");if(1===e)this.$api.CreateInquirySheet({MeetingID:this.eventId},"POST").then(e=>{e&&this.$router.push({name:"DMCactivityOrderInfo",params:{id:e}})});else if(2==e){if(!this.hasCheckedRow)return void this.$message.error("请选择中要更新的询价单");this.$api.UpdateInquirySheet({MeetingID:this.eventId,InquirySheetObjectID:this.InquirySheetObjectID},"POST").then(e=>{e&&this.$router.push({name:"DMCactivityOrderInfo",params:{id:this.InquirySheetObjectID}})})}else 5===e&&this.$router.replace({path:"/DMCEventDetail",query:{id:this.eventId}})},getDemandDetail(){this.$api.getDemandDetail({MeetingID:this.eventId},"post").then(e=>{if(!e)return;if(e.room&&e.room.length&&(this.$refs.room.room=e.room),e.purchase&&(this.purchaseId=e.purchase.id,this.$refs.room.night_budget=e.purchase.night_budget,this.$refs.room.check_in_date=e.purchase.check_in_date.substring(0,10),this.$refs.room.is_guest_room=1==e.purchase.is_guest_room.toString(),this.$refs.room.guest_room_budget=e.purchase.guest_room_budget,this.$refs.room.out_date=e.purchase.out_date,this.$refs.room.is_breakfast=1==e.purchase.is_breakfast,this.$refs.room.is_networks=1==e.purchase.is_networks,this.$refs.room.is_Inside_outside=e.purchase.is_inside_outside?e.purchase.is_inside_outside:0),e.conference&&e.conference.length){let t=Object(y["d"])(e.conference,"conference_date");t.forEach(e=>{e.conference_date=e.time.substring(0,10),e.conference=e.data,e.conference.forEach(e=>{e.equipment.forEach(e=>{let t=this.equipmentList.filter(t=>t.equipment_code===e.equipment_code);e.value=t.length?t[0].value:""})})}),this.$refs.event.conferenceList=JSON.parse(JSON.stringify(t)),this.$refs.event.addDate()}if(this.$refs.event.is_conference_rooms=1==e.purchase.is_conference_rooms.toString(),this.$refs.event.conference_rooms_budget=e.purchase.conference_rooms_budget,e.food&&e.food.length&&(this.$refs.food.foodBudgetList=e.food),this.$refs.food.is_food_beverage=1==e.purchase.is_food_beverage.toString(),this.$refs.food.food_beverage_budget=e.purchase.food_beverage_budget,this.$refs.food.food_limit=e.purchase.food_limit,e.foodOutside&&e.foodOutside.length&&(this.$refs.foodOut.foodBudgetList=e.foodOutside),this.$refs.foodOut.is_food_outside=1==e.purchase.is_food_outside.toString(),this.$refs.foodOut.food_outside_budget=e.purchase.food_outside_budget,this.$refs.foodOut.food_limit=e.purchase.food_limit,e.transportation&&e.transportation.length){this.$refs.intercity.transportationList=[];let t=e.transportation;t.forEach(e=>{e.transportation_date=e.transportation_date.substring(0,10)}),this.$refs.intercity.transportationList=t}this.$refs.intercity.is_intercity_transportation=1==e.purchase.is_intercity_transportation.toString(),this.$refs.intercity.intercity_transportation_budget=e.purchase.intercity_transportation_budget,e.car&&e.car.length&&(this.$refs.car.carList=Object(y["c"])(e.car,"car_date")),this.$refs.car.is_car_rental=1==e.purchase.is_car_rental.toString(),this.$refs.car.car_rental_budget=e.purchase.car_rental_budget,this.$refs.car.eventCity=e.purchase.cityname,this.$refs.other.other_budget=e.purchase.other_budget,this.$refs.other.otherAddList=e.other,this.$refs.other.otherCustom=e.otherCustom,this.$refs.other.order_describe=e.purchase.order_describe})},getDemandList(){return new Promise((e,t)=>{this.$api.servicePurchase({MeetingID:this.eventId},"POST").then(t=>{this.demandList=t,this.dateArr=Object(v["f"])(this.demandList.BeginTime.substring(0,10),this.demandList.EndTime.substring(0,10)),this.$forceUpdate(),e(t)})})},goEdit(){this.$router.replace({path:"/DMCcreateEvent",query:{id:this.eventId,type:"edit"}})},backPrePage(){this.$router.replace({path:"/DMCEventDetail",query:{id:this.eventId,name:this.$route.query.name,eventSearchType:this.$route.query.eventSearchType}})}}},k=$,C=(i("68ca"),i("83a3"),i("5a3d"),Object(f["a"])(k,r,s,!1,null,null,null));t["default"]=C.exports},"41b8":function(e,t,i){},"5a3d":function(e,t,i){"use strict";i("41b8")},"68ca":function(e,t,i){"use strict";i("e5b0")},"83a3":function(e,t,i){"use strict";i("dfda")},dfda:function(e,t,i){},e5b0:function(e,t,i){}}]);