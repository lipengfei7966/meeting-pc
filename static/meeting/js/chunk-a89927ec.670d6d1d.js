(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a89927ec"],{"0e5b":function(e,t,s){"use strict";s("6ed5")},"14dc":function(e,t,s){"use strict";s("6ea0")},3698:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"orderList"},[t("div",{staticClass:"content"},[t("div",[t("screen",{attrs:{filtrate:e.filtrate},on:{screen:e.screen,reset:e.reset}})],1),t("div",[t("mettingList",{ref:"mettingList",attrs:{tableData:e.tableData.List,columns:e.columns,operate:e.operate},on:{classifyName:e.classifyName,handleSizeChange:e.handleSizeChange,handleCurrentChange:e.handleCurrentChange}})],1)]),t("el-dialog",{attrs:{title:"留言",visible:e.leaveMessageStatus,"before-close":e=>{this.itemData=null,e()},center:!0,width:"600px"},on:{"update:visible":function(t){e.leaveMessageStatus=t}}},[e.leaveMessageStatus?t("leaveMessage",{attrs:{id:e.leaveMessageId}}):e._e()],1)],1)},i=[],n=s("3e9f"),l=s("87da"),d=s("b7e4"),o={name:"OrderList",components:{leaveMessage:n["a"],screen:l["a"],mettingList:d["a"]},data(){return{leaveMessageStatus:!1,leaveMessageId:null,addProjectStatus:!1,itemData:null,search:{num:"",company_name:"",event_name:"",event_owner:"",startdate:null,enddate:null,status:""},allStatus:[{code:"0020-1",name:"订单执行中"},{code:"0020-2",name:"订单取消"},{code:"0020-3",name:"已创建待执行"},{code:"0020-4",name:"已执行待结算"},{code:"0020-5",name:"待确认结算单"},{code:"0020-6",name:"已确认待结算"},{code:"0020-7",name:"客户驳回结算单"},{code:"0020-8",name:"要求补充材料"}],tableData:{CurrentPage:1,List:[]},filtrate:[{label:"订单号",type:"input",modelVal:"",fieId:"num",inputType:"string"},{label:"公司名称",type:"input",modelVal:"",fieId:"company_name",inputType:"string"},{label:"活动名称",type:"input",modelVal:"",fieId:"event_name",inputType:"string"},{label:"联系人",type:"input",modelVal:"",fieId:"event_owner",inputType:"string"},{label:"开始时间",type:"datePicker",modelVal:"",fieId:"event_startdate"},{label:"结束时间",type:"datePicker",modelVal:"",fieId:"event_enddate"},{label:"状态",type:"select",fieId:"status",modelVal:"",selsetVal:[{code:"0020-1",name:"订单执行中"},{code:"0020-2",name:"订单取消"},{code:"0020-3",name:"已创建待执行"},{code:"0020-4",name:"已执行待结算"},{code:"0020-5",name:"待确认结算单"},{code:"0020-6",name:"已确认待结算"},{code:"0020-7",name:"客户驳回结算单"},{code:"0020-8",name:"要求补充材料"}]}],columns:[{label:"订单号",width:"160",prop:"num",align:"center",hidden:!0},{label:"公司名称",width:"220",prop:"company_name",align:"center",hidden:!0},{label:"会议名称",width:"220",prop:"event_name",align:"left",hidden:!0},{label:"联系人",width:"120",prop:"customer_contact_name",align:"center",hidden:!0},{label:"参会人数",width:"120",prop:"attendee_no",align:"right",hidden:!0},{label:"活动日期",width:"220",prop:"activityDate",slot:"activityDate",align:"center",hidden:!0},{label:"报价人",width:"120",prop:"fullname",align:"center",hidden:!0},{label:"报价时间",width:"160",prop:"offer_data",align:"center",hidden:!0},{label:"报价",prop:"price",align:"right",hidden:!0},{label:"状态",width:"140",prop:"statusname",slot:"statusname",align:"center",hidden:!0}],operate:[{propName:"查看",badge:!0,classifyName:"examine"},{propName:"原询价单",classifyName:"rawList"},{propName:"留言",badge:!0,classifyName:"leaveWord"}],pageSize:10,page:1,state:!0}},methods:{leaveMessage(e){var t=this.tableData.List.filter(t=>t.event_inquiry_sheet_object_id==e.event_inquiry_sheet_object_id);t.length>0&&(t[0].new_message_count=0),this.leaveMessageId=e.event_inquiry_sheet_object_id,this.leaveMessageStatus=!0},select(e){this.$router.push({name:"orderInfo",params:{id:e.id}})},selectinquiry(e){let t=this.$router.resolve({name:"DMCquotedprice",params:{id:e.event_inquiry_sheet_object_id,isSubmit:0}});window.open(t.href,"_blank")},offShelf(e,t){this.$api.casefrozen({id:t.id},"POST").then(e=>{this.$message({message:"冻结成功！",type:"success"}),this.GetList()})},onDelete(e,t){this.$api.casedelete({id:t.id},"POST").then(e=>{this.$message({message:"删除成功！",type:"success"}),this.GetList()})},GetList(){this.$api.orderformList({Page:this.page,Rows:this.pageSize,search:this.search},"POST").then(e=>{e&&(this.state=!0),this.tableData=e,this.page=this.tableData.CurrentPage,this.$refs.mettingList.pageIndex=this.page,this.$refs.mettingList.pageSize=this.pageSize,this.$refs.mettingList.totalCount=this.tableData.Counts})},screen(e){this.search=e,this.GetList(),console.log(this.search)},reset(){this.search={num:"",company_name:"",event_name:"",event_owner:"",startdate:null,enddate:null,status:""},this.pageSize=10,this.page=1,this.GetList(),console.log("重置")},classifyName(e,t){let s=this.$options.methods;const a=this;s[e](a,t)},handleSizeChange(e){this.pageSize=e,this.page=1,this.state=!1,this.GetList(),console.log(`每页 ${e} 条`)},handleCurrentChange(e){this.state&&(this.page=e,this.GetList(),console.log("当前页: "+e))},examine(e,t){e.select(t),console.log(e,t)},rawList(e,t){e.selectinquiry(t),console.log(t)},leaveWord(e,t){e.leaveMessage(t),console.log(t)}},mounted(){this.GetList(),this.$refs.mettingList.tableTitle="我的订单",this.$refs.mettingList.editWidth=200}},r=o,c=(s("14dc"),s("0b56")),h=Object(c["a"])(r,a,i,!1,null,"1db80f54",null);t["default"]=h.exports},"3e9f":function(e,t,s){"use strict";var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"leave-message"},[t("a",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"a_click",attrs:{href:e.downloadUrl,target:"_blank",download:""}}),t("div",{staticClass:"srcoll"},[t("div",{staticClass:"message"},e._l(e.list,(function(s){return t("div",{key:s.id,staticClass:"item",class:{me:0==s.type}},[t("div",{staticClass:"date"},[e._v(e._s(0==s.type?s.Party_A+"@":s.Party_B+"@")+e._s(s.createtime))]),0==s.message_type?t("div",{staticClass:"msg"},[e._v(e._s(s.message))]):t("div",{staticClass:"msg"},[t("a",{staticStyle:{cursor:"pointer"},on:{click:function(t){return e.handlePreview(s.filepath)}}},[e._v(e._s(s.filename))])])])})),0)]),t("div",{staticClass:"edit"},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.text,expression:"text"}],attrs:{placeholder:"在此给客户留言..."},domProps:{value:e.text},on:{input:function(t){t.target.composing||(e.text=t.target.value)}}}),t("el-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:e.addMsg}},[e._v("留言")])],1)])},i=[],n={props:{id:String},data(){return{downloadUrl:"",list:[],text:""}},mounted(){this.getMsgList()},methods:{getMsgList(){this.$api.Leavingmessagelist({id:this.id},"POST").then(e=>{this.list=e})},addMsg(){this.text.trim()?this.$api.addLeavingmessage({message:this.text,inquiry_sheet_object_id:this.id},"POST").then(e=>{this.text="",this.getMsgList()}):this.$message.error("请输入留言信息")},handlePreview(e){if(!e)return;let t=e.substring(e.lastIndexOf(".")+1),s=["pdf","jpeg","jpg","png","txt"],a=["docx","doc","xls","xlsx","xlsm","ppt","pptx"];e=e.replace(/http:/,"https:"),this.downloadUrl=e,a.includes(t)?this.downloadUrl="https://view.officeapps.live.com/op/view.aspx?src="+encodeURIComponent(e):s.includes(t)?this.downloadUrl=e:(this.downloadUrl=e,this.$message.info("文件格式不支持预览，ssss下载后查看")),setTimeout(()=>{this.$refs.a_click.click()},100)},downloadFile(e){let t=e.slice(e.lastIndexOf(",")+1),s=e.slice(0,e.lastIndexOf(",")),a=document.createElement("a");a.href=t,a.download=s,document.body.appendChild(a),a.click()}}},l=n,d=(s("0e5b"),s("0b56")),o=Object(d["a"])(l,a,i,!1,null,"12af1877",null);t["a"]=o.exports},"6ea0":function(e,t,s){},"6ed5":function(e,t,s){}}]);