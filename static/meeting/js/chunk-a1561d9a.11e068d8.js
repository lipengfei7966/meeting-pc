(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a1561d9a"],{"08e7":function(e,t,a){"use strict";a("8c71")},"0a5e":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"event_list"},[a("div",{staticClass:"search_part"},[a("screen",{attrs:{filtrate:e.filtrate},on:{screen:e.screen,reset:e.reset}})],1),a("div",[a("mettingList",{ref:"mettingList",attrs:{tableData:e.dataList,columns:e.columns,operate:e.operate},on:{classifyName:e.classifyName,handleSizeChange:e.handleSizeChange,handleCurrentChange:e.handleCurrentChange}})],1),a("el-dialog",{attrs:{title:"转派",visible:e.dialogVisible,top:"30vh",width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{staticStyle:{"line-height":"40px"}},[a("p",{staticClass:"flex_row"},[a("span",{staticStyle:{width:"150px"}},[e._v("绑定用户账号：")]),a("el-select",{attrs:{size:"mini",filterable:"",multiple:"",placeholder:"请选择"},model:{value:e.updateInfo.user,callback:function(t){e.$set(e.updateInfo,"user",t)},expression:"updateInfo.user"}},e._l(e.userOptionsList,(function(e){return a("el-option",{key:e.username,attrs:{label:e.fullname,value:e.username}})})),1)],1),a("p",{staticStyle:{color:"#999","line-height":"20px",margin:"20px 0"}},[e._v(" 注释：转派后，选中审批单的当前审批环节的审批人将变更为所选用户 ")])]),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.saveUpdateInfo}},[e._v("保 存")]),a("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")])],1)])],1)},n=[],s=a("ade3"),o=(a("caad"),a("b680"),a("a15b"),a("cf45")),p=a("87da"),d=a("b7e4"),l={components:{screen:p["a"],mettingList:d["a"]},data:function(){return{newMessageShow:!1,showMoreSearch:!0,dialogVisible:!1,updateInfo:{approve_id:"",type:"",user:"",key_id:""},userOptionsList:[],messageList:[],event_date:[],submit_date:[],eventSearch:{event_num:"",event_name:"",po:"",pr:"",type:"",step:"",approval_name:"",approval_status:"",page_size:10,page_index:1,event_startdate:"",event_enddate:"",submit_begin:"",submit_end:""},pageInfo:{totalCount:0},dataList:[],buyerOptions:[],filtrate:[{label:"会议ID",type:"input",modelVal:"",fieId:"event_num",inputType:"string"},{label:"会议名称",type:"input",modelVal:"",fieId:"event_name",inputType:"string"},{label:"PO单号",type:"input",modelVal:"",fieId:"po",inputType:"string"},{label:"PR号",type:"input",modelVal:"",fieId:"pr",inputType:"string"},{label:"会议时间",type:"daterange",modelVal:"",fieId:"event_date"},{label:"提交时间",type:"daterange",modelVal:"",fieId:"submit_date"},{label:"业务类型",type:"select",fieId:"type",modelVal:"",selsetVal:[{code:"1",name:"结算单审批"},{code:"2",name:"中标审批"}]},{label:"当前步骤",type:"input",modelVal:"",fieId:"step",inputType:"string"},{label:"审批人",type:"select",fieId:"approval_name",modelVal:"",selsetVal:[]},{label:"审批状态",type:"select",fieId:"approval_status",modelVal:"",selsetVal:[{code:"初次提交",name:"初次提交"},{code:"重新提交",name:"重新提交"},{code:"已补充材料",name:"已补充材料"},{code:"审批不通过",name:"审批不通过"},{code:"要求补充材料",name:"要求补充材料"},{code:"审批通过",name:"审批通过"}]}],seek:{event_num:"",event_name:"",po:"",pr:"",type:"",step:"",approval_name:"",approval_status:"",page_size:10,page_index:1,event_startdate:"",event_enddate:"",submit_begin:"",submit_end:""},columns:[{label:"会议ID",width:"180",prop:"event_num",hidden:!0},{label:"会议名称",width:"200",prop:"event_name",align:"left",hidden:!0},{label:"PO单号",width:"140",prop:"po",hidden:!0},{label:"PR单号",width:"140",prop:"pr",hidden:!0},{label:"供应商名称",width:"200",prop:"company_name",hidden:!0},Object(s["a"])({label:"结算金额",width:"120",align:"right",prop:"total_amount",slot:"total_amount",hidden:!0},"align","right"),{label:"业务类型",width:"120",prop:"type_name",hidden:!0},{label:"团组已结束天数",width:"145",sortable:!0,prop:"end_day",hidden:!1,align:"right"},{label:"当前步骤",width:"160",prop:"state",hidden:!0},{label:"审批人",width:"160",prop:"approval_name",hidden:!0},{label:"审批状态",width:"120",prop:"approce_status",hidden:!0},{label:"提交时间",width:"180",prop:"apply_for_data",hidden:!0,align:"center"}],operate:[{propName:"查看详情",classifyName:"goDetail"},{propName:"转派",classifyName:"TurnToSend"}],state:!0}},computed:{isCanTurn:function(){return function(e){return["初次提交","重新提交","已补充材料"].includes(e.approce_status)}}},mounted:function(){this.GetUser(),this.getDataList(),this.getBuyerOptions(),this.$refs.mettingList.tableTitle="审批单管理"},methods:{formatDate:o["d"],positiveFloat:o["m"],moneyFormatter:function(e,t,a){return a||0===a?this.positiveFloat(a).toFixed(2):""},getDataList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;1===t?this.seek.page_index=1:2===t&&(this.seek={event_num:"",event_name:"",po:"",pr:"",type:"",step:"",approval_name:"",approval_status:"",event_startdate:"",event_enddate:"",submit_begin:"",submit_end:"",page_size:10,page_index:1},this.event_date=[],this.submit_date=[]),this.$api.GetApproveSheetList(this.seek,"post").then((function(t){t&&(e.state=!0),e.dataList=t.EvetModels,e.pageInfo=t.pageInfo,e.$refs.mettingList.pageIndex=e.pageInfo.pageIndex,e.$refs.mettingList.pageSize=e.pageInfo.pageSize,e.$refs.mettingList.totalCount=e.pageInfo.totalCount}))},getBuyerOptions:function(){var e=this;this.$api.getCustomerContacts({},"get").then((function(t){e.filtrate[8].selsetVal=t}))},GetUser:function(){var e=this;this.$api.GetUser({},"POST").then((function(t){e.userOptionsList=t}))},TurnToSend:function(e,t){e.updateInfo.approve_id=t.approve_id,e.updateInfo.type=t.type,e.updateInfo.key_id=t.foreign_key_id,e.updateInfo.user="",e.dialogVisible=!0},saveUpdateInfo:function(){var e=this,t={approve_id:this.updateInfo.approve_id,type:this.updateInfo.type,user:this.updateInfo.user.join(),key_id:this.updateInfo.key_id};this.$api.EditApproveUser(t,"POST").then((function(t){t?(e.$message.success("修改成功"),e.dialogVisible=!1,e.getDataList()):e.$message.error("当前环节无法分配！")}))},goDetail:function(e,t){1==t.type?e.$router.push({path:"/msd",query:{id:t.event_info_id,orderId:t.ids||"",settlementId:t.foreign_key_id,event_name:t.event_name,approveId:t.approve_id||""}}):2==t.type&&e.$router.push({path:"/cmms",query:{id:t.event_info_id,ApproveID:t.approve_id,type:"审核通过"}})},changeEventDate:function(e){e?(this.eventSearch.event_startdate=this.formatDate("YYYY-mm-dd",e[0]),this.eventSearch.event_enddate=this.formatDate("YYYY-mm-dd",e[1])):(this.eventSearch.event_startdate="",this.eventSearch.event_enddate="")},changeSubmitDate:function(e){e?(this.eventSearch.submit_begin=this.formatDate("YYYY-mm-dd",e[0]),this.eventSearch.submit_end=this.formatDate("YYYY-mm-dd",e[1])):(this.eventSearch.submit_begin="",this.eventSearch.submit_end="")},screen:function(e){this.seek=e,this.seek.page_size=this.pageInfo.pageSize,this.seek.page_index=1,this.seek.event_date?(this.seek.event_startdate=this.seek.event_date[0],this.seek.event_enddate=this.seek.event_date[1]):(this.seek.event_startdate="",this.seek.event_enddate=""),this.seek.submit_date?(this.seek.submit_begin=this.seek.submit_date[0],this.seek.submit_end=this.seek.submit_date[1]):(this.seek.submit_begin="",this.seek.submit_end=""),console.log(this.seek),this.getDataList()},reset:function(e){this.seek={event_num:"",event_name:"",po:"",pr:"",type:"",step:"",approval_name:"",approval_status:"",page_size:10,page_index:1,event_startdate:"",event_enddate:"",submit_begin:"",submit_end:""},console.log("重置",e),this.getDataList()},classifyName:function(e,t){var a=this.$options.methods,i=this;a[e](i,t)},handleSizeChange:function(e){console.log("每页 ".concat(e," 条-"),this.pageInfo),this.pageInfo.pageSize=e,this.seek.page_size=e,this.seek.page_index=1,this.state=!1,this.getDataList()},handleCurrentChange:function(e){this.state&&(console.log("当前页: ".concat(e,"-")),this.pageInfo.pageIndex=e,this.seek.page_index=e,this.getDataList())}}},r=l,u=(a("08e7"),a("2877")),h=Object(u["a"])(r,i,n,!1,null,null,null);t["default"]=h.exports},"8c71":function(e,t,a){}}]);