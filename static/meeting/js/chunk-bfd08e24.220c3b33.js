(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bfd08e24"],{2654:function(e,t,n){"use strict";n.d(t,"j",(function(){return a})),n.d(t,"k",(function(){return o})),n.d(t,"i",(function(){return i})),n.d(t,"h",(function(){return l})),n.d(t,"l",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"b",(function(){return m})),n.d(t,"g",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return h}));n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0");function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n("ac1f"),n("00b4"),n("d9e2"),n("a9e3"),n("159b");function a(e,t,n){var r=/^((0\d{2,3}-\d{7,8})|(1[34578]\d{9}))$/;""==t||void 0==t||null==t||r.test(t)||""==t?n():n(new Error("请输入正确的电话号码或者固话号码"))}function o(e,t,n){var r=/0\d{2}-\d{7,8}/;""==t||void 0==t||null==t||r.test(t)||""==t?n():n(new Error("请输入正确的固话（格式：区号+号码,如010-1234567）"))}function i(e,t,n){var r=/^[1][3,4,5,7,8][0-9]{9}$/;""==t||void 0==t||null==t||r.test(t)||""==t?n():n(new Error("请输入正确的电话号码"))}function l(e,t,n){var r=/^([a-zA-Z0-9]+[-_\.]?)+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/;""==t||void 0==t||null==t||r.test(t)?n():n(new Error("请输入正确的邮箱地址"))}function s(e,t,n){var r=/^(https?|ftp):\/\/([a-zA-Z0-9.-]+(:[a-zA-Z0-9.&%$-]+)*@)*((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])){3}|([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+\.(com|edu|gov|int|mil|net|org|biz|arpa|info|name|pro|aero|coop|museum|[a-zA-Z]{2}))(:[0-9]+)*(\/($|[a-zA-Z0-9.,?'\\+&%$#=~_-]+))*$/;""==t||void 0==t||null==t||r.test(t)?n():n(new Error("请输入正确的URL"))}function c(e,t,n){if(!t)return n(new Error("输入不可以为空"));setTimeout((function(){if(Number(t)){var e=/^[0-9]*[1-9][0-9]*$/,r=e.test(t);r?n():n(new Error("请输入正整数"))}else n(new Error("请输入正整数"))}),0)}function u(e,t,n){t||n(),setTimeout((function(){if(Number(t)){var e=/^[0-9]*[1-9][0-9]*$/,r=e.test(t);r?n():n(new Error("请输入正整数"))}else n(new Error("请输入正整数"))}),1e3)}function m(e,t){var n={},a=[];if(e=Array.isArray(e)?e:[],t)for(var o=0;o<e.length;o++)if(n[e[o].date]){for(var i=0;i<a.length;i++)if(e[o].date===a[i].date){a[i].settlement+=Number("object"==r(e[o].settlement_total_price)?e[o].settlement_total_price.value:e[o].settlement_total_price),a[i].orgSettlement+=Number("object"==r(e[o].total_price)?e[o].total_price.value:e[o].total_price),a[i].data.push(e[o]);break}}else a.push({date:e[o].date,settlement:Number("object"==r(e[o].settlement_total_price)?e[o].settlement_total_price.value:e[o].settlement_total_price),orgSettlement:Number("object"==r(e[o].total_price)?e[o].total_price.value:e[o].total_price),data:[e[o]]}),n[e[o].date]=e[o];else for(var l=0;l<e.length;l++)if(n[e[l].date]){for(var s=0;s<a.length;s++)if(e[l].date===a[s].date){a[s].settlement+="object"==r(e[l].settlement_price)?e[l].settlement_price.value:e[l].settlement_price,a[s].orgSettlement+="object"==r(e[l].price)?e[l].price.value:e[l].price,a[s].data.push(e[l]);break}}else a.push({date:e[l].date,settlement:"object"==r(e[l].settlement_price)?e[l].settlement_price.value:e[l].settlement_price,orgSettlement:"object"==r(e[l].price)?e[l].price.value:e[l].price,data:[e[l]]}),n[e[l].date]=e[l];return a}function d(e){var t={},n=[];e=Array.isArray(e)?e:[];for(var r=0;r<e.length;r++)if(t[e[r].checkindate]){for(var a=0;a<n.length;a++)if(e[r].checkindate===n[a].checkindate){"大床房"==e[r].roomtype?(n[a].bigBedNum=e[r].roomcount,n[a].totalNum+=e[r].roomcount):"双床房"==e[r].roomtype?(n[a].doubleBedNum=e[r].roomcount,n[a].totalNum+=e[r].roomcount):(n[a].suiteNum=e[r].roomcount,n[a].totalNum+=e[r].roomcount);break}}else e[r].bigBedNum=0,e[r].doubleBedNum=0,e[r].suiteNum=0,e[r].totalNum=0,"大床房"==e[r].roomtype?(e[r].bigBedNum=e[r].roomcount,e[r].totalNum+=e[r].roomcount):"双床房"==e[r].roomtype?(e[r].doubleBedNum=e[r].roomcount,e[r].totalNum+=e[r].roomcount):(e[r].suiteNum=e[r].roomcount,e[r].totalNum+=e[r].roomcount),n.push(e[r]),t[e[r].checkindate]=e[r];return n}function p(e){for(var t={},n=[],r=0;r<e.length;r++){var a=(e[r].build?e[r].build.price:0)+(e[r].rentalCosts?e[r].rentalCosts.price:0);if(e[r].equipment&&e[r].equipment.forEach((function(e){a+=e.price||0})),t[e[r].rentalCosts.time])for(var o=function(t){if(e[r].rentalCosts.time===n[t].time)return n[t].totalPrice+=(e[r].build?e[r].build.price:0)+(e[r].rentalCosts?e[r].rentalCosts.price:0),e[r].equipment&&e[r].equipment.forEach((function(e){n[t].totalPrice+=e.price||0})),n[t].data.push(e[r]),"break"},i=0;i<n.length;i++){var l=o(i);if("break"===l)break}else n.push({time:e[r].rentalCosts.time,totalPrice:a,data:[e[r]]}),t[e[r].rentalCosts.time]=e[r]}return n}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"time",n={},r=[];e=e||[];for(var a=0;a<e.length;a++)if(n[e[a][t]]){for(var o=0;o<r.length;o++)if(e[a][t]===r[o].time){r[o].data.push(e[a]),r[o].car.push(e[a]);break}}else r.push({time:e[a][t],car_date:e[a][t].substring(0,10),breakfast:e[a].breakfast,networks:e[a].networks,describe:e[a].describe,otherrequirements:e[a].otherrequirements,type:e[a].type,room_budget:e[a].room_budget,purpose:e[a].purpose,offer_remarks:e[a].offer_remarks,comments:e[a].comments,data:[e[a]],car:[e[a]]}),n[e[a][t]]=e[a];return r}function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"time",n={},r=[];e=e||[];for(var a=0;a<e.length;a++)r.push({time:e[a][t],car_date:e[a][t].substring(0,10),breakfast:e[a].breakfast,networks:e[a].networks,describe:e[a].describe,otherrequirements:e[a].otherrequirements,type:e[a].type,room_budget:e[a].room_budget,purpose:e[a].purpose,offer_remarks:e[a].offer_remarks,comments:e[a].comments,data:[e[a]],car:[e[a]]}),n[e[a][t]]=e[a];return r}},4718:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"root"},[n("div",{staticClass:"all"},[e._m(0),n("div",[n("div",{staticClass:"left-div-client"},[n("div",[n("span",[e._v("客户")]),n("el-select",{attrs:{size:"mini",placeholder:"请选择"},on:{change:e.client},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.companyData,(function(e){return n("el-option",{key:e.id,attrs:{label:e.shortname,value:e.id}})})),1)],1),e._m(1),n("div",[n("div",[n("span",{staticClass:"client-company-span",on:{click:function(t){e.searchID=e.value,e.searchType=1,e.curPage=1,e.customerContact(e.value,1),e.select_customer="公司全员"}}},[e._v("公司全员 ("+e._s(e.companyCount)+"人)")])]),e._l(e.clientData,(function(t){return n("div",{staticClass:"client-div",on:{click:function(n){return e.departmentChange(t)}}},[n("span",[e._v(e._s(t.shortname)+" ")]),n("span",[e._v("("+e._s(t.count)+"人)")])])}))],2)]),n("div",{staticClass:"right-div"},[n("div",[n("div",{staticClass:"select-customer-div"},[n("span",[e._v(e._s(e.select_customer))])]),n("el-button",{staticClass:"btn-right",attrs:{size:"mini"},on:{click:function(t){e.addMember=!0,e.shade=!0,e.is_addOrUpdate=!0,e.company(),e.initialize()}}},[e._v("新增成员")]),n("el-button",{staticClass:"btn-right",attrs:{size:"mini"},on:{click:function(t){e.import_member=!0,e.shade=!0}}},[e._v("批量导入成员")]),n("el-button",{staticClass:"btn-right",attrs:{size:"mini"},on:{click:function(t){return e.exportExcel()}}},[e._v("导出成员")]),n("el-button",{staticClass:"btn-right",attrs:{size:"mini"},on:{click:function(t){e.updateSection=!0}}},[e._v("更改用户所属部门")])],1),n("div",[n("el-form",{staticClass:"form-find-class",attrs:{inline:!0}},[n("el-form-item",{attrs:{label:"成员"}},[n("el-input",{staticClass:"input-find-class",attrs:{placeholder:"输入姓名/邮箱/手机号查询"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1),n("el-form-item",[n("el-button",{staticClass:"btn-find-class",attrs:{type:"primary"},on:{click:function(t){e.searchID=e.value,e.searchType=1,e.curPage=1,e.customerContact(e.value,1)}}},[e._v("查 询")])],1)],1)],1),n("div",[n("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{id:"out-table",data:e.tableData,"tooltip-effect":"dark","header-row-style":{height:"40px"},"header-cell-style":{padding:"0px"},"row-style":{height:"41px"},"cell-style":{padding:"0px"}},on:{"selection-change":e.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",width:"55"}}),n("el-table-column",{attrs:{align:"center",label:"姓名"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.name))]}}])}),n("el-table-column",{attrs:{align:"center",prop:"",label:"邮箱"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.mailbox))]}}])}),n("el-table-column",{attrs:{align:"center",prop:"",label:"手机号"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.phone))]}}])}),n("el-table-column",{attrs:{align:"center",prop:"",label:"操作/Action","render-header":e.renderheader},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"text"},on:{click:function(n){e.is_addOrUpdate=!1,e.addMember=!0,e.shade=!0,e.ruleForm.id=t.row.id,e.getData()}}},[e._v("编辑")]),n("el-button",{attrs:{type:"text"},on:{click:function(n){return e.deleteData(t.row.id)}}},[e._v("删除")])]}}])})],1),n("el-pagination",{attrs:{"current-page":e.curPage,"page-size":e.pagesize,"hide-on-single-page":!1,layout:"prev, pager, next",background:"",total:e.totalNum,align:"right"},on:{"current-change":e.handleCurrentChange}})],1)]),n("el-dialog",{attrs:{visible:e.addMember,width:"500px",title:e.is_addOrUpdate?"新增成员":"编辑成员信息",align:"center"},on:{"update:visible":function(t){e.addMember=t}}},[n("el-form",{ref:"memberForm",staticClass:"form-rule",attrs:{inline:!0,"label-position":"right",model:e.ruleForm,rules:e.rules}},[n("el-form-item",{attrs:{label:"姓名",prop:"name"}},[n("el-input",{model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),n("el-form-item",{attrs:{label:"邮箱",prop:"mailbox"}},[n("el-input",{model:{value:e.ruleForm.mailbox,callback:function(t){e.$set(e.ruleForm,"mailbox",t)},expression:"ruleForm.mailbox"}})],1),n("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[n("el-input",{model:{value:e.ruleForm.phone,callback:function(t){e.$set(e.ruleForm,"phone",t)},expression:"ruleForm.phone"}})],1),e.is_addOrUpdate?n("el-form-item",{attrs:{label:"公司",prop:"company_id"}},[n("el-select",{attrs:{placeholder:"请选择公司"},model:{value:e.ruleForm.company_id,callback:function(t){e.$set(e.ruleForm,"company_id",t)},expression:"ruleForm.company_id"}},e._l(e.companyData,(function(e){return n("el-option",{attrs:{label:e.shortname,value:e.id}})})),1)],1):e._e(),e.is_addOrUpdate?n("el-form-item",{attrs:{label:"部门",prop:"customer_id"}},[n("el-select",{attrs:{placeholder:"请选择部门"},model:{value:e.ruleForm.customer_id,callback:function(t){e.$set(e.ruleForm,"customer_id",t)},expression:"ruleForm.customer_id"}},e._l(e.clientData,(function(e){return n("el-option",{attrs:{label:e.shortname,value:e.id}})})),1)],1):e._e()],1),n("div",{staticClass:"submit-div"},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submit()}}},[e._v("提交")]),n("el-button",{attrs:{type:"info"},on:{click:function(t){e.shade=!1,e.addMember=!1}}},[e._v("取消")])],1)],1),e.import_member?n("div",{staticClass:"import-div"},[e._m(2),n("el-upload",{attrs:{action:"none","file-list":e.fileList,"before-upload":e.beforeUploadFile,"on-exceed":e.exceedFile,limit:1,accept:".xlsx,.xls","on-change":e.fileChange}},[n("el-button",{attrs:{size:"small",type:"primary"}},[e._v("选择文件")]),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("支持格式：xls、xlsx，最大4M")])],1),e._m(3),n("div",[n("el-button",{attrs:{type:"info"},on:{click:function(t){e.import_member=!1,e.shade=!1}}},[e._v("取消")]),n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.uploadFile()}}},[e._v("确认")])],1)],1):e._e(),n("div",{directives:[{name:"show",rawName:"v-show",value:e.updateSection,expression:"updateSection"}],staticClass:"section-div"},[e._m(4),n("el-form",{staticClass:"form-section",attrs:{inline:!0,"label-position":"right","label-width":"80px",model:e.ruleForm,rules:e.rules}},[n("el-form-item",{attrs:{label:"父部门",prop:"customer_id"}},[n("el-select",{attrs:{placeholder:"请选择部门"},model:{value:e.ruleForm.customer_id,callback:function(t){e.$set(e.ruleForm,"customer_id",t)},expression:"ruleForm.customer_id"}},e._l(e.clientData,(function(e){return n("el-option",{key:e.id,attrs:{label:e.shortname,value:e.id}})})),1)],1)],1),n("div",{staticClass:"transfer-div"},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.transfer(),e.shade=!1,e.updateSection=!1}}},[e._v("迁移")]),n("el-button",{attrs:{type:"info"},on:{click:function(t){e.shade=!1,e.updateSection=!1}}},[e._v("取消")])],1)],1)],1)])])},a=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div"),n("div",{staticClass:"index-page-div"},[n("span",[e._v("首页")]),n("span",[e._v("->")]),n("span",[e._v("客户成员管理")])])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("span",{staticClass:"client-div-span"},[e._v("客户组织架构")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("span",[e._v("批量导入成员")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("a",{attrs:{href:"http://b.ctgbs.com/%E5%A4%A7%E4%BA%A4%E9%80%9A%E6%A8%A1%E6%9D%BF.xlsx"}},[e._v("点击下载模板")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("span",[e._v("编辑部门")])])}],o=(n("fb6a"),n("b0c0"),n("ac1f"),n("1276"),n("d3b7"),n("159b"),n("e9c4"),n("2654")),i={data:function(){return{select_customer:"公司全员",curPage:1,pagesize:10,totalNum:0,searchType:0,searchID:"",is_addOrUpdate:!1,shade:!1,import_member:!1,updateSection:!1,value:"",name:"",tableData:[],multipleSelection:[],companyData:[],clientData:[],companyCount:"",addMember:!1,ruleForm:{name:"",phone:"",mailbox:"",customer_id:"",company_id:"",id:""},rules:{name:[{required:!0,message:"请输入姓名",trigger:"blur"},{min:2,max:5,message:"长度在 2 到 5 个字符",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{min:11,max:11,message:"长度为11个字符",trigger:"blur"}],mailbox:[{required:!0,message:"请输入邮箱",trigger:"blur"},{validator:o["h"],trigger:"blur"}],company_id:[{required:!0,message:"请选择公司",trigger:"change"}]},currentFile:null,fileList:[],outTableSelection:[]}},watch:{tableList:{handler:function(e){this.tableList=e,this.tableData=this.tableList.slice((this.curPage-1)*this.pagesize,this.curPage*this.pagesize),this.timeStamp=new Date,console.log("监听监听======",e)},deep:!0}},components:{},mounted:function(){var e=this;this.$nextTick((function(){e.company()}))},methods:{exportExcel:function(){},departmentChange:function(e){this.select_customer=e.shortname,this.curPage=1,this.searchID=e.id,this.searchType=0,this.customerContact(e.id,0)},fileChange:function(e,t){console.log(e.raw),this.fileList.push(e.raw),console.log(this.fileList)},exceedFile:function(e,t){this.$message.warning("只能选择1个文件，当前共选择了 ".concat(e.length+t.length," 个"))},beforeUploadFile:function(e){console.log("before upload"),console.log(e);var t=e.name.substring(e.name.lastIndexOf(".")+1),n=e.size/1024/1024;"xls"!==t&&"xlsx"!==t&&this.$message.warning("只能上传后缀是.xlsx,.xls的文件"),n>10&&this.$message.warning("文件大小不得超过10M")},uploadFile:function(){if(0===this.fileList.length)this.$message.warning("请上传文件");else{this.import_member=!1,this.shade=!1;var e=new FormData;console.log(this.fileList[0]),e.append("file",this.fileList[0]),e.append("DepartmentyID","5000"),e.append("CompanyID","CeShi"),this.$api.customerImportExcel({form:e},"POST").then((function(e){console.log(e)}))}},renderheader:function(e,t){var n=t.column;t.$index;return e("span",{},[e("span",{},n.label.split("/")[0]),e("br"),e("span",{},n.label.split("/")[1])])},handleCurrentChange:function(e){this.curPage=e,this.customerContact(this.searchID,this.searchType)},company:function(){var e=this;this.$api.getCompany({},"POST").then((function(t){e.companyData=t}))},client:function(){var e=this;this.$api.getClient({CompanyID:this.value},"POST").then((function(t){var n=e;e.clientData=t,e.companyData.forEach((function(e){e.id==n.value&&(n.companyCount=e.count)})),e.searchID=e.value,e.searchType=1,e.customerContact(e.value,1)}))},customerContact:function(e,t){var n=this;this.$api.getCustomerContact({id:e,type:t,where:this.name,pageIndex:this.curPage,pageSize:this.pagesize},"POST").then((function(e){e&&(n.tableData=e.EvetModels,n.totalNum=e.pageInfo.totalCount)}))},submit:function(){var e=this;this.$refs.memberForm.validate((function(t){t&&e.$api.customerContactSava({Parameter:JSON.stringify({name:e.ruleForm.name,phone:e.ruleForm.phone,mailbox:e.ruleForm.mailbox,customer_id:e.ruleForm.customer_id,company_id:e.ruleForm.company_id,id:e.ruleForm.id})},"POST").then((function(t){console.log(t),e.company(),e.client(),e.shade=!1,e.addMember=!1}))}))},initialize:function(){this.ruleForm={name:"",phone:"",mailbox:"",customer_id:"",company_id:"",id:""}},getData:function(){var e=this;this.$api.getCustomerContactEdit({ContactID:this.ruleForm.id},"POST").then((function(t){console.log(t),e.ruleForm.company_id="",e.ruleForm.customer_id="",e.ruleForm.name=t.name,e.ruleForm.phone=t.phone,e.ruleForm.mailbox=t.mailbox}))},deleteData:function(e){var t=this;this.$confirm("此操作将删除该客户联系人, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$api.customerDelete({ContactID:e},"POST").then((function(e){e&&(t.$message({type:"success",message:"删除成功!"}),t.company(),t.client())})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))}))},transfer:function(){var e=this,t="";this.outTableSelection.forEach((function(n,r){r==e.outTableSelection.length-1?t+=n.id:t+=n.id+","})),this.$api.departmentyEdit({ContactID:t,DepartmentyID:this.ruleForm.customer_id},"POST").then((function(t){console.log(t),e.company(),e.client()}))},handleSelectionChange:function(e){this.outTableSelection=e}}},l=i,s=(n("62d3"),n("2877")),c=Object(s["a"])(l,r,a,!1,null,null,null);t["default"]=c.exports},"62d3":function(e,t,n){"use strict";n("b938")},b938:function(e,t,n){}}]);