(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0a96a9ac"],{"0e5c":function(t,e,a){"use strict";var s=a("5829"),i=a("8642");e["a"]=function(t){return new Promise((function(e,a){let n=[],o={},l=t.length;console.log(t.length,t);const r=()=>0==t.length?e(n):String(t[0].file).IsPicture()?(t.shift(),r()):void s["a"].upload({file:t[0].file},"POST",{type:"form"}).then(a=>{console.log(a);var s=!0;if(void 0!=a&&""==a.FilePath&&""==a.OriginalFileName&&(console.log("重复了"),a=void 0,s=!1),void 0==a&&s){i["default"].prototype.$alert("网络不稳定, 文件上传失败, 请重新上传","提示",{confirmButtonText:"确定",callback:t=>{i["default"].prototype.$message({message:"上传失败的文件已标记",type:"warning"})}});let a=l-t.length;return e({tag:a,uploadImageList:n})}o=a,n.push(o),t.shift(),r()});r()}))}},"125e":function(t,e,a){"use strict";a("91c8")},6187:function(t,e,a){"use strict";a("cbfa")},"91c8":function(t,e,a){},cbfa:function(t,e,a){},f48b:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"CaseStudy"},[e("div",{staticClass:"title"},[t._v("案例管理")]),e("div",{staticClass:"content"},[e("div",{staticClass:"tools"},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){t.addCaseStudyStatus=!0}}},[t._v("添加新案例")])],1),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData.List,stripe:"",height:"100%"}},[e("el-table-column",{attrs:{type:"index",width:"50"}}),e("el-table-column",{attrs:{prop:"name",label:"案例名称"}}),e("el-table-column",{attrs:{prop:"content",label:"案例介绍",width:"200"}}),e("el-table-column",{attrs:{prop:"statusname",label:"状态"}}),e("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{staticClass:"tools_btn",attrs:{size:"mini",type:"text"},on:{click:function(e){return t.update(a.$index,a.row)}}},[t._v("编辑")]),"0017-1"===a.row.status?e("el-popconfirm",{attrs:{"confirm-button-text":"冻结","cancel-button-text":"取消",icon:"el-icon-info","icon-color":"red",title:"确定要冻结此案例吗？"},on:{confirm:function(e){return t.offShelf(a.$index,a.row)}}},[e("el-button",{staticClass:"tools_btn",attrs:{slot:"reference",size:"mini",type:"text"},slot:"reference"},[t._v("冻结")])],1):e("el-popconfirm",{attrs:{"confirm-button-text":"激活","cancel-button-text":"取消",icon:"el-icon-info","icon-color":"red",title:"确定要激活此案例吗？"},on:{confirm:function(e){return t.onShelf(a.$index,a.row)}}},[e("el-button",{staticClass:"tools_btn",attrs:{slot:"reference",size:"mini",type:"text"},slot:"reference"},[t._v("激活")])],1),e("el-popconfirm",{attrs:{"confirm-button-text":"删除","cancel-button-text":"取消",icon:"el-icon-info","icon-color":"red",title:"确定要删除此案例吗？"},on:{confirm:function(e){return t.onDelete(a.$index,a.row)}}},[e("el-button",{staticClass:"tools_btn",attrs:{slot:"reference",size:"mini",type:"text"},slot:"reference"},[t._v("删除")])],1)]}}])})],1),e("el-pagination",{staticClass:"pages",attrs:{background:"",layout:"prev, pager, next",total:t.tableData.Counts,"current-page":t.tableData.CurrentPage},on:{"current-change":t.currentChange}})],1),e("el-dialog",{attrs:{title:"添加新案例",visible:t.addCaseStudyStatus,"before-close":t=>{this.itemData=null,t()},width:"500px"},on:{"update:visible":function(e){t.addCaseStudyStatus=e}}},[t.addCaseStudyStatus?e("caseStudyAdded",{attrs:{"item-data":t.itemData},on:{onColse:t.save}}):t._e()],1)],1)},i=[],n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"case-study-added"},[e("el-form",{ref:"ruleForm",attrs:{"label-width":"110px",model:t.FormData,rules:t.rules}},[e("el-form-item",{attrs:{label:"案例名称",prop:"name"}},[e("el-input",{attrs:{placeholder:"案例名称"},model:{value:t.FormData.name,callback:function(e){t.$set(t.FormData,"name",e)},expression:"FormData.name"}})],1),e("el-form-item",{attrs:{label:"案例介绍",prop:"content"}},[e("el-input",{attrs:{type:"textarea",placeholder:"案例介绍",rows:"5"},model:{value:t.FormData.content,callback:function(e){t.$set(t.FormData,"content",e)},expression:"FormData.content"}})],1),e("el-form-item",{attrs:{label:"上传案例图片",prop:"picture"}},[e("el-upload",{ref:"upload",attrs:{action:"","on-change":t.handleChangeAttach,"on-remove":t.handleRemoveAttach,"auto-upload":!1,"file-list":this.waitUpload,multiple:!1,accept:".jpg,.jpeg,.png"}},[e("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[t._v("从电脑选择文件")]),e("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v(" 只能上传jpg/png文件,大小不超过2M (可上传多张) ")]),t.FormData.picture?e("div",{staticClass:"yl"},t._l(t.FormData.picture,(function(t,a){return e("img",{key:"image_"+a,attrs:{src:t,alt:""}})})),0):t._e()],1)],1),e("div",{staticClass:"btnGroup"},[e("el-button",{attrs:{type:"primary"},on:{click:t.add}},[t._v(t._s(null==t.itemData?"立即添加":"确认修改"))])],1)],1)],1)},o=[],l=a("0e5c"),r={props:{itemData:null|JSON},data(){return{FormData:{name:"",picture:[],content:""},waitUpload:[],rules:{name:[{required:!0,message:"请输入案例名称",trigger:"change"}],content:[{required:!0,message:"请输入介绍",trigger:"change"}]}}},mounted(){null!=this.itemData&&(this.FormData=JSON.parse(JSON.stringify(this.itemData)),this.FormData.picture=this.FormData.picture.split(","))},methods:{add(){this.$refs["ruleForm"].validate(t=>{if(!t)return console.log("error submit!!"),!1;{let t=[];this.waitUpload.forEach((e,a)=>{const s={key:a,file:e.raw};t.push(s)}),Object(l["a"])(t).then(t=>{let e=[];for(let a in t)e.push(t[a].FilePath);this.FormData.picture=e.toString(),this.$emit("onColse",this.FormData)})}})},handleChangeAttach(t,e){const a="image/jpeg"===t.raw.type,s="image/png"===t.raw.type,i=t.size/1024/1024<2;if(!a&&!s||!i)return a&&s?this.$message.error("上传图片大小不能超过 2MB!"):this.$message.error("上传图片只能是 JPG 或者 PNG 格式!"),void this.$refs.upload.handleRemove(t);this.waitUpload=e},handleRemoveAttach(t,e){this.waitUpload=e}}},c=r,u=(a("125e"),a("0b56")),d=Object(u["a"])(c,n,o,!1,null,"50dfe3c6",null),p=d.exports,m={name:"CaseStudy",components:{caseStudyAdded:p},data(){return{addCaseStudyStatus:!1,itemData:null,tableData:{CurrentPage:1,List:[]}}},methods:{update(t,e){this.itemData=e,this.addCaseStudyStatus=!0},onShelf(t,e){this.$api.caseactivation({id:e.id},"POST").then(t=>{console.log(t),this.$message({message:"激活成功！",type:"success"}),this.GetList()})},offShelf(t,e){this.$api.casefrozen({id:e.id},"POST").then(t=>{console.log(t),this.$message({message:"冻结成功！",type:"success"}),this.GetList()})},onDelete(t,e){this.$api.casedelete({id:e.id},"POST").then(t=>{this.$message({message:"删除成功！",type:"success"}),this.GetList()})},GetList(){this.$api.caselist({Page:this.tableData.CurrentPage,Rows:10},"POST").then(t=>{this.tableData=t})},currentChange(t){this.tableData.CurrentPage=t,this.GetList()},save(t){this.$api.casesave(t,"POST").then(e=>{console.log(e),this.$message({message:t.id?"修改成功！":"添加成功！",type:"success"}),this.addCaseStudyStatus=!1,t.id||(this.tableData.CurrentPage=1),this.GetList()})}},mounted(){this.GetList()}},h=m,f=(a("6187"),Object(u["a"])(h,s,i,!1,null,"1f3cb41f",null));e["default"]=f.exports}}]);