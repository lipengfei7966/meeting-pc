(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-68d1d940"],{3925:function(e,t,i){},"676f":function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"approve-page-body",staticStyle:{"padding-top":"40px"}},[t("div",{staticClass:"centerBox"},[t("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{staticClass:"el-breadcrumb-item",attrs:{to:{path:"/"}}},[e._v(" 首页 ")]),t("el-breadcrumb-item",{staticClass:"el-bread-item",attrs:{to:{path:"/otherSettings"}}},[e._v(" 其他配置 ")]),t("el-breadcrumb-item",{staticClass:"el-bread-item"},[e._v(" 客户权限 ")])],1)],1)]),t("div",{staticClass:"search_area"},[t("div",{staticStyle:{display:"flex","align-items":"center"}},[t("div",{staticStyle:{width:"80px"}},[e._v("客户名称")]),t("el-input",{attrs:{placeholder:"输入客户名称模糊查询",size:"mini",type:"text"},model:{value:e.customername,callback:function(t){e.customername=t},expression:"customername"}})],1),t("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",size:"mini"},on:{click:e.query}},[e._v("查询")]),t("el-button",{staticStyle:{"margin-left":"20px"},attrs:{size:"mini"},on:{click:e.reset}},[e._v("重置")]),t("el-button",{staticStyle:{"margin-left":"80px"},attrs:{type:"primary",size:"mini"},on:{click:e.addUser}},[e._v("添加客户权限")]),t("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",size:"mini"},on:{click:e.batchDel}},[e._v("批量移除客户权限")])],1),t("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableInfo.EvetModels,"tooltip-effect":"dark"},on:{"selection-change":e.userSelection}},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),t("el-table-column",{attrs:{prop:"name",label:"客户名称",width:"220"}}),t("el-table-column",{attrs:{prop:"group_user_name",label:"所属用户组",width:"120"}}),t("el-table-column",{attrs:{label:"操作",width:"260"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.delUser(i.$index,i.row)}}},[e._v("移除客户权限")])]}}])})],1),e.tableInfo.EvetModels.length?t("el-pagination",{staticStyle:{"margin-top":"30px",width:"100%","text-align":"center"},attrs:{"hide-on-single-page":!0,"current-page":e.pageIndex,"page-size":e.pageSize,background:"",layout:"total, prev, pager, next",total:e.tableInfo.pageInfo.totalCount},on:{"current-change":e.currentChange}}):e._e(),t("el-dialog",{attrs:{title:"请选择",visible:e.dialogVisible,width:"70%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("div",{staticClass:"grid_content"},[t("div",{staticClass:"choose_area"},[t("div",{staticClass:"search_condition"},[t("div",{staticStyle:{display:"flex","align-items":"center"}},[t("div",{staticStyle:{width:"80px"}},[e._v("客户名称")]),t("el-input",{attrs:{size:"mini",type:"text"},model:{value:e.grid.customer,callback:function(t){e.$set(e.grid,"customer",t)},expression:"grid.customer"}})],1),t("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",size:"mini"},on:{click:e.queryGrid}},[e._v("查询")])],1),t("div",{staticClass:"search_result"},[t("el-table",{ref:"gridMultipleTable",staticStyle:{width:"100%"},attrs:{data:e.gridResult.EvetModels,"tooltip-effect":"dark",height:"250","header-cell-class-name":e.cellClass},on:{select:e.onTableSelect}},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),t("el-table-column",{attrs:{prop:"name",label:"客户名称",width:"220"}})],1),e.gridResult.EvetModels.length?t("el-pagination",{staticStyle:{"margin-top":"30px",width:"100%","text-align":"center"},attrs:{small:!0,"hide-on-single-page":!0,"current-page":e.grid.pageIndex,"page-sizes":[5,10,20,30],"page-size":e.grid.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.gridResult.pageInfo.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e()],1)]),t("div",{staticClass:"result_area"},[t("div",{staticClass:"result_area_btn"},[t("div",[e._v("已选择列表")]),t("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-delete"},on:{click:e.delChoose}},[e._v("删除选中")])],1),t("ul",{staticClass:"result_area_list"},e._l(e.chooseList,(function(i){return t("li",{key:i.id,style:i.chooseSave?"":"background:#99ccff",on:{click:function(t){return e.chooseData(i)}}},[e._v(e._s(i.name))])})),0)])]),t("span",{staticClass:"dialog-footer",staticStyle:{display:"flex","justify-content":"center"},attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.handleClose}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.saveGrid}},[e._v("确 定")])],1)])],1)},a=[],l={data:function(){return{id:"",customername:"",pageIndex:1,pageSize:10,tableInfo:{EvetModels:[],pageInfo:{totalCount:0}},batchList:[],dialogVisible:!1,grid:{customer:"",pageIndex:1,pageSize:10},gridResult:{EvetModels:[],pageInfo:{totalCount:0}},chooseList:[]}},mounted(){this.id=this.$route.query.id,this.getCustomerGroupList()},methods:{getCustomerGroupList(){this.$api.GetCustomerGroupList({usergroup_id:this.id,customername:this.customername,pageIndex:this.pageIndex,pageSize:this.pageSize},"POST").then(e=>{this.tableInfo=e})},userSelection(e){this.batchList=e},query(){this.getCustomerGroupList()},reset(){this.customername="",this.pageIndex=1,this.pageSize=10,this.getCustomerGroupList()},batchDel(){if(!this.batchList.length)return this.$message.success("未选中需要操作的记录！"),!1;this.$confirm("是否将选中客户权限移除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let e=[];this.batchList.forEach(t=>{e.push(t.customerid)}),this.$api.DeleteCustomerDate({usergroup_id:this.id,customerid:e.join(",")},"POST").then(e=>{e&&this.$message.success("删除成功"),this.batchList=[],this.reset()})})},delUser(e,t){this.$confirm("是否将当前客户权限移除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$api.DeleteCustomerDate({usergroup_id:this.id,customerid:t.customerid},"POST").then(e=>{e&&this.$message.success("删除成功"),this.reset()})})},currentChange(e){this.pageIndex=e,this.getCustomerGroupList()},getUserlist(e){this.$api.GetCustomerList(this.grid,"POST").then(t=>{t.EvetModels=t.EvetModels.map(e=>(e.chooseSave=0,e)),this.gridResult=t,e&&(this.dialogVisible=!0),this.$nextTick(()=>{this.gridResult.EvetModels.forEach(e=>{let t=this.chooseList.filter(t=>t.id==e.id);t&&t.length?this.$refs.gridMultipleTable.toggleRowSelection(e,!0):this.$refs.gridMultipleTable.toggleRowSelection(e,!1)})})})},cellClass(e){if(0===e.columnIndex)return"disableheadselection"},addUser(){this.getUserlist(!0)},judgeUserData(e,t){let i=this.chooseList.findIndex(t=>e.id==t.id);-1==i&&t&&(e.chooseSave=1,this.chooseList.push(e)),-1==i||t||this.chooseList.splice(i,1)},queryGrid(){this.grid.pageIndex=1,this.grid.pageSize=10,this.getUserlist()},handleClose(){this.resetSearch(),this.dialogVisible=!1},handleSizeChange(e){this.grid.pageSize=e,this.getUserlist()},onTableSelect(e,t){let i=e.findIndex(e=>e.id==t.id);-1!=i?this.judgeUserData(t,!0):this.judgeUserData(t,!1)},delChoose(){this.chooseList.forEach((e,t)=>{0==e.chooseSave&&this.chooseList.splice(t,1)}),this.$nextTick(()=>{this.gridResult.EvetModels.forEach(e=>{let t=this.chooseList.filter(t=>t.id==e.id);t&&t.length?this.$refs.gridMultipleTable.toggleRowSelection(e,!0):this.$refs.gridMultipleTable.toggleRowSelection(e,!1)})})},chooseData(e){e.chooseSave=e.chooseSave?0:1},handleCurrentChange(e){this.grid.pageIndex=e,this.getUserlist()},resetSearch(){this.grid={customer:"",pageIndex:1,pageSize:10},this.chooseList=[]},saveGrid(){if(!this.chooseList.length)return this.$message.success("请先选择客户"),!1;let e=[];this.chooseList.forEach(t=>{e.push(t.id)}),this.$api.PostCustomerDate({Usergroup_id:this.id,customerid:e.join(",")},"POST").then(e=>{this.$message.success(e.info),this.handleClose(),this.reset()})}}},o=l,r=(i("eb15"),i("0b56")),n=Object(r["a"])(o,s,a,!1,null,"76c01852",null);t["default"]=n.exports},eb15:function(e,t,i){"use strict";i("3925")}}]);