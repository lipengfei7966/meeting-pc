(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4c4212e7"],{"0751":function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"quotation bd_r bd_l"},[i("a",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"a_click",attrs:{href:t.downloadUrl,target:"_blank",download:""}}),i("table",{staticClass:"hotel_info",attrs:{width:"100%",cellspacing:"0",cellpadding:"0"}},[i("tr",["0"==t.hotelInfo.supplier_type?i("td",{staticClass:"bd_r"},[t._v("车队名称")]):i("td",{staticClass:"bd_r"},[t._v(t._s(1==t.hotelInfo.service_hotel?"会议服务商":"酒店")+"名称")]),i("td",{staticClass:"t78"},[i("div",{staticClass:"flex_row align_center"},[i("img",{staticStyle:{width:"60px",height:"60px"},attrs:{src:t.hotelInfo.logo,alt:""}}),i("div",{staticClass:"flex_column mar_l20"},[i("span",[t._v(t._s(t.hotelInfo.name)),i("em")])])])])]),i("tr",["0"==t.hotelInfo.supplier_type?i("td",{staticClass:"bd_r"},[t._v("车队地址")]):i("td",{staticClass:"bd_r"},[t._v(t._s(1==t.hotelInfo.service_hotel?"会议服务商":"酒店")+"地址")]),i("td",{staticClass:"t78"},[t._v(t._s(t.hotelInfo.address))])]),i("tr",["0"==t.hotelInfo.supplier_type?i("td",{staticClass:"bd_r"},[t._v("车队联系人")]):i("td",{staticClass:"bd_r"},[t._v(t._s(1==t.hotelInfo.service_hotel?"会议服务商":"酒店")+"联系人")]),i("td",{staticClass:"t78"},[t._v(t._s(t.hotelInfo.contacts)+" "+t._s(t.hotelInfo.phone)+" "+t._s(t.hotelInfo.email))])]),i("tr",["0"==t.hotelInfo.supplier_type?i("td",{staticClass:"bd_r"},[t._v("车队报价人")]):i("td",{staticClass:"bd_r"},[t._v(t._s(1==t.hotelInfo.service_hotel?"会议服务商":"酒店")+"报价人")]),i("td",{staticClass:"t78"},[t._v(t._s(t.hotelInfo.service_name)+" "+t._s(t.hotelInfo.service_mobile)+" "+t._s(t.hotelInfo.service_email))])]),i("tr",{staticClass:"bg_pink"},[i("td",{staticClass:"bd_r"},[t._v("需求")]),i("td",[i("div",{staticClass:"flex_column",staticStyle:{"text-align":"left"}},[i("span",[t._v(" 总报价： "),i("h2",{staticClass:"dis_block t_orange"},[t._v("￥"+t._s(t.positiveFloat(t.hotelInfo.total_price).toFixed(2)))]),1==t.hotelInfo.service_hotel?i("span"):t._e()]),i("span",{staticClass:"t_ccc"},[t._v("报价时间："+t._s(t.hotelInfo.offer_data))])])])]),1==t.hotelInfo.service_hotel?i("tr",{staticClass:"bg_7fd"},[i("td",{staticClass:"bd_r"},[t._v("净价")]),i("td",[i("span",{staticClass:"t_orange",staticStyle:{"font-weight":"bold"}},[t._v("￥"+t._s(t.positiveFloat(t.hotelInfo.net_price)))])])]):t._e(),1==t.hotelInfo.service_hotel?i("tr",[i("td",{staticClass:"bd_r"},[t._v(t._s("0"==t.hotelInfo.supplier_type?"采购车队":"采购酒店"))]),i("td",[t._v(" "+t._s(t.hotelInfo.hotel_name?t.hotelInfo.hotel_name:"未选择采购酒店")+" "),"0"!==t.hotelInfo.supplier_type?i("el-checkbox",{staticStyle:{"line-height":"30px","margin-left":"20px"},attrs:{"true-label":1,"false-label":0},model:{value:t.hotelInfo.isuser_preferred_hotel,callback:function(e){t.$set(t.hotelInfo,"isuser_preferred_hotel",e)},expression:"hotelInfo.isuser_preferred_hotel"}},[t._v("是否使用首选酒店")]):t._e()],1)]):t._e()]),t.roomList.length?i("roomPart",{ref:"room",attrs:{roomList:t.roomList,additional:t.additional,hotelInfo:t.hotelInfo}}):t._e(),t.eventList.length?i("eventPart",{ref:"event",attrs:{eventList:t.eventList,additional:t.additional,hotelInfo:t.hotelInfo}}):t._e(),t.foodList.length?i("foodPart",{ref:"food",attrs:{foodList:t.foodList,additional:t.additional,hotelInfo:t.hotelInfo}}):t._e(),t.foodOutsideList.length?i("foodOutsidePart",{ref:"foodOutside",attrs:{foodOutsideList:t.foodOutsideList,additional:t.additional,hotelInfo:t.hotelInfo}}):t._e(),t.transportList.length?i("transportPart",{ref:"transport",attrs:{transportList:t.transportList,additional:t.additional,hotelInfo:t.hotelInfo}}):t._e(),t.carList.length?i("carPart",{ref:"car",attrs:{carList:t.carList,additional:t.additional,hotelInfo:t.hotelInfo}}):t._e(),t.otherList.length?i("otherPart",{ref:"other",attrs:{otherList:t.otherList,additional:t.additional,hotelInfo:t.hotelInfo}}):t._e(),i("div",{staticClass:"flex_row car_date bd_b"},[i("div",{staticClass:"bd_r flex_1 pad_tb10_lr20"},[t._v("服务商报价说明（付款条件等）")]),i("div",{staticClass:"flex_2 pad_tb10_lr20"},[t._v(t._s(t.additional.offer_remarks))])]),i("div",{staticClass:"flex_row car_date bd_b"},[i("div",{staticClass:"bd_r flex_1 pad_tb10_lr20"},[t._v("报价有效期")]),i("div",{staticClass:"flex_2 pad_tb10_lr20"},[t._v(t._s(t.hotelInfo.quotationenddate))])]),i("div",{staticClass:"flex_row car_date bd_b"},[i("div",{staticClass:"bd_r flex_1 pad_tb10_lr20"},[t._v("报价书文件")]),i("div",{staticClass:"flex_2 pad_tb10_lr20"},t._l(t.hotelInfo.file,(function(e,s){return i("p",{key:s},[i("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(i){return t.handlePreview(e)}}},[t._v(" "+t._s(e.filename)+" ")])],1)})),0)]),t.additional.serviceData.length?i("servicePart",{ref:"service",attrs:{serviceList:t.additional}}):t._e(),t.additional.taxationData.length?i("taxPart",{ref:"tax",attrs:{taxList:t.additional}}):t._e()],1)},a=[],o=(i("ac1f"),i("5319"),i("caad"),i("d3b7"),i("3ca3"),i("ddb0"),i("2b3d"),i("9861"),i("cf45")),n=i("3cdb"),r=i("4651"),l=i("2590"),c=i("97b6"),d=i("b27d"),u=i("c9d6"),f=i("82ca"),p=i("d55e"),h=i("608c"),v=i("f121"),_={name:"quotation",data:function(){return{downloadUrl:"",hotelInfo:{},baseInfo:{},carList:[],roomList:[],foodList:[],foodOutsideList:[],eventList:[],otherList:[],transportList:[],additional:{},taxList:{},serviceList:{},type:1,MAINHOST:v["b"]}},components:{carPart:n["a"],roomPart:r["a"],eventPart:l["a"],foodPart:c["a"],foodOutsidePart:d["a"],transportPart:u["a"],otherPart:f["a"],servicePart:p["a"],taxPart:h["a"]},mounted:function(){var t=this;this.$nextTick((function(){t.type=t.$route.query.type}))},watch:{hotelInfo:function(t,e){this.baseInfo=t}},methods:{positiveFloat:function(t){return Object(o["m"])(t)},handlePreview:function(t){var e=this;if(t.filepath){var i=t.filepath.substring(t.filepath.lastIndexOf(".")+1),s=["pdf","jpeg","jpg","png","txt"],a=["docx","doc","xls","xlsx","xlsm","ppt","pptx"];t.filepath=t.filepath.replace(/http:/,"https:"),this.downloadUrl=t.filepath,a.includes(i)?this.downloadUrl="https://view.officeapps.live.com/op/view.aspx?src="+encodeURIComponent(t.filepath):s.includes(i)?this.downloadUrl=t.filepath:this.$message.info("文件格式不支持预览，下载后查看"),setTimeout((function(){e.$refs.a_click.click()}),100)}},downloadFile:function(t){var e=document.createElement("a");fetch(t.filepath).then((function(t){return t.blob()})).then((function(i){e.href=URL.createObjectURL(i),console.log(e.href),e.download=t.filename,document.body.appendChild(e),e.click()}))}}},m=_,b=(i("51ad"),i("2877")),g=Object(b["a"])(m,s,a,!1,null,"310be1dc",null);e["a"]=g.exports},"498a":function(t,e,i){"use strict";var s=i("23e7"),a=i("58a8").trim,o=i("c8d2");s({target:"String",proto:!0,forced:o("trim")},{trim:function(){return a(this)}})},"51ad":function(t,e,i){"use strict";i("b288")},"7db0":function(t,e,i){"use strict";var s=i("23e7"),a=i("b727").find,o=i("44d2"),n="find",r=!0;n in[]&&Array(1)[n]((function(){r=!1})),s({target:"Array",proto:!0,forced:r},{find:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}}),o(n)},"7e0b":function(t,e,i){"use strict";i("c12d")},acd6:function(t,e,i){"use strict";i("d3b7"),i("3ca3"),i("ddb0"),i("2b3d"),i("9861");var s=i("bc3a"),a=i.n(s),o=i("f121"),n=o["b"];e["a"]=function(t,e,i){return new Promise((function(s,o){var r=function(){"/Template/GetTemplate"==t?a()({method:"post",url:n+t,data:e,headers:{"Content-Type":"application/json;charset=utf-8"}}).then((function(t){var s=document.createElement("a"),a=t.data.path.substring(t.data.path.lastIndexOf("."));fetch(t.data.path).then((function(t){return t.blob()})).then((function(t){s.href=URL.createObjectURL(t),console.log(s.href),5==e.type||e.type,s.download=i+a,document.body.appendChild(s),s.click()}))})):a()({method:"post",url:n+t,data:e,responseType:"blob",headers:{"Content-Type":"application/json;charset=utf-8"}}).then((function(s){console.log(s);var a=s.data,o=new FileReader;o.readAsDataURL(a),o.onload=function(s){var a=document.createElement("a");a.style.display="none","/quotation/exportexcel"==t||"/SettlementSheet/ExportExcel1"==t||"/orderform/exportexcel"==t||"/Quotation/ExportExcel"==t?a.download=i+".xls":"/Template/GetTemplate"==t?5==e.type||6==e.type?a.download=i+".docx":a.download=i+".xls":"/Reporting/GetExcel"==t&&(a.download=i+".xls"),a.href=s.target.result;document.body;document.body.appendChild(a),a.click(),document.body.removeChild(a)}}))};r()}))}},b288:function(t,e,i){},c12d:function(t,e,i){},c8d2:function(t,e,i){var s=i("5e77").PROPER,a=i("d039"),o=i("5899"),n="​᠎";t.exports=function(t){return a((function(){return!!o[t]()||n[t]()!==n||s&&o[t].name!==t}))}},f2ac:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("a",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"a_click",attrs:{href:t.downloadUrl,target:"_blank",download:""}}),i("div",{staticClass:"main"},[i("ul",[i("el-button",{attrs:{type:"text"},on:{click:function(e){return t.$router.replace({path:"/EventList"})}}},[t._v("我的会议")]),i("li",{staticStyle:{color:"#7c7f82"}},[t._v(">")]),i("el-button",{attrs:{type:"text"},on:{click:function(e){return t.$router.go(-1)}}},[t._v("会议详情")]),t.prev?i("li",{staticStyle:{color:"#7c7f82"}},[t._v(">")]):t._e(),t.prev?i("el-button",{attrs:{type:"text"},on:{click:function(e){return t.$router.go(-1)}}},[t._v(t._s(t.prev))]):t._e(),i("li",{staticStyle:{color:"#7c7f82"}},[t._v(">")]),i("li",{staticStyle:{color:"#7c7f82"}},[t._v("报价单详情")])],1)]),i("div",{staticClass:"blue_title"},[i("span",[t._v("会议服务商报价单")]),i("div",{staticClass:"rights"},[i("p",{staticStyle:{cursor:"pointer",top:"12px"},on:{click:t.excelexport}},[t._v("下载报价单")])])]),t.isCancel?i("div",{staticClass:"order_cancel_notice"},[t._m(0),i("div",{staticClass:"cancel_detail"},[i("span",[t._v("取消人："+t._s(t.cancelInfo.cancel_people))]),i("span",[t._v("时间："+t._s(t.cancelInfo.cancel_time))]),i("span",[t._v("取消原因: "+t._s(t.cancelInfo.content))])])]):t._e(),i("div",{staticClass:"base-part"},[i("base-part",{attrs:{source:"bid"}})],1),i("quotation-part",{ref:"quotations",staticClass:"service"}),i("div",{staticClass:"Confirm"},[i("p",{staticStyle:{color:"red"}},[t._v(t._s(this.messText))]),t.isCancel||4===t.servicer.type?t._e():i("div",[i("button",{directives:[{name:"show",rawName:"v-show",value:1!==t.servicer.type&&2!==t.servicer.type&&3!==t.servicer.type,expression:"servicer.type !== 1 && servicer.type !== 2 && servicer.type !== 3"}],staticClass:"b1",on:{click:t.yao}},[t._v("邀请重新报价")]),i("button",{directives:[{name:"show",rawName:"v-show",value:1!==t.servicer.type&&3!==t.servicer.type&&"0014-5"!=t.servicer.status,expression:"servicer.type !== 1 && servicer.type !== 3 && servicer.status != '0014-5'"}],staticClass:"purchase",on:{click:function(e){return t.Confirm()}}},[t._v(" "+t._s(1==t.servicer.whether?"提交审核":"提交中标")+" ")]),i("button",{directives:[{name:"show",rawName:"v-show",value:1!==t.servicer.type&&3!==t.servicer.type,expression:"servicer.type !== 1 && servicer.type !== 3"}],on:{click:t.decline}},[t._v("谢绝报价")]),"0014-5"==t.servicer.status?i("span",{staticStyle:{"margin-left":"30px"}},[t._v("草稿，更新时间："+t._s(t.servicer.offer_data))]):t._e()]),i("div",{staticClass:"blueness"}),i("div",{staticClass:"inputs"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.leaveWordMsg,expression:"leaveWordMsg"}],attrs:{type:"text",placeholder:"在此给会议服务商留言,您的每条留言系统都会邮件通知到会议服务商...."},domProps:{value:t.leaveWordMsg},on:{input:function(e){e.target.composing||(t.leaveWordMsg=e.target.value)}}}),i("div",{staticClass:"teng"},[i("button",{staticClass:"mark",on:{click:t.sendMsg}},[t._v("立即发送给会议服务商")])]),1==this.$route.query.type&&"0"!==t.servicer.supplier_type?i("div",{staticClass:"text_left",staticStyle:{"margin-top":"10px"}},[i("el-upload",{ref:"upload",attrs:{action:t.UploadFilesUrl,limit:1,"before-upload":t.fileLimit,"on-exceed":t.overLimit,"on-success":t.uploadFile,"on-preview":t.handlePreview,"on-remove":t.deleteFile,"file-list":t.fileList,"show-file-list":!0,multiple:!0}},[i("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[t._v("选择文件")])],1),i("br"),i("span",{staticClass:"ps"},[t._v("注释：选择文件上传后，需点击“立即发送给会议供应商”，您上传的文件和填写的文字消息系统会回传给会议服务商")])],1):t._e(),i("div",{staticStyle:{"margin-top":"20px","border-top":"1px solid #ccc","padding-top":"10px"}},t._l(t.messageList,(function(e,s){return i("div",{key:s,staticStyle:{margin:"10px 0"}},[i("p",[t._v(t._s(e.username)+" @ "+t._s(e.createtime))]),1==e.message_type?i("div",{staticClass:"message_txt"},[i("span",{staticClass:"fileMseeage",on:{click:function(i){return t.handlePreview(e.message)}}},[t._v(" "+t._s(e.message.slice(0,e.message.indexOf(",")))+" ")])]):i("p",[t._v(t._s(e.message))])])})),0)])]),t._m(1),t._l(t.quotation,(function(e,s){return i("div",{key:s,staticClass:"six"},[i("ul",[i("li",{staticStyle:{"margin-left":"15px"}},[t._v("第 "+t._s(s+1)+" 次报价")]),i("li",{staticStyle:{color:"#787878 font-size:14px","margin-left":"15px"}},[t._v("总金额:")]),i("li",{staticStyle:{color:"#f91","margin-left":"10px"}},[t._v("￥ "+t._s(t.positiveFloat(e.total_price).toFixed(2)))]),i("li",{staticStyle:{"margin-left":"10px",color:"#bebebe"}},[t._v(t._s(e.offer_data))]),i("li",{staticClass:"checkOffer",on:{click:function(i){return t.checkOffer(e)}}},[t._v("查看报价")]),0==s?i("li",{staticStyle:{color:"#787878","margin-left":"10px"}},[t._v("初次报价")]):t._e(),s>0?i("li",{staticStyle:{color:"#787878","margin-left":"10px"}},[t.riseInPrice(e,s)>0?i("span",[t._v(" 较上次有效报价提高 "),i("span",{staticStyle:{color:"#f00",margin:"0 5px"}},[t._v("￥"+t._s(t.riseInPrice(e,s)))]),i("span",{staticStyle:{color:"#f00"}},[t._v(" "+t._s(t.riseInPriceRatio(e,s)))])]):t._e(),t.riseInPrice(e,s)<=0?i("span",[t._v(" 较上次有效报价优惠 "),i("span",{staticStyle:{color:"#090",margin:"0 5px"}},[t._v("￥"+t._s(t.priceFavorable(e,s)))]),i("span",{staticStyle:{color:"#090"}},[t._v(" "+t._s(t.priceFavorableRatio(e,s)))])]):t._e()]):t._e()])])})),i("el-dialog",{attrs:{title:"不满意，需要会议服务商重新报价",visible:t.centerDialogVisible,width:"30%",center:""},on:{"update:visible":function(e){t.centerDialogVisible=e}}},[i("span",{staticClass:"contentd"},[t._v("重新报价截止时间")]),i("div",{staticClass:"black"},[i("el-date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间","default-time":"12:00:00","picker-options":t.pickerOptions0},model:{value:t.reOfferendDate,callback:function(e){t.reOfferendDate=e},expression:"reOfferendDate"}})],1),i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.textValue,expression:"textValue"}],staticClass:"leave",attrs:{name:"",id:"",cols:"30",rows:"10",placeholder:"请留言告知不满意的原因,方便会议服务商调整价格。如:客房部分价格降低10%,会场设备建议免费"},domProps:{value:t.textValue},on:{input:function(e){e.target.composing||(t.textValue=e.target.value)}}}),i("span",{directives:[{name:"show",rawName:"v-show",value:t.invalid,expression:"invalid"}],staticStyle:{color:"red",display:"block"}},[t._v("请输入要求重新报价的理由")]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{staticClass:"submit",attrs:{type:"primary"},on:{click:function(e){return t.quote(3)}}},[t._v("提交")])],1)]),i("el-dialog",{attrs:{title:"确认中标总金额",visible:t.Visible,width:"50%",center:"","close-on-click-modal":!1},on:{"update:visible":function(e){t.Visible=e}}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.isBid,expression:"isBid"}]},[i("div",{staticClass:"send_ft"},[t._v(" 请勾选本次会议所有需要中标的报价，以确认是否超出预算： ")]),i("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.tableData,fit:"","show-header":!1,"tooltip-effect":"dark"},on:{"row-click":t.checkedRow,select:t.selectRow,"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",selectable:t.isDisabled}}),i("el-table-column",{attrs:{label:"询价单"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" 询价单号【"+t._s(e.row.inquiry_sheet_code)+"】 ")]}}])}),i("el-table-column",{attrs:{prop:"name",label:"公司","show-overflow-tooltip":""}}),i("el-table-column",{attrs:{prop:"total_price",label:"金额"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",{staticStyle:{color:"#f91"}},[t._v("￥"+t._s(t.positiveFloat(e.row.total_price).toFixed(2)))])]}}])})],1),i("div",[i("span",[t._v("总金额："),i("span",{staticStyle:{color:"#f91","font-weight":"bold"}},[t._v(t._s("￥"+t.bidTotalMoney.toFixed(2)))])]),i("span",{staticStyle:{"margin-left":"200px"}},[t._v("预算："),i("span",{staticStyle:{color:"#f91","font-weight":"bold"}},[t._v(t._s("￥"+t.menus.total_budget))])])])],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.Visible=!1}}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.confirmBid(1)}}},[t._v("确 定")])],1)]),i("el-dialog",{attrs:{title:"提示",visible:t.canotBidVisible,width:"30%",center:""},on:{"update:visible":function(e){t.canotBidVisible=e}}},[i("div",[i("span",{staticClass:"winning"},[t._v("当前报价尚未通过中标审批，无法中标。")])]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.canotBidVisible=!1}}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:function(e){t.canotBidVisible=!1}}},[t._v("确 定")])],1)]),i("el-dialog",{staticClass:"finalConfirm",attrs:{visible:t.finalConfirmVisible,width:"40%",center:""},on:{"update:visible":function(e){t.finalConfirmVisible=e}}},[i("div",{attrs:{slot:"title"},slot:"title"},[i("h3",[t._v("确认中标，发送PO/合同")]),i("p",{staticStyle:{"font-size":"14px",color:"#7e7f80","text-align":"center","line-height":"20px"}},[t._v("确认中标后，系统会发确认订单及中标通知给会议服务商")])]),i("div",{staticClass:"pop_box"},[i("div",{staticClass:"send_box clx"},[i("div",{staticClass:"offline selected"},[i("div",{staticClass:"send_ft"},[t._v("点击“确定中标”后， 会议服务商会收到中标通知 ，您可按需进行线下合同操作")]),i("div",{staticClass:"send_list"},[i("div",{staticClass:"sl_title"},[t._v("会议服务商信息")]),i("p",[t._v("姓名：luke")]),i("p",[t._v("手机号：13917031506")]),i("p",[t._v("邮箱：luke.lu@hotelgg.com")])])])]),i("div",{staticClass:"dl_box"},[i("div",{staticClass:"send_dl clx"},[i("span",[t._v("附件：")]),i("a",{attrs:{href:"/cmms/event/MID20211020208490/rfp/dmc/DO211020526834/offer/35330/export?export=excel",target:"_blank"}},[i("i",{staticClass:"ico"},[t._v("")]),t._v("会议服务商报价单")])]),i("p",{staticClass:"dl_txt"},[t._v("点击附件名称即可预览附件")])]),i("div",{staticClass:"send_bz"},[i("textarea",{attrs:{placeholder:"请输入中标操作的备注信息（非必填）",id:"accept_mark"}})]),i("div",{staticClass:"decline_check"},[i("label",[i("input",{attrs:{type:"checkbox",id:"refuse"}}),t._v(" 选择此会议服务商中标后自动谢绝其他会议服务商的报价 ")])])]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{staticClass:"finalConfirmBtn",attrs:{type:"primary"},on:{click:function(e){return t.quote(1)}}},[t._v("确 定 中 标")])],1)]),i("el-dialog",{attrs:{title:"谢绝报价",visible:t.declineVisible,width:"30%",center:""},on:{"update:visible":function(e){t.declineVisible=e}}},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.textValue,expression:"textValue"}],staticClass:"top",attrs:{name:"",id:"",cols:"30",rows:"10",placeholder:"请输入拒绝理由"},domProps:{value:t.textValue},on:{input:function(e){e.target.composing||(t.textValue=e.target.value)}}}),i("span",{directives:[{name:"show",rawName:"v-show",value:t.invalid,expression:"invalid"}],staticClass:"turn",staticStyle:{color:"red",display:"block"}},[t._v("请输入拒绝理由")]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{staticClass:"cannot",attrs:{type:"primary"},on:{click:function(e){return t.quote(2)}}},[t._v("谢绝报价")])],1)])],2)},a=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("h3",{staticClass:"title"},[i("strong",[t._v("询价单已取消，此报价单已失效。")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"gray"},[i("p",[t._v("以上是用户第 1 次报价 （最新报价），以下为历史报价记录")])])}],o=(i("b680"),i("7db0"),i("d3b7"),i("159b"),i("a9e3"),i("498a"),i("e9c4"),i("ac1f"),i("1276"),i("3ca3"),i("ddb0"),i("2b3d"),i("9861"),i("b0c0"),i("fb6a"),i("5319"),i("caad"),i("cf45")),n=i("7dc4"),r=i("0751"),l=i("2654"),c=i("f121"),d=i("df68"),u=i("acd6"),f={data:function(){return{UploadFilesUrl:c["b"]+"/MeetingMa/UploadFiles",downloadUrl:"",prev:"",selectQuery:{},menus:{},quotation:{},servicer:{},arr1:[],leaveWordMsg:"",filesList:[],fileList:[],messageList:[],uploadFileInfo:{},tableData:[],declineVisible:!1,centerDialogVisible:!1,finalConfirmVisible:!1,Visible:!1,canotBidVisible:!1,pickerOptions:{shortcuts:[{text:"今天",onClick:function(t){t.$emit("pick",new Date)}},{text:"昨天",onClick:function(t){var e=new Date;e.setTime(e.getTime()-864e5),t.$emit("pick",e)}},{text:"一周前",onClick:function(t){var e=new Date;e.setTime(e.getTime()-6048e5),t.$emit("pick",e)}}]},isBid:"待审核"!=this.$route.query.type,messText:"",value1:"",value2:"",reOfferendDate:new Date((new Date).getTime()+864e5),textValue:"",bidTotalMoney:0,invalid:!1,pickerOptions0:{},afresh:!0,status:0,quotationIds:"",hasSelect:!1,cancelInfo:{},isCancel:!1}},components:{QuotationPart:r["a"],BasePart:n["a"]},watch:{$route:function(t,e){t.fullPath!==e.fullPath&&this.maker()}},computed:{riseInPrice:function(){return function(t,e){var i=t.total_price-this.quotation[e-1].total_price;return i.toFixed(2)}},riseInPriceRatio:function(){return function(t,e){var i=(t.total_price-this.quotation[e-1].total_price)/this.quotation[e-1].total_price*100;return i.toFixed(2)+"%"}},priceFavorable:function(){return function(t,e){var i=this.quotation[e-1].total_price-t.total_price;return i.toFixed(2)}},priceFavorableRatio:function(){return function(t,e){var i=(this.quotation[e-1].total_price-t.total_price)/this.quotation[e-1].total_price*100;return i.toFixed(2)+"%"}}},mounted:function(){this.maker(),this.Service(),this.GetCancel(),this.prev=this.$route.query.prev},methods:{excelExport:u["a"],positiveFloat:function(t){return Object(o["m"])(t)},Service:function(){var t=this;this.selectQuery=this.$route.query,this.$api.getData({MeetingID:this.selectQuery.id},"POST").then((function(e){t.menus=e,t.pickerOptions0.disabledDate=function(e){var i=t.menus.event_startdate;return e.getTime()<Date.now()-864e5||e.getTime()>new Date(i).getTime()}}))},getMessage:function(){var t=this,e=this.servicer.inquiry_sheet_object_id;this.$api.GetMessage({InquirySheetObjectID:e},"POST").then((function(e){t.messageList=e||[]}))},checkOffer:function(t){t.id==this.$route.query.foreign_key_id?(this.Service(),this.maker()):this.$router.push({path:"/offer",query:{foreign_key_id:t.id,id:this.$route.query.id,type:this.$route.query.type}})},GetCancel:function(){var t=this;this.$api.GetCancel({ID:this.$route.query.inquiryListId},"POST").then((function(e){t.cancelInfo=e,e.cancel_time&&(t.isCancel=!0)}))},checkedRow:function(t,e,i){1==t.state&&this.$refs.multipleTable.toggleRowSelection(t,!0)},selectRow:function(t,e){1==e.state&&this.$refs.multipleTable.toggleRowSelection(e,!0),this.hasSelect=!!t.find((function(t){return 2==t.state}))},isDisabled:function(t,e){return 1!=t.state},handleSelectionChange:function(t){var e=this;this.bidTotalMoney=0,this.quotationIds="",t.forEach((function(i){e.bidTotalMoney+=Number(i.total_price),t.length>1?e.quotationIds+=i.id+",":e.quotationIds=i.id})),console.log(this.quotationIds,this.$route.query)},eventBaseInfo:function(t){this.eventBaseInfo=t},quote:function(t){var e=this,i={status:t,id:this.$route.query.foreign_key_id,inquiry_sheet_object_id:this.$route.query.serviceId,message:""};if(1!==t){if(""===this.textValue.trim())return this.invalid=!0,!1;i.message=this.textValue,3==t&&(i.offerenddate=this.reOfferendDate)}this.invalid=!1,this.$api.Declined({Parameter:JSON.stringify(i)},"POST").then((function(t){if(e.arr1=t,t){if(e.$message({message:t.msg,type:"success"}),e.centerDialogVisible=!1,e.Visible=!1,e.canotBidVisible=!1,e.declineVisible=!1,"未审批完成，请勿重复点击"==t)return;e.$router.go(-1),e.maker()}}))},yao:function(){this.centerDialogVisible=!0,this.invalid=!1},Confirm:function(t){var e=this,i={status:1,type:t||0,id:this.$route.query.foreign_key_id,inquiry_sheet_object_id:this.servicer.inquiry_sheet_object_id},s=this;this.$api.Declined({Parameter:JSON.stringify(i)},"POST").then((function(t){if(console.log(t),"client"===t.data)return e.$confirm(t.msg,"提示",{showCancelButton:!1,center:!0});1===t.data||0===t.data?e.$api.WinTheBiddingQuotedPrice({MeetingID:e.$route.query.id,type:t.data},"POST").then((function(t){e.Visible=!0,e.tableData=t,e.$nextTick((function(){e.tableData.forEach((function(t,e){1==t.state&&s.$refs.multipleTable.toggleRowSelection(t,!0)}))}))})):!0===t.data?(e.$message({message:t.msg,type:"success"}),e.$router.go(-1),e.maker()):e.$confirm(t.msg,"提示",{confirmButtonText:"查看审批进度",cancelButtonText:"取消",center:!0}).then((function(){e.$router.push({path:"/cmms",query:{id:e.$route.query.id,ApproveID:t.data.ApproveID}})})).catch((function(){}))}))},ConfirmTempFn:function(){var t=this,e={status:1,id:this.$route.query.foreign_key_id,inquiry_sheet_object_id:this.$route.query.serviceId,message:""};this.$api.Temporary({Parameter:JSON.stringify(e)},"POST").then((function(e){t.$message({message:"确认中标成功",type:"success"}),t.maker()}))},confirmBid:function(){var t=this;if(this.quotationIds&&this.hasSelect){var e={id:this.quotationIds,event_info_id:this.$route.query.id,total_price:this.bidTotalMoney};this.$api.WinningTheBidApprove({Parameter:JSON.stringify(e)},"POST").then((function(e){console.log(e),1===e?t.$confirm("没有审批流程，是否直接提交中标?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.Confirm(1),t.Visible=!1})):2===e?t.$confirm("暂无中标审批步骤！，是否要发送该报价单?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.NoConfirm(),t.Visible=!1})):3===e?t.$confirm("该报价已完成发送客户审批处理","提示",{confirmButtonText:"确定",showCancelButton:!1,type:"warning"}).then((function(){t.Visible=!1})):(t.$message({message:"操作成功",type:"success"}),t.Visible=!1,t.maker())}))}else this.$message.error("请选择中标报价")},NoConfirm:function(){var t=this;this.$api.SendQuotedPrice({quotedPriceID:this.quotationIds.split(",")},"POST").then((function(e){console.log(e),t.maker()}))},decline:function(){this.declineVisible=!0,this.invalid=!1},downloadOffer:function(){this.quotationIds?this.$api.QuotedPriceSettlementExcel({QuotedPriceID:this.quotationIds},"POST").then((function(t){if(t){var e=document.createElement("a");fetch(t).then((function(t){return t.blob()})).then((function(t){e.href=URL.createObjectURL(t),e.download="报价单",document.body.appendChild(e),e.click()}))}})):this.$message.error("请勾选需要下载的报价单")},excelexport:function(){var t="DMC报价单"+this.$route.query.id;this.excelExport("/Template/GetTemplate",{eventid:this.$route.query.id,type:3,param:this.$route.query.foreign_key_id},t)},fileLimit:function(t){var e=t.size/1024/1024<30;return e?Object(d["a"])(t):(this.$message.error("上传附件大小不能超过 30MB!"),!1)},uploadFile:function(t){this.uploadFileInfo=t,this.filesList.push({name:t.title,url:t.weburl})},overLimit:function(t,e){this.$message.error("文件只能上传一份")},deleteFile:function(t,e){var i=this;this.filesList=[],e.forEach((function(t){i.filesList.push({name:t.name,url:t.url})}))},sendMsg:function(){var t=this,e={inquiry_sheet_object_id:this.servicer.inquiry_sheet_object_id,message:"",message_type:0};this.leaveWordMsg&&(e.message=this.leaveWordMsg,this.$api.sendMsg({Parameter:JSON.stringify(e)},"POST").then((function(e){e&&(t.getMessage(),t.$message({message:"消息发送成功",type:"success"}),t.leaveWordMsg="")}))),this.filesList.forEach((function(i,s){e.message=i.name+","+i.url,e.message_type=1,t.$api.sendMsg({Parameter:JSON.stringify(e)},"POST").then((function(e){e&&0==s&&(t.$message({message:"文件发送成功",type:"success"}),t.leaveWordMsg="",t.getMessage())}))}))},handlePreview:function(t){var e=this,i=t.slice(t.lastIndexOf(",")+1);t.slice(0,t.lastIndexOf(","));if(i){var s=i.substring(i.lastIndexOf(".")+1),a=["pdf","jpeg","jpg","png","txt"],o=["docx","doc","xls","xlsx","xlsm","ppt","pptx"];i=i.replace(/http:/,"https:"),this.downloadUrl=i,o.includes(s)?this.downloadUrl="https://view.officeapps.live.com/op/view.aspx?src="+encodeURIComponent(i):a.includes(s)?this.downloadUrl=i:this.$message.info("文件格式不支持预览，下载后查看"),setTimeout((function(){e.$refs.a_click.click()}),100)}},downloadFile:function(t){var e=t.slice(t.lastIndexOf(",")+1),i=t.slice(0,t.lastIndexOf(",")),s=document.createElement("a");s.href=e,s.download=i,document.body.appendChild(s),s.click()},hotel:function(){var t=this;this.$api.Usage({QuotedPriceID:this.$route.query.foreign_key_id},"POST").then((function(e){console.log(e),t.quotation=e.quotedprice}))},maker:function(){var t=this;this.$api.Usage({QuotedPriceID:this.$route.query.foreign_key_id},"POST").then((function(e){e&&(t.servicer=e.service,t.$refs.quotations.hotelInfo=e.service,t.$refs.quotations.roomList=Object(l["c"])(e.room),t.$refs.quotations.eventList=Object(l["a"])(e.conference),t.$refs.quotations.carList=Object(l["c"])(e.car,"datatime"),t.$refs.quotations.foodList=Object(l["c"])(e.food),t.$refs.quotations.foodOutsideList=Object(l["c"])(e.foodOutside),t.$refs.quotations.otherList=e.other?e.other:[],t.$refs.quotations.additional=e.quoted_price,t.$refs.quotations.transportList=Object(l["c"])(e.transportation,"datatime"),t.quotation=e.quotedprice,1==t.servicer.type?t.messText="该报价已中标！":2===t.servicer.type?t.messText="已通知会议服务商重新报价！":3==t.servicer.type?t.messText="您已谢绝该报价!":4==t.servicer.type?t.messText="服务商已提交最新报价!":t.messText="",t.getMessage())}))}}},p=f,h=(i("7e0b"),i("2877")),v=Object(h["a"])(p,s,a,!1,null,"1d95c2ad",null);e["default"]=v.exports}}]);