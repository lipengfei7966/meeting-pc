(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ab76475c"],{acd6:function(t,e,i){"use strict";i("d3b7"),i("3ca3"),i("ddb0"),i("2b3d"),i("9861");var s=i("bc3a"),o=i.n(s),n=i("f121"),a=n["b"];e["a"]=function(t,e,i){return new Promise((function(s,n){var r=function(){"/Template/GetTemplate"==t?o()({method:"post",url:a+t,data:e,headers:{"Content-Type":"application/json;charset=utf-8"}}).then((function(t){var s=document.createElement("a"),o=t.data.path.substring(t.data.path.lastIndexOf("."));fetch(t.data.path).then((function(t){return t.blob()})).then((function(t){s.href=URL.createObjectURL(t),console.log(s.href),5==e.type||e.type,s.download=i+o,document.body.appendChild(s),s.click()}))})):o()({method:"post",url:a+t,data:e,responseType:"blob",headers:{"Content-Type":"application/json;charset=utf-8"}}).then((function(s){console.log(s);var o=s.data,n=new FileReader;n.readAsDataURL(o),n.onload=function(s){var o=document.createElement("a");o.style.display="none","/quotation/exportexcel"==t||"/SettlementSheet/ExportExcel1"==t||"/orderform/exportexcel"==t||"/Quotation/ExportExcel"==t?o.download=i+".xls":"/Template/GetTemplate"==t?5==e.type||6==e.type?o.download=i+".docx":o.download=i+".xls":"/Reporting/GetExcel"==t&&(o.download=i+".xls"),o.href=s.target.result;document.body;document.body.appendChild(o),o.click(),document.body.removeChild(o)}}))};r()}))}},ada3:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=this,i=e.$createElement,s=e._self._c||i;return s("div",{staticClass:"orderInfo"},[s("a",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"d_click",attrs:{href:e.downloadUrl,target:"_blank",download:""}}),s("div",{staticClass:"title"},[e._v(" 我的订单 - "),e.info?[e._v(" "+e._s(e.info.num)+" ")]:e._e()],2),e.info?s("div",{staticClass:"content"},["0020-1"===this.info.status?s("div",{staticClass:"tips"},[s("p",[e._v("订单状态：订单执行中")]),s("p",[e._v("会议进行中，请实时上传结算凭证文件！")]),s("p",[s("el-button",{attrs:{type:"primary"},on:{click:e.settlement}},[e._v(" "+e._s(e.info.settlement_sheet_status===e.settlement_sheet_status_draft?"提交结算单(草稿)":"提交结算单")+" ")])],1)]):e._e(),"0020-3"===this.info.status?s("div",{staticClass:"tips"},[s("p",[e._v("订单状态：已创建待执行")]),s("p",[e._v(" 请查看以下订单详情，如果客户需要使用会议室等场地，请为客户预留档期。 ")]),s("p",{staticClass:"special"},[s("span",[e._v("如果您遇到特殊情况需要取消订单，可以点击")]),s("el-link",{staticClass:"special_link",attrs:{name:"cancel",type:"primary"},on:{click:e.cancelorderform}},[e._v("取消订单")]),s("span",[e._v("并说明原委，我们将同时为您发送短信和邮件向客户致歉。")])],1)]):"0020-2"===this.info.status?s("div",{staticClass:"tips"},[s("p",[e._v("订单状态：已取消")]),s("p",[e._v(" "+e._s(e.info.contacts)+" - "+e._s(e.info.company_name)+" - 取消了订单 ("+e._s(e.info.activity_name)+") ")])]):e._e(),"0020-4"===this.info.status?s("div",{staticClass:"tips"},[s("p",[e._v("订单状态：已执行待结算")]),s("p",[e._v(" 会议服务商服务已经结束，请向客户提交结算单。结算单被确认后，您可以快递发票和结算单，以便客户付款。 ")]),s("p",[s("el-button",{attrs:{type:"primary"},on:{click:e.settlement}},[e._v(" "+e._s(e.info.settlement_sheet_status===e.settlement_sheet_status_draft?"提交结算单(草稿)":"提交结算单")+" ")])],1)]):"0020-5"===this.info.status?s("div",{staticClass:"tips"},[s("p",[e._v("订单状态：待确认结算单")]),s("p",{staticClass:"special"},[s("span",[e._v("已提交结算单，正在等待客户确认。 ")]),s("span",[e._v("审批环节："+e._s(e.info.approval_phase)+"， ")]),s("span",[e._v("审批人："+e._s(e.info.approval_people)+" ")])]),s("p",[s("el-button",{attrs:{type:"primary"},on:{click:e.settlement}},[e._v("查看结算单")])],1)]):"0020-6"===this.info.status?s("div",{staticClass:"tips"},[s("p",[e._v("订单状态：已确认结算单")]),s("p",[e._v("客户确认了您的结算单，您可以与客户沟通发票、付款的事宜。")])]):"0020-7"===this.info.status?s("div",{staticClass:"tips"},[s("p",[e._v("订单状态：客户驳回结算单")]),s("p",[e._v("客户对结算单有异议，请查看、修改后重新移交结算单。")]),this.info.orderform_settlement_customer_objection?s("p",[e._v(" 客户异议： "),s("el-button",{staticStyle:{"font-size":"16px"},attrs:{type:"text"},on:{click:function(t){e.objectionVisible=!0}}},[e._v(" 查看异议 ")])],1):e._e(),s("p",[s("el-button",{attrs:{type:"primary"},on:{click:e.settlement}},[e._v("提交结算单")])],1)]):"0020-8"===this.info.status?s("div",{staticClass:"tips"},[s("p",[e._v("订单状态：要求补充结算单材料")]),s("p",[e._v("客户对结算单有异议，请查看、修改后重新移交结算单。")]),this.info.orderform_settlement_customer_objection?s("div",[e._v(" 客户异议： "),s("el-button",{staticStyle:{"font-size":"16px"},attrs:{type:"text"},on:{click:function(t){e.objectionVisible=!0}}},[e._v(" 查看异议 ")])],1):e._e(),s("p",[s("el-button",{attrs:{type:"primary"},on:{click:e.settlement}},[e._v("提交结算单")])],1)]):e._e(),s("div",{staticClass:"diameter"},[s("el-collapse",{attrs:{accordion:""}},e._l(e.select,(function(t,i){return s("el-collapse-item",{key:i},[s("template",{slot:"title"},[e._v(" 第"+e._s(i+1)+"次结算记录： "),t.showDetail?e._e():s("span",{on:{click:function(e){t.showDetail=!t.showDetail}}},[s("i",{staticClass:"header-icon el-icon-caret-top"}),e._v(" 展开 ")]),t.showDetail?s("span",{on:{click:function(e){t.showDetail=!t.showDetail}}},[s("i",{staticClass:"header-icon el-icon-caret-bottom"}),e._v(" 收起 ")]):e._e()]),e._l(t.data,(function(t,i){return s("div",{key:i,staticStyle:{margin:"10px 0","border-bottom":"1px solid #ccc"}},[s("p",[e._v(e._s(t.date))]),s("p",[e._v(e._s(t.username)+" ( "+e._s(t.company_name)+" )")]),s("p",[e._v(e._s(t.state))]),s("div",{staticClass:"objectionDetailStyle",domProps:{innerHTML:e._s(t.message)},on:{click:function(t){return e.getImg(t)}}}),e._l(t.array,(function(t,i){return s("div",{key:i,staticClass:"flex_row"},[s("p",[e._v(e._s(t.name)+":")]),s("p",e._l(t.value,(function(t,i){return s("span",{key:i,staticClass:"filename",on:{click:function(i){return e.handlePreview(t)}}},[e._v(" "+e._s(t.name)+" ")])})),0)])})),e._l(t.dissent,(function(t,i){return s("div",{key:i,staticClass:"flex_row"},[s("p",[e._v(e._s(t.name)+":")]),s("p",[e._v(" "+e._s(t.value)+" ")])])}))],2)}))],2)})),1)],1),s("div",{staticClass:"info"},[s("div",{staticClass:"line"},[s("div",{staticClass:"item"},[s("div",{staticClass:"label"},[e._v("订单号")]),s("div",{staticClass:"context"},[e._v(e._s(e.info.num))])]),s("div",{staticClass:"item"},[s("div",{staticClass:"label"},[e._v("联系人")]),s("div",{staticClass:"context"},[e._v(e._s(e.info.contacts))])])]),s("div",{staticClass:"line"},[s("div",{staticClass:"item"},[s("div",{staticClass:"label"},[e._v("下单时间")]),s("div",{staticClass:"context"},[e._v(e._s(e._f("date_ex")(e.info.submit_time)))])]),s("div",{staticClass:"item"},[s("div",{staticClass:"label"},[e._v("联系方式")]),s("div",{staticClass:"context"},[e._v(" "+e._s(e.info.customer_service_telephone_numbers)+" ")])])]),s("div",{staticClass:"line"},[s("div",{staticClass:"item"},[s("div",{staticClass:"label"},[e._v("活动名称")]),s("div",{staticClass:"context"},[e._v(e._s(e.info.activity_name))])]),s("div",{staticClass:"item"},[s("div",{staticClass:"label"},[e._v("客户名称")]),s("div",{staticClass:"context"},[e._v(e._s(e.info.company_name))])])]),s("div",{staticClass:"line"},[s("div",{staticClass:"item"},[s("div",{staticClass:"label"},[e._v("活动日期")]),s("div",{staticClass:"context"},[e._v(e._s(e.info.activity_date))])]),s("div",{staticClass:"item"},[s("div",{staticClass:"label"},[e._v("报价日期")]),s("div",{staticClass:"context"},[e._v(e._s(e._f("date_ex")(e.info.offer_data)))])])]),s("div",{staticClass:"line"},[s("div",{staticClass:"item"},[s("div",{staticClass:"label"},[e._v("采购酒店")]),s("div",{staticClass:"context"},[e._v(e._s(e.info.hotel_name))])])])]),1==e.whetherShow.kp_notice_file||1==e.whetherShow.invoice_file||1==e.whetherShow.cvent_date?s("div",{staticClass:"info"},[s("div",{staticClass:"line"},[1==e.whetherShow.kp_notice_file?s("div",{staticClass:"item"},[s("div",{staticClass:"label"},[e._v("开票通知文件")]),s("div",{staticClass:"context",staticStyle:{display:"flex"}},[s("ul",{staticStyle:{"margin-right":"50px"}},e._l(e.fileList.kpFile,(function(t,i){return s("li",{key:i,staticStyle:{margin:"10px 0"}},[s("span",{staticStyle:{color:"#409eff",cursor:"pointer"},on:{click:function(i){return e.downloadFile(t)}}},[e._v(" "+e._s(t.filename)+" ")]),s("span",[e._v(" 上传时间： "+e._s(t.create_time)+" ")])])})),0),s("el-upload",{ref:"upload",attrs:{action:e.UploadFilesUrl,"on-success":e.uploadFile,"on-preview":e.downloadFile,"file-list":e.fileList.kpFile,"show-file-list":!1,multiple:!0}},[s("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选择文件")])],1)],1)]):e._e()]),s("div",{staticClass:"line"},[1==e.whetherShow.invoice_file?s("div",{staticClass:"item"},[s("div",{staticClass:"label"},[e._v("发票附件")]),s("div",{staticClass:"context"},[s("ul",e._l(e.fileList.fpFile,(function(t,i){return s("li",{key:i},[s("span",{staticStyle:{color:"#409eff",cursor:"pointer"},on:{click:function(i){return e.downloadFile(t)}}},[e._v(" "+e._s(t.filename)+" ")]),s("span",[e._v(" 上传时间： "+e._s(t.create_time)+" ")])])})),0)])]):e._e(),1==e.whetherShow.cvent_date?s("div",{staticClass:"item"},[s("div",{staticClass:"label"},[e._v("Cevent 上传完成日期")]),s("div",{staticClass:"context",staticStyle:{display:"flex","justify-content":"space-between"}},[s("span",{staticStyle:{"line-height":"30px"}},[e._v(" "+e._s(e.fileList.cventDate)+" ")]),s("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},on:{click:function(t){e.CeventDateDialog=!0}},slot:"trigger"},[e._v("编辑")])],1)]):e._e()])]):e._e(),s("div",{staticClass:"info"},[s("div",{staticClass:"line"},[s("div",{staticClass:"item"},[s("div",{staticClass:"label"},[e._v("报价人")]),s("div",{staticClass:"context"},[e._v(e._s(e.info.bidder))])]),s("div",{staticClass:"item"},[s("div",{staticClass:"label"},[e._v("报价时间")]),s("div",{staticClass:"context"},[e._v(" "+e._s(e._f("date_ex")(e.info.offer_data))+" ")])])])]),s("div",{staticClass:"info"},[s("div",{staticClass:"line"},[s("div",{staticClass:"item"},[s("div",{staticClass:"label"},[e._v("历史附件")]),s("div",{staticClass:"context"},[s("p",[e._v("客户已通过邮件发送该订单的 “询价单” 至以下人员：")]),s("p",[e._v(e._s(e.info.mailbox))]),s("p",[s("el-button",{attrs:{type:"primary"},on:{click:e.quotedprice}},[e._v("最终报价单")]),"0020-6"===this.info.status?s("el-button",{attrs:{type:"primary"},on:{click:e.settlement}},[e._v("结算单 ")]):e._e()],1)])])])]),s("div",{staticClass:"info"},[s("div",{staticClass:"line"},[s("div",{staticClass:"item"},[s("div",{staticClass:"label need",staticStyle:{width:"100%"}},[e._v(" 客户需求 "),s("div",{staticClass:"excel"},[s("a",{staticStyle:{cursor:"pointer"},on:{click:e.excelexport}},[e._v("下载excel")])])])])]),s("div",{staticClass:"line"},[s("div",{staticClass:"item"},[s("div",{staticClass:"label"},[e._v("客房需求")]),s("div",{staticClass:"context"},[e._l(e.info.quoted_price_room,(function(t){return s("div",{key:t.id,staticClass:"hyxq_item"},[s("div",{staticClass:"date"},[e._v(" 日期："+e._s(e._f("date_day")(t.date))+" 客房价格 ")]),e._l(t.room_list,(function(t){return s("div",{key:t.id,staticClass:"c_item"},[e._v(" "+e._s(t.roomtypename)+" "+e._s(t.roomcount)+"间 "),s("span",{staticClass:"quotedprice"},[e._v("报价：￥"+e._s(t.unitprice.toFixed(2))+"*"+e._s(t.provide_count)+"间 ￥"+e._s(t.totalprice.toFixed(2)))]),s("p",[e._v("报价备注："+e._s(t.remarks))])])}))],2)})),s("br"),s("br"),e._v(" 客房报价总备注："+e._s(e.info.room_remarks)+" "),s("br"),e._v(" 客房报价小计："),s("span",{staticClass:"quotedprice"},[e._v("￥"+e._s(this.allMoney.toFixed(2)))])],2)]),s("div",{staticClass:"item"},[s("div",{staticClass:"label"},[e._v("会议需求")]),s("div",{staticClass:"context"},[e._l(e.info.quoted_price_conference,(function(t){return s("div",{key:t.id,staticClass:"hyxq_item"},[s("div",{staticClass:"date"},[e._v("日期："+e._s(e._f("date_day")(t.date)))]),e._l(t.conference_list,(function(i){return s("div",{key:i.id,staticClass:"c_item"},[1==i.type?s("div",[e._v(" "+e._s(i.item+i.order_name+i.typename)+" "+e._s(i.starttime)+"-"+e._s(i.endtime)+" "+e._s(i.roomsetuptypename)+" "+e._s(i.attendees)+" 人，会场面积范围："+e._s(i.min_area)+"~"+e._s(i.max_area)+" sqm "),s("div",{staticClass:"quotedprice"},[e._v(" 报价：￥"+e._s(i.price.toFixed(2))+" ")]),s("div",[e._v("报价备注:"+e._s(i.comments))])]):2==i.type?s("div",[e._v(" "+e._s(i.related_information)+" "+e._s(e._f("date_day")(t.date))+" "+e._s(i.starttime)+"~ "+e._s(e._f("date_day")(t.date))+" "+e._s(i.endtime)+" "),s("div",{staticClass:"quotedprice"},[e._v(" 报价：￥"+e._s(i.price.toFixed(2))+" ")])]):3==i.type?s("div",[s("p",[e._v(" "+e._s(i.item+i.order_name+i.typename)+": "+e._s(i.equipment)+" ")]),s("p",[s("span",{staticClass:"quotedprice"},[e._v("报价：￥"+e._s(i.price.toFixed(2))+" ")])]),s("p",[e._v("报价备注："+e._s(i.comments))])]):4==i.type?s("div",[s("p",[e._v(" "+e._s(i.item+i.order_name+i.quoted_name)+": "+e._s(i.equipment)+" ")]),s("p",[s("span",{staticClass:"quotedprice"},[e._v("报价：￥"+e._s(i.price.toFixed(2))+" ")])]),s("p",[e._v("报价备注："+e._s(i.comments))])]):e._e()])}))],2)})),s("br"),s("br"),e._v(" 会场报价总备注："+e._s(e.info.conference_remarks)+" "),s("div",{staticClass:"quotedpricesum"},[e._v(" 会场报价小计"),s("span",{staticClass:"quotedprice"},[e._v("￥"+e._s((this.EquipmentMoney+this.meetingMoney).toFixed(2)))])])],2)])]),s("div",{staticClass:"line"},[s("div",{staticClass:"item"},[s("div",{staticClass:"label"},[e._v("酒店内用餐需求")]),s("div",{staticClass:"context"},[e._l(e.info.quoted_price_food,(function(t){return s("div",{key:t.id,staticClass:"hyxq_item"},[s("div",{staticClass:"date"},[e._v("日期："+e._s(e._f("date_day")(t.date)))]),e._l(t.food_list,(function(t){return s("div",{key:t.id,staticClass:"c_item"},[s("span",[e._v(e._s(t.foodtypename))]),e._v(" "+e._s(t.usetype?"["+t.usetype+"]":"")+" "+e._s(t.personcount)+" 人 "),s("p",{staticClass:"quotedprice"},[e._v(" 报价：￥"+e._s(t.price.toFixed(2))+"*"+e._s(t.personcount)+" 人 ￥"+e._s((t.price*t.personcount).toFixed(2))+" 备注："+e._s(t.offer_remarks)+" ")])])}))],2)})),s("br"),s("br"),s("div",{staticClass:"quotedpricesum"},[e._v(" 餐饮报价小计："),s("span",{staticClass:"quotedprice"},[e._v("￥"+e._s(this.repastAllMoney.toFixed(2)))])])],2)]),s("div",{staticClass:"item"},[s("div",{staticClass:"label"},[e._v("酒店外用餐需求")]),s("div",{staticClass:"context"},[e._l(e.info.quoted_price_outside_food,(function(t){return s("div",{key:t.id,staticClass:"hyxq_item"},[s("div",{staticClass:"date"},[e._v("日期："+e._s(e._f("date_day")(t.date)))]),e._l(t.food_list,(function(t){return s("div",{key:t.id,staticClass:"c_item"},[s("span",[e._v(e._s(t.foodtypename))]),e._v(" "+e._s(t.usetype?"["+t.usetype+"]":"")+" "+e._s(t.personcount)+" 人 "),s("p",{staticClass:"quotedprice"},[e._v(" 报价：￥"+e._s(t.price.toFixed(2))+"*"+e._s(t.personcount)+" 人 ￥"+e._s((t.price*t.personcount).toFixed(2))+" 备注："+e._s(t.offer_remarks)+" ")])])}))],2)})),s("br"),s("br"),s("div",{staticClass:"quotedpricesum"},[e._v(" 餐饮报价小计："),s("span",{staticClass:"quotedprice"},[e._v("￥"+e._s(this.otherFoodAllMoney.toFixed(2)))])])],2)])]),s("div",{staticClass:"line"},[s("div",{staticClass:"item"},[s("div",{staticClass:"label"},[e._v("交通需求")]),s("div",{staticClass:"context"},[s("p",{staticClass:"date"},[e._v("大交通")]),e._l(e.info.quoted_price_transportation,(function(t){return s("div",{key:t.id,staticClass:"hyxq_item"},[s("p",{staticClass:"date"},[e._v("日期： "+e._s(e._f("date_day")(t.date)))]),e._l(t.transportation_list,(function(t){return s("div",{key:t.id,staticClass:"c_item"},[e._v(" "+e._s(t.origincity)+" - "+e._s(t.destinationcity)+" "+e._s(t.transtypename)+" "+e._s(t.seatclassesname)+" "+e._s(t.passengercount)+"人 "),s("p",{staticClass:"quotedprice"},[e._v(" 报价：￥"+e._s(t.unitprice.toFixed(2))+"*"+e._s(t.passengercount)+" 人 ￥"+e._s((t.unitprice*t.passengercount).toFixed(2))+" 备注："+e._s(t.offerremarks)+" ")]),s("p",[e._v("报价备注："+e._s(t.requirement))])])}))],2)})),s("br"),e._v(" 大交通报价总备注："+e._s(e.info.transportation_remarks)+" "),s("br"),s("br"),s("div",{staticClass:"date"},[e._v("地面交通")]),e._l(e.info.quoted_price_car,(function(t){return s("div",{key:t.id,staticClass:"hyxq_item"},[s("div",{staticClass:"date"},[e._v("日期："+e._s(e._f("date_day")(t.date)))]),e._l(t.car_list,(function(t){return s("div",{key:t.id,staticClass:"c_item"},[s("p",[s("span",[e._v(e._s(t.purposename)+" ")]),e._v(" "+e._s(t.vehicletypename)+" "+e._s(t.carcount)+"辆 "+e._s(t.vehiclecount)+"人 ")]),t.city?s("p",[s("span",[e._v("用车城市")]),e._v(" "+e._s(t.city))]):e._e(),s("p",{staticClass:"quotedprice"},[e._v(" 报价：￥"+e._s(t.price.toFixed(2))+"*"+e._s(t.carcount)+"辆 ￥"+e._s((t.price*t.carcount).toFixed(2))+" 备注："+e._s(t.offer_remarks)+" ")])])}))],2)})),s("br"),e._v(" 地面交通报价总备注："+e._s(e.info.car_remarks)+" "),s("br"),s("br"),s("div",{staticClass:"quotedpricesum"},[e._v(" 交通报价小计"),s("span",{staticClass:"quotedprice"},[e._v("￥"+e._s((this.IntercityTransportationAllMoney+this.CityAllMoney).toFixed(2)))])])],2)]),s("div",{staticClass:"item"},[s("div",{staticClass:"label"},[e._v("其他服务")]),s("div",{staticClass:"context"},[e._l(e.info.quoted_price_other,(function(t){return s("div",{key:t.id,staticClass:"hyxq_item",staticStyle:{margin:"0"}},[s("div",{staticClass:"c_item",staticStyle:{"line-height":"25px"}},[s("span",[e._v(e._s(t.servicetypename))]),e._v(" 数量"+e._s(t.demandparticipatecount)+" "),s("p",{staticClass:"quotedprice"},[e._v(" 报价：￥"+e._s(t.price.toFixed(2))+" * "+e._s(t.offerparticipatecount)+" ￥"+e._s((t.price*t.offerparticipatecount*t.offerservicedaycount).toFixed(2))+" 备注："+e._s(t.offerremarks)+" ")]),s("p",[e._v("需求备注："+e._s(t.describe))]),s("p",[e._v("报价备注："+e._s(t.offer_remarks))]),s("br")])])})),s("br"),e._v(" 其他需求报价总备注："+e._s(e.info.other_remarks)+" "),s("br"),s("br"),s("div",{staticClass:"quotedpricesum"},[e._v(" 其他需求报价小计"),s("span",{staticClass:"quotedprice"},[e._v("￥"+e._s(this.otherAllMoney.toFixed(2)))])])],2)])]),s("div",{staticClass:"line"},[s("div",{staticClass:"item"},[s("div",{staticClass:"label"},[e._v("服务费和增值税")]),s("div",{staticClass:"context"},[s("p",{staticClass:"bold"},[e._v("服务费")]),s("p",[e._v(" 非直采服务费 "),s("span",{staticClass:"quotedprice"},[e._v("￥"+e._s(this.serveAllMoney.toFixed(2)))])]),s("p",[e._v(" 直采服务费 "),s("span",{staticClass:"quotedprice"},[e._v("￥"+e._s(this.AdvancesMoney.toFixed(2)))])]),s("br"),s("p",{staticClass:"bold"},[e._v("税费")]),s("p",[s("span",{staticClass:"quotedprice"},[e._v("￥"+e._s(this.Taxes.toFixed(2)))])])])])]),s("div",{staticClass:"line"},[s("div",{staticClass:"item"},[s("div",{staticClass:"label"},[e._v("总报价")]),s("div",{staticClass:"context"},[s("span",{staticClass:"quotedprice"},[e._v("￥"+e._s(e.totalPrices.toFixed(2)))])])])])]),s("el-dialog",{attrs:{title:"添加项目",visible:e.addProjectStatus,"before-close":function(e){t.itemData=null,e()},width:"700px"},on:{"update:visible":function(t){e.addProjectStatus=t}}},[e.addProjectStatus?s("projectAdded",{attrs:{"item-data":e.itemData},on:{onColse:e.projectSave}}):e._e()],1),s("el-dialog",{attrs:{title:"编辑 Cevent 上传完成日期",visible:e.CeventDateDialog,width:"700px"},on:{"update:visible":function(t){e.CeventDateDialog=t}}},[s("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期时间"},model:{value:e.fileList.cventDate,callback:function(t){e.$set(e.fileList,"cventDate",t)},expression:"fileList.cventDate"}}),s("div",{staticStyle:{"margin-top":"50px","text-align":"center"}},[s("el-button",{on:{click:function(t){e.CeventDateDialog=!1}}},[e._v("取消")]),s("el-button",{attrs:{type:"primary"},on:{click:e.saveCeventDate}},[e._v("保存")])],1)],1),s("el-dialog",{attrs:{title:"审批意见",visible:e.objectionVisible,"close-on-click-modal":!1,width:"70%",center:""},on:{"update:visible":function(t){e.objectionVisible=t},open:e.GetSettlementObjection}},[s("div",[s("p",[e._v(e._s(e.objectionDetail.date))]),s("p",[e._v(" "+e._s(e.objectionDetail.username)+" （"+e._s(e.objectionDetail.company_name)+"） ")]),s("p",{style:"color:"+("审核不通过"==e.objectionDetail.state?"red":"")},[e._v(" "+e._s(e.objectionDetail.state)+" ")]),s("p",{staticStyle:{"margin-top":"20px"}},[e._v("其他异议：")]),s("div",{staticClass:"objectionDetailStyle",domProps:{innerHTML:e._s(this.info.orderform_settlement_customer_objection)},on:{click:function(t){return e.getImg(t)}}})]),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.objectionVisible=!1}}},[e._v("关 闭")])],1)])],1):e._e()])},o=[],n=(i("d3b7"),i("159b"),i("a9e3"),i("4de4"),i("b680"),i("ac1f"),i("5319"),i("caad"),i("b0c0"),i("97aa")),a=i("cf45"),r=(i("df68"),i("f121")),c=i("acd6"),l={name:"OrderInfo",components:{projectAdded:n["a"]},data:function(){return{downloadUrl:"",fileList:{kpFile:[],fpFile:[],cventDate:""},objectionDetail:{username:"",company_name:"",date:"",message:"",state:""},objectionVisible:!1,select:[],UploadFilesUrl:r["b"]+"/MeetingMa/UploadFiles",uploadList:{},whetherShow:{cvent_date:0,invoice_file:0,kp_notice_file:0},info:null,addProjectStatus:!1,CeventDateDialog:!1,itemData:null,settlement_sheet_status_draft:"0029-1",excelAddress:"",totalPrices:""}},computed:{dayMoney:function(){return function(t){var e=this,i=0;return t.forEach((function(t){i+=Number(t.provide_count)*e.positiveFloatSix(t.unitprice)})),this.positiveFloatSix(i)}},allMoney:function(){var t=this,e=0;return this.info.quoted_price_room&&this.info.quoted_price_room.length>0&&this.info.quoted_price_room.forEach((function(i){e+=t.positiveFloatSix(t.dayMoney(i.room_list))})),this.positiveFloatSix(e)},meetingDayMoney:function(){return function(t,e){var i=this,s=0;return t.forEach((function(t){s+=i.positiveFloatSix(t.price)})),this.positiveFloatSix(s)}},meetingMoney:function(){var t=this,e=0;return this.info.quoted_price_conference&&this.info.quoted_price_conference.length>0&&this.info.quoted_price_conference.forEach((function(i){var s=i.conference_list.filter((function(t){return 3!=t.type}));e+=t.meetingDayMoney(s)})),this.positiveFloatSix(e)},EquipmentMoney:function(){var t=this,e=0;return this.info.quoted_price_conference&&this.info.quoted_price_conference.length>0&&this.info.quoted_price_conference.forEach((function(i){var s=i.conference_list.filter((function(t){return 3==t.type}));e+=t.meetingDayMoney(s)})),this.positiveFloatSix(e)},meetingAllMoney:function(){var t=this,e=0;return this.info.quoted_price_conference&&this.info.quoted_price_conference.length>0&&this.info.quoted_price_conference.forEach((function(i){e+=t.meetingDayMoney(i.conference_list)})),this.positiveFloatSix(e)},repastDayMoney:function(){return function(t){var e=this,i=0;return t.forEach((function(t){i+=e.positiveInteger(t.personcount)*e.positiveFloatSix(t.price)})),this.positiveFloatSix(i)}},repastAllMoney:function(){var t=this,e=0;return this.info.quoted_price_food&&this.info.quoted_price_food.length>0&&this.info.quoted_price_food.forEach((function(i){e+=t.repastDayMoney(i.food_list)})),this.positiveFloatSix(e)},otherFoodDayMoney:function(){return function(t){var e=this,i=0;return t.forEach((function(t){i+=e.positiveInteger(t.personcount)*e.positiveFloatSix(t.price)})),this.positiveFloatSix(i)}},otherFoodAllMoney:function(){var t=this,e=0;return this.info.quoted_price_outside_food&&this.info.quoted_price_outside_food.length>0&&this.info.quoted_price_outside_food.forEach((function(i){e+=t.otherFoodDayMoney(i.food_list)})),this.positiveFloatSix(e)},IntercityTransportationDayMoney:function(){return function(t){var e=this,i=0;return t.forEach((function(t){i+=e.positiveInteger(t.passengercount)*e.positiveFloatSix(t.unitprice)})),this.positiveFloatSix(i)}},IntercityTransportationAllMoney:function(){var t=this,e=0;return this.info.quoted_price_transportation&&this.info.quoted_price_transportation.length>0&&this.info.quoted_price_transportation.forEach((function(i){e+=t.IntercityTransportationDayMoney(i.transportation_list)})),this.positiveFloatSix(e)},CityDayMoney:function(){return function(t){var e=this,i=0;return t.forEach((function(t){i+=e.positiveInteger(t.carcount)*e.positiveFloatSix(t.price)})),this.positiveFloatSix(i)}},CityAllMoney:function(){var t=this,e=0;return this.info.quoted_price_car&&this.info.quoted_price_car.length>0&&this.info.quoted_price_car.forEach((function(i){e+=t.CityDayMoney(i.car_list)})),this.positiveFloatSix(e)},otherAllMoney:function(){var t=this,e=0;return this.info.quoted_price_other&&this.info.quoted_price_other.length>0&&this.info.quoted_price_other.forEach((function(i){e+=t.positiveInteger(i.offerparticipatecount)*t.positiveInteger(i.offerservicedaycount)*t.positiveFloatSix(i.price)})),this.positiveFloatSix(e)},money:function(){return this.info.total_price=Object(a["o"])(this.allMoney)+Object(a["o"])(this.meetingAllMoney)+Object(a["o"])(this.repastAllMoney)+Object(a["o"])(this.otherFoodAllMoney)+Object(a["o"])(this.IntercityTransportationAllMoney)+Object(a["o"])(this.CityAllMoney)+Object(a["o"])(this.otherAllMoney),Object(a["o"])(this.info.total_price)},TravelAgencyMoney:function(){return this.positiveFloatSix(this.info.travelagency_payment_money*this.info.travelagency_payment_proportion/100)},AdvancesMoney:function(){return Object(a["o"])(this.positiveFloatSix(this.info.advance_amount)*(this.positiveFloatSix(this.info.advance_proportion)/100))},OutsideHotelMoney:function(){return this.positiveFloatSix(this.info.off_hotel_expenses*this.info.off_hotel_proportion/100)},serviceAllMoney:function(){return Object(a["o"])(this.TravelAgencyMoney+this.AdvancesMoney+this.OutsideHotelMoney)},serveAllMoney:function(){var t=this,e=0;if(0==this.info.event_info_configure.service_fee_calculation_method)e=this.allMoney.toFixed(2)*(this.info.event_info_configure.room_inquiry_service_taxrate/100)+this.meetingAllMoney.toFixed(2)*(this.info.event_info_configure.conference_inquiry_service_taxrate/100)+this.repastAllMoney.toFixed(2)*(this.info.event_info_configure.hotel_food_inquiry_service_taxrate/100)+this.otherFoodAllMoney.toFixed(2)*(this.info.event_info_configure.others_food_inquiry_service_taxrate/100)+this.IntercityTransportationAllMoney.toFixed(2)*(this.info.event_info_configure.transportation_inquiry_service_taxrate/100)+this.CityAllMoney.toFixed(2)*(this.info.event_info_configure.car_inquiry_service_taxrate/100),this.offline_quoted_price_others.forEach((function(t){e+=t.offerparticipatecount*t.price*t.service_taxrate/100}));else if(1==this.info.event_info_configure.service_fee_calculation_method){var i=0;i+=this.info.event_info_configure.room_inquiry_isnotservice?this.allMoney:0,i+=this.info.event_info_configure.conference_inquiry_isnotservice?this.meetingAllMoney:0,i+=this.info.event_info_configure.hotel_food_inquiry_isnotservice?this.repastAllMoney:0,i+=this.info.event_info_configure.others_food_inquiry_isnotservice?this.otherFoodAllMoney:0,i+=this.info.event_info_configure.transportation_inquiry_isnotservice?this.IntercityTransportationAllMoney:0,i+=this.info.event_info_configure.car_inquiry_isnotservice?this.CityAllMoney:0,this.info.quoted_price_other.forEach((function(t){i+=t.isnotservice?t.offerparticipatecount*t.price:0})),this.severEveryMoneyList=[],this.info.event_info_ladder_taxrates.forEach((function(s,o){i<=s.ladder_min||(i>=s.ladder_min&&i<=s.ladder_max?(e+=(i-s.ladder_min+(0==o?0:1))*s.ladder_taxrate/100,t.severEveryMoneyList.push(Object(a["o"])((i-s.ladder_min+(0==o?0:1))*s.ladder_taxrate/100*t.info.fzc_service/100))):i>s.ladder_max&&t.info.event_info_ladder_taxrates[o+1]?(t.severEveryMoneyList.push(Object(a["o"])((s.ladder_max-s.ladder_min+(0==o?0:1))*s.ladder_taxrate/100*t.info.fzc_service/100)),e+=(s.ladder_max-s.ladder_min+(0==o?0:1))*s.ladder_taxrate/100):i>=s.ladder_max&&!t.info.event_info_ladder_taxrates[o+1]&&(t.severEveryMoneyList.push(Object(a["o"])((i-s.ladder_min+(0==o?0:1))*s.ladder_taxrate/100*t.info.fzc_service/100)),e+=(i-s.ladder_min+(0==o?0:1))*s.ladder_taxrate/100))}))}else if(2==this.info.event_info_configure.service_fee_calculation_method){var s=0;s+=this.info.event_info_configure.room_inquiry_isnotservice?this.allMoney:0,s+=this.info.event_info_configure.conference_inquiry_isnotservice?this.meetingAllMoney:0,s+=this.info.event_info_configure.hotel_food_inquiry_isnotservice?this.repastAllMoney:0,s+=this.info.event_info_configure.others_food_inquiry_isnotservice?this.otherFoodAllMoney:0,s+=this.info.event_info_configure.transportation_inquiry_isnotservice?this.IntercityTransportationAllMoney:0,s+=this.info.event_info_configure.car_inquiry_isnotservice?this.CityAllMoney:0,this.info.quoted_price_other.forEach((function(t){s+=t.isnotservice?t.offerparticipatecount*t.price:0})),this.serviceTotalMoney=s;for(var o=0;o<this.info.event_info_grade_taxrates.length;o++)if(o==this.info.event_info_grade_taxrates.length-1||s>=this.info.event_info_grade_taxrates[o].grade_money&&s<this.info.event_info_grade_taxrates[o+1].grade_money){e=s*this.info.event_info_grade_taxrates[o].grade_taxrate/100,this.grade_taxrate=this.info.event_info_grade_taxrates[o].grade_taxrate;break}}return e*=this.info.fzc_service/100,1==this.info.event_info_configure.minimum_service_fee&&e<this.info.event_info_configure.minimum_service_fee_money&&(e=this.info.event_info_configure.minimum_service_fee_money),this.info.feizhicai_service=e,e},Taxes:function(){var t=0;return"VAT"==this.info.taxtype?(t=this.info.event_info_configure.fzc_service_fee_money?(this.money+this.serveAllMoney)*this.positiveFloatSix(this.info.taxrate)/100:(this.money+this.serveAllMoney-this.info.feizhicai_service)*this.positiveFloatSix(this.info.taxrate)/100,t):0*(this.money+this.serveAllMoney)},OrderPrice:function(){return this.money+this.serveAllMoney+this.AdvancesMoney+this.Taxes}},methods:{positiveInteger:a["q"],positiveFloat:a["m"],positiveFloatSix:a["o"],excelExport:c["a"],formatDate:a["d"],WhetherShow:function(){var t=this;this.$api.WhetherShow({OrderID:this.$route.params.id},"post").then((function(e){t.whetherShow=e}))},GetSettlementObjection:function(){var t=this;this.$api.GetSettlementObjection({OrderFromID:this.$route.params.id},"POST").then((function(e){t.objectionDetail=e}))},getImg:function(t){console.log(t),console.log(t.target.currentSrc);var e=t.target.currentSrc;e&&this.$hevueImgPreview(e)},handlePreview:function(t){var e=this;if(t.value){var i=t.value.substring(t.value.lastIndexOf(".")+1),s=["pdf","jpeg","jpg","png","txt"],o=["docx","doc","xls","xlsx","xlsm","ppt","pptx"];t.value=t.value.replace(/http:/,"https:"),this.downloadUrl=t.value,o.includes(i)?this.downloadUrl="https://view.officeapps.live.com/op/view.aspx?src="+encodeURIComponent(t.value):s.includes(i)?this.downloadUrl=t.value:this.$message.info("文件格式不支持预览，下载后查看"),setTimeout((function(){e.$refs.d_click.click()}),100)}},ApproveRecordDownloadFile:function(t){var e=document.createElement("a");e.href=t.value,e.download=t.name,e.target="_blank",document.body.appendChild(e),e.click()},getSelect:function(){var t=this;this.$api.getrecord({OrderID:this.$route.params.id},"POST").then((function(e){t.select=e,t.select.forEach((function(e){t.$set(e,"showDetail",!1)}))}))},GetFile:function(){var t=this;this.$api.GetFile({OrderID:this.$route.params.id,SheetID:""},"POST").then((function(e){t.fileList=e}))},saveCeventDate:function(){var t=this;this.$api.CventDateAdd({OrderID:this.$route.params.id,Datetime:this.fileList.cventDate},"POST").then((function(e){e&&(t.CeventDateDialog=!1)}))},excelexport:function(){var t="DMC报价单"+this.info.event_info_id;this.excelExport("/Template/GetTemplate",{eventid:this.info.event_info_id,type:3,param:this.info.quoted_price_id},t)},uploadFile:function(t){var e=this;this.uploadList=t;var i={orderid:this.$route.params.id,sheet_id:"",type:1,file_name:t.title,file_path:t.weburl};this.$api.FileAdd(i,"post").then((function(t){t&&(e.$message.success("上传成功"),e.GetFile())}))},downloadFile:function(t){var e,i,s=this,o=null!==(e=t.file_path)&&void 0!==e?e:t.filepath;null!==(i=t.file_name)&&void 0!==i||t.filename;if(o){var n=o.substring(o.lastIndexOf(".")+1),a=["pdf","jpeg","jpg","png","txt"],r=["docx","doc","xls","xlsx","xlsm","ppt","pptx"];o=o.replace(/http:/,"https:"),this.downloadUrl=o,r.includes(n)?this.downloadUrl="https://view.officeapps.live.com/op/view.aspx?src="+encodeURIComponent(o):a.includes(n)?this.downloadUrl=o:this.$message.info("文件格式不支持预览，下载后查看"),setTimeout((function(){s.$refs.d_click.click()}),100)}},project:function(){this.info.project_id?this.$router.push({name:"ItineraryManagement",params:{id:this.info.project_id}}):this.addProjectStatus=!0},projectSave:function(t){var e=this;this.$api.projectsave(t,"POST").then((function(i){e.$message({message:t.id?"修改成功！":"添加成功！",type:"success"}),e.$router.push({name:"ItineraryManagement",params:{id:e.info.project_id}})}))},quotedprice:function(){var t=this.$router.resolve({name:"DMCquotedprice",params:{id:this.info.quoted_price_id,isSubmit:0}});window.open(t.href,"_blank")},settlement:function(){var t=this.$route.params.id,e=1;this.info.settlement_sheet_status,this.settlement_sheet_status_draft,"0020-5"!==this.info.status&&"0020-6"!==this.info.status&&"0020-8"!==this.info.status||(e=0),0==this.info.serviceprovider_or_hotel?this.$router.push({name:"settleAccounts_Hotel",params:{id:t,issubmit:e}}):this.$router.push({name:"settleAccounts",params:{id:t,issubmit:e}})},cancelorderform:function(){var t=this;this.$prompt("请简要说明取消订单的原因","拒绝接单",{confirmButtonText:"确定",cancelButtonText:"取消",inputType:"textarea"}).then((function(e){var i=e.value;t.$api.cancelorderform({id:t.info.orderform_id,object_id:t.info.object_id,reason:i},"POST").then((function(e){e?(t.$message({message:"订单已取消",type:"success"}),t.$router.go(0)):t.$message({message:"订单取消失败",type:"fail"})}))})).catch((function(){}))},againform:function(){var t=this;this.$api.againform({id:this.info.orderform_id,object_id:this.info.object_id},"POST").then((function(e){e?t.$message({message:"提醒成功",type:"success"}):t.$message({message:"提醒失败",type:"fail"})}))}},mounted:function(){var t=this;this.WhetherShow(),this.getSelect(),this.$api.orderInfo({id:this.$route.params.id},"POST").then((function(e){t.info=e,t.totalPrices=e.total_price,0!=t.info.event_info_configure.service_fee_ratio&&null!=t.info.fzc_service||(t.info.fzc_service=100),"0020-6"===t.info.status&&t.GetFile()}))}},_=l,d=(i("c460"),i("2877")),f=Object(d["a"])(_,s,o,!1,null,"5dc5f15e",null);e["default"]=f.exports},bf24:function(t,e,i){},c460:function(t,e,i){"use strict";i("bf24")}}]);