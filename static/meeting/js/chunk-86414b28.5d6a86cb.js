(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-86414b28"],{2654:function(e,t,a){"use strict";a.d(t,"j",(function(){return i})),a.d(t,"k",(function(){return s})),a.d(t,"i",(function(){return r})),a.d(t,"h",(function(){return o})),a.d(t,"l",(function(){return l})),a.d(t,"e",(function(){return c})),a.d(t,"f",(function(){return u})),a.d(t,"b",(function(){return d})),a.d(t,"g",(function(){return m})),a.d(t,"a",(function(){return p})),a.d(t,"c",(function(){return b})),a.d(t,"d",(function(){return f}));a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0");function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}a("ac1f"),a("00b4"),a("d9e2"),a("a9e3"),a("159b");function i(e,t,a){var n=/^((0\d{2,3}-\d{7,8})|(1[34578]\d{9}))$/;""==t||void 0==t||null==t||n.test(t)||""==t?a():a(new Error("请输入正确的电话号码或者固话号码"))}function s(e,t,a){var n=/0\d{2}-\d{7,8}/;""==t||void 0==t||null==t||n.test(t)||""==t?a():a(new Error("请输入正确的固话（格式：区号+号码,如010-1234567）"))}function r(e,t,a){var n=/^[1][3,4,5,7,8][0-9]{9}$/;""==t||void 0==t||null==t||n.test(t)||""==t?a():a(new Error("请输入正确的电话号码"))}function o(e,t,a){var n=/^([a-zA-Z0-9]+[-_\.]?)+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/;""==t||void 0==t||null==t||n.test(t)?a():a(new Error("请输入正确的邮箱地址"))}function l(e,t,a){var n=/^(https?|ftp):\/\/([a-zA-Z0-9.-]+(:[a-zA-Z0-9.&%$-]+)*@)*((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])){3}|([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+\.(com|edu|gov|int|mil|net|org|biz|arpa|info|name|pro|aero|coop|museum|[a-zA-Z]{2}))(:[0-9]+)*(\/($|[a-zA-Z0-9.,?'\\+&%$#=~_-]+))*$/;""==t||void 0==t||null==t||n.test(t)?a():a(new Error("请输入正确的URL"))}function c(e,t,a){if(!t)return a(new Error("输入不可以为空"));setTimeout((function(){if(Number(t)){var e=/^[0-9]*[1-9][0-9]*$/,n=e.test(t);n?a():a(new Error("请输入正整数"))}else a(new Error("请输入正整数"))}),0)}function u(e,t,a){t||a(),setTimeout((function(){if(Number(t)){var e=/^[0-9]*[1-9][0-9]*$/,n=e.test(t);n?a():a(new Error("请输入正整数"))}else a(new Error("请输入正整数"))}),1e3)}function d(e,t){var a={},i=[];if(e=Array.isArray(e)?e:[],t)for(var s=0;s<e.length;s++)if(a[e[s].date]){for(var r=0;r<i.length;r++)if(e[s].date===i[r].date){i[r].settlement+=Number("object"==n(e[s].settlement_total_price)?e[s].settlement_total_price.value:e[s].settlement_total_price),i[r].orgSettlement+=Number("object"==n(e[s].total_price)?e[s].total_price.value:e[s].total_price),i[r].data.push(e[s]);break}}else i.push({date:e[s].date,settlement:Number("object"==n(e[s].settlement_total_price)?e[s].settlement_total_price.value:e[s].settlement_total_price),orgSettlement:Number("object"==n(e[s].total_price)?e[s].total_price.value:e[s].total_price),data:[e[s]]}),a[e[s].date]=e[s];else for(var o=0;o<e.length;o++)if(a[e[o].date]){for(var l=0;l<i.length;l++)if(e[o].date===i[l].date){i[l].settlement+="object"==n(e[o].settlement_price)?e[o].settlement_price.value:e[o].settlement_price,i[l].orgSettlement+="object"==n(e[o].price)?e[o].price.value:e[o].price,i[l].data.push(e[o]);break}}else i.push({date:e[o].date,settlement:"object"==n(e[o].settlement_price)?e[o].settlement_price.value:e[o].settlement_price,orgSettlement:"object"==n(e[o].price)?e[o].price.value:e[o].price,data:[e[o]]}),a[e[o].date]=e[o];return i}function m(e){var t={},a=[];e=Array.isArray(e)?e:[];for(var n=0;n<e.length;n++)if(t[e[n].checkindate]){for(var i=0;i<a.length;i++)if(e[n].checkindate===a[i].checkindate){"大床房"==e[n].roomtype?(a[i].bigBedNum=e[n].roomcount,a[i].totalNum+=e[n].roomcount):"双床房"==e[n].roomtype?(a[i].doubleBedNum=e[n].roomcount,a[i].totalNum+=e[n].roomcount):(a[i].suiteNum=e[n].roomcount,a[i].totalNum+=e[n].roomcount);break}}else e[n].bigBedNum=0,e[n].doubleBedNum=0,e[n].suiteNum=0,e[n].totalNum=0,"大床房"==e[n].roomtype?(e[n].bigBedNum=e[n].roomcount,e[n].totalNum+=e[n].roomcount):"双床房"==e[n].roomtype?(e[n].doubleBedNum=e[n].roomcount,e[n].totalNum+=e[n].roomcount):(e[n].suiteNum=e[n].roomcount,e[n].totalNum+=e[n].roomcount),a.push(e[n]),t[e[n].checkindate]=e[n];return a}function p(e){for(var t={},a=[],n=0;n<e.length;n++){var i=(e[n].build?e[n].build.price:0)+(e[n].rentalCosts?e[n].rentalCosts.price:0);if(e[n].equipment&&e[n].equipment.forEach((function(e){i+=e.price||0})),t[e[n].rentalCosts.time])for(var s=function(t){if(e[n].rentalCosts.time===a[t].time)return a[t].totalPrice+=(e[n].build?e[n].build.price:0)+(e[n].rentalCosts?e[n].rentalCosts.price:0),e[n].equipment&&e[n].equipment.forEach((function(e){a[t].totalPrice+=e.price||0})),a[t].data.push(e[n]),"break"},r=0;r<a.length;r++){var o=s(r);if("break"===o)break}else a.push({time:e[n].rentalCosts.time,totalPrice:i,data:[e[n]]}),t[e[n].rentalCosts.time]=e[n]}return a}function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"time",a={},n=[];e=e||[];for(var i=0;i<e.length;i++)if(a[e[i][t]]){for(var s=0;s<n.length;s++)if(e[i][t]===n[s].time){n[s].data.push(e[i]),n[s].car.push(e[i]);break}}else n.push({time:e[i][t],car_date:e[i][t].substring(0,10),breakfast:e[i].breakfast,networks:e[i].networks,describe:e[i].describe,otherrequirements:e[i].otherrequirements,type:e[i].type,room_budget:e[i].room_budget,purpose:e[i].purpose,offer_remarks:e[i].offer_remarks,comments:e[i].comments,data:[e[i]],car:[e[i]]}),a[e[i][t]]=e[i];return n}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"time",a={},n=[];e=e||[];for(var i=0;i<e.length;i++)n.push({time:e[i][t],car_date:e[i][t].substring(0,10),breakfast:e[i].breakfast,networks:e[i].networks,describe:e[i].describe,otherrequirements:e[i].otherrequirements,type:e[i].type,room_budget:e[i].room_budget,purpose:e[i].purpose,offer_remarks:e[i].offer_remarks,comments:e[i].comments,data:[e[i]],car:[e[i]]}),a[e[i][t]]=e[i];return n}},"393b":function(e,t,a){"use strict";a("ac1f"),a("5319"),a("4d63"),a("c607"),a("2c3e"),a("25f0"),a("00b4");var n=function(e,t,a){e.addEventListener(t,a,!1)},i=function(e){n(e,"keyup",(function(){e.value=e.value.replace(/\s+/,"")}))},s=function(e){n(e,"keyup",(function(){e.value=e.value.replace(/\D/g,""),console.log(e.value)}))},r=function(e){n(e,"keyup",(function(){e.value=e.value.replace(/[^\d.]*/g,""),isNaN(e.value)&&(e.value="")}))},o=function(e){n(e,"keyup",(function(){e.value=e.value.replace(/[^\a-\z\A-\Z0-9\u4E00-\u9FA5]/g,"")}))},l=function(e){n(e,"blur",(function(){if(e.value){var t=new RegExp("^(13|14|15|16|17|18|19)[0-9]{9}$");t.test(e.value)||(e.value="")}}))},c=function(e){n(e,"blur",(function(){if(e.value){var t=/(^#)|(^http(s*):\/\/[^\s]+\.[^\s]+)/;t.test(e.value)||(e.value="")}}))},u={bind:function(e,t){switch("input"!==e.tagName.toLowerCase()&&(e=e.getElementsByTagName("input")[0]),i(e),t.arg){case"int":s(e);break;case"price":r(e);break;case"special":o(e);break;case"phone":l(e);break;case"url":c(e);break;default:break}}},d=function(e){e.directive("inputFilter",u)};window.Vue&&(window.inputFilter=u,Vue.use(d)),u.install=d;t["a"]=u},"7db0":function(e,t,a){"use strict";var n=a("23e7"),i=a("b727").find,s=a("44d2"),r="find",o=!0;r in[]&&Array(1)[r]((function(){o=!1})),n({target:"Array",proto:!0,forced:o},{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),s(r)},"9e72":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"create_event box"},[a("div",{staticClass:"path"},[a("ul",[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.$router.replace({path:"/DMCeventlist"})}}},[e._v("我的会议")]),e.$route.query.type?a("li",{staticStyle:{color:"#7c7f82"}},[e._v(">")]):e._e(),e.$route.query.type?a("li",{staticStyle:{color:"#409EFF",cursor:"pointer"},on:{click:function(t){return e.$router.go(-1)}}},[e._v("会议详情 ("+e._s(e.$route.query.name)+")")]):e._e(),a("li",{staticStyle:{color:"#7c7f82"}},[e._v(">")]),a("li",{staticStyle:{color:"#7c7f82"}},[e._v(e._s(e.eventId?"编辑会议":"创建会议"))])],1)]),a("el-container",{staticStyle:{height:"100%"}},[a("el-header",{staticClass:"header_title space-between"},[a("h2",[e._v("填写会议基本信息")]),a("h2",{staticStyle:{cursor:"pointer"},on:{click:function(t){e.hisDialog=!0}}},[e._v("复制历史会议")])]),a("el-main",[a("div",{staticClass:"base_meet"},[a("el-form",{ref:"baseMeet",attrs:{model:e.baseMeet,rules:e.rules,"label-width":"300px"}},[a("el-form-item",{attrs:{label:"会议名称 Event Name",prop:"event_name"}},[a("el-input",{staticClass:"demand_500",attrs:{clearable:""},model:{value:e.baseMeet.event_name,callback:function(t){e.$set(e.baseMeet,"event_name",t)},expression:"baseMeet.event_name"}})],1),a("el-form-item",{attrs:{label:"建团类型 Group Type",prop:"tourist_group_type"}},[a("el-select",{staticClass:"demand_500",attrs:{clearable:""},model:{value:e.baseMeet.tourist_group_type,callback:function(t){e.$set(e.baseMeet,"tourist_group_type",t)},expression:"baseMeet.tourist_group_type"}},[a("el-option",{attrs:{label:"普通团",value:"1"}}),a("el-option",{attrs:{label:"转团",value:"0"}})],1)],1),0==e.baseMeet.tourist_group_type?a("el-form-item",{attrs:{label:"原团电脑号",prop:"oldEventId"}},[a("el-input",{staticClass:"demand_500",attrs:{clearable:""},model:{value:e.baseMeet.oldEventId,callback:function(t){e.$set(e.baseMeet,"oldEventId",t)},expression:"baseMeet.oldEventId"}})],1):e._e(),a("el-form-item",{attrs:{label:"客户 Consumer",prop:"company_id"}},[a("el-select",{staticClass:"demand_500",attrs:{clearable:"",filterable:""},on:{change:function(t){return e.getCustomerConfig(2)}},model:{value:e.baseMeet.company_id,callback:function(t){e.$set(e.baseMeet,"company_id",t)},expression:"baseMeet.company_id"}},e._l(e.customerList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.shortname,value:e.id.toString()}})})),1)],1),a("el-form-item",{attrs:{label:"客户联系人 Event Owner",prop:"company_contacts"}},[a("el-select",{staticClass:"demand_500",attrs:{clearable:"",filterable:""},on:{change:e.getContact},model:{value:e.baseMeet.company_contacts,callback:function(t){e.$set(e.baseMeet,"company_contacts",t)},expression:"baseMeet.company_contacts"}},e._l(e.customerContactList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1),a("el-button",{staticClass:"mar_l10",attrs:{size:"small",type:"text"},on:{click:e.addContactDialogTap}},[e._v("添加客户联系人")])],1),a("el-form-item",{attrs:{label:"客户所属部门 Owner's Department",prop:"departmentName"}},[a("el-input",{staticClass:"demand_500",attrs:{disabled:""},model:{value:e.baseMeet.departmentName,callback:function(t){e.$set(e.baseMeet,"departmentName",t)},expression:"baseMeet.departmentName"}})],1),a("el-form-item",{attrs:{label:"客户联系电话 Owner's Phone NO."}},[a("el-input",{staticClass:"demand_500",attrs:{disabled:"",clearable:""},model:{value:e.baseMeet.phone,callback:function(t){e.$set(e.baseMeet,"phone",t)},expression:"baseMeet.phone"}})],1),a("el-form-item",{attrs:{label:"客户邮箱 Owner's E-mail"}},[a("el-input",{staticClass:"demand_500",attrs:{disabled:""},model:{value:e.baseMeet.email,callback:function(t){e.$set(e.baseMeet,"email",t)},expression:"baseMeet.email"}})],1),a("el-form-item",{attrs:{label:"MSA",prop:"MSA"}},[a("el-input",{staticClass:"demand_500",attrs:{clearable:""},model:{value:e.baseMeet.MSA,callback:function(t){e.$set(e.baseMeet,"MSA",t)},expression:"baseMeet.MSA"}})],1),a("el-form-item",{attrs:{label:"活动类型 Event Type",prop:"activity_type"}},[a("el-select",{staticClass:"demand_500",attrs:{clearable:""},on:{change:e.selectActive},model:{value:e.baseMeet.activity_type,callback:function(t){e.$set(e.baseMeet,"activity_type",t)},expression:"baseMeet.activity_type"}},e._l(e.activityList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"餐标限制 Food Limit",prop:"food_limit"}},[a("el-input",{staticClass:"demand_500",attrs:{disabled:"",clearable:""},model:{value:e.baseMeet.food_limit,callback:function(t){e.$set(e.baseMeet,"food_limit",t)},expression:"baseMeet.food_limit"}})],1),a("el-form-item",{attrs:{label:"Cvent号",prop:"cvent_no"}},[a("el-input",{staticClass:"demand_500",attrs:{clearable:""},model:{value:e.baseMeet.cvent_no,callback:function(t){e.$set(e.baseMeet,"cvent_no",t)},expression:"baseMeet.cvent_no"}})],1),a("el-form-item",{attrs:{label:"会议总预算 Total Budget"}},[a("el-input",{staticClass:"demand_500",attrs:{clearable:""},model:{value:e.baseMeet.total_budget,callback:function(t){e.$set(e.baseMeet,"total_budget",t)},expression:"baseMeet.total_budget"}})],1),a("el-form-item",{attrs:{label:"服务类型 Service Type",prop:"service_type"}},[a("el-select",{staticClass:"demand_500",attrs:{clearable:""},on:{change:e.serviceTypeChange},model:{value:e.baseMeet.service_type,callback:function(t){e.$set(e.baseMeet,"service_type",t)},expression:"baseMeet.service_type"}},e._l(e.serviceList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"会议城市 City",prop:"event_city"}},[a("el-select",{staticClass:"demand_500",attrs:{disabled:e.baseMeet.online_meeting,clearable:"",filterable:""},model:{value:e.baseMeet.event_city,callback:function(t){e.$set(e.baseMeet,"event_city",t)},expression:"baseMeet.event_city"}},e._l(e.cityList,(function(e){return a("el-option",{key:e.code,attrs:{label:e.value,value:e.code}})})),1),a("el-checkbox",{staticStyle:{"margin-left":"20px"},attrs:{"true-label":1,"false-label":0},model:{value:e.baseMeet.online_meeting,callback:function(t){e.$set(e.baseMeet,"online_meeting",t)},expression:"baseMeet.online_meeting"}},[e._v("线上会议")])],1),a("el-form-item",{attrs:{label:"会议地点 Place",prop:"meeting_place"}},[a("el-input",{staticClass:"demand_500",attrs:{clearable:""},model:{value:e.baseMeet.meeting_place,callback:function(t){e.$set(e.baseMeet,"meeting_place",t)},expression:"baseMeet.meeting_place"}}),a("el-checkbox",{staticStyle:{"margin-left":"20px"},attrs:{"true-label":1,"false-label":0},model:{value:e.baseMeet.is_hotel,callback:function(t){e.$set(e.baseMeet,"is_hotel",t)},expression:"baseMeet.is_hotel"}},[e._v("是否在酒店开会")])],1),a("el-form-item",{staticClass:"attendee_no",attrs:{label:"参会人数 Attendee NO.",prop:"attendee_no"}},[a("el-col",{staticClass:"flex_row",attrs:{span:5}},[a("el-form-item",{staticClass:"attendee_no",attrs:{prop:"inside_number"}},[e._v(" 内部人数： "),a("el-input",{attrs:{clearable:""},model:{value:e.baseMeet.inside_number,callback:function(t){e.$set(e.baseMeet,"inside_number",e._n(t))},expression:"baseMeet.inside_number"}})],1)],1),a("el-col",{staticClass:"flex_row",attrs:{span:5}},[a("el-form-item",{staticClass:"attendee_no",attrs:{prop:"external_number"}},[e._v(" 外部人数： "),a("el-input",{attrs:{clearable:""},model:{value:e.baseMeet.external_number,callback:function(t){e.$set(e.baseMeet,"external_number",e._n(t))},expression:"baseMeet.external_number"}})],1)],1),a("el-col",{staticClass:"flex_row",attrs:{span:5}},[e._v(" 总人数："+e._s(e.baseMeet.attendee_no)+" ")])],1),a("el-form-item",{attrs:{label:"会议开始日期 Start Date",prop:"event_startdate"}},[a("el-date-picker",{staticClass:"demand_500",attrs:{clearable:"",type:"date","picker-options":e.pickerStart,"value-format":"yyyy-MM-dd",placeholder:"选择日期"},on:{change:e.timeStart},model:{value:e.baseMeet.event_startdate,callback:function(t){e.$set(e.baseMeet,"event_startdate",t)},expression:"baseMeet.event_startdate"}})],1),a("el-form-item",{attrs:{label:"会议结束日期 End Date",prop:"event_enddate"}},[a("el-date-picker",{staticClass:"demand_500",attrs:{clearable:"",type:"date","picker-options":e.pickerEnd,"value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.baseMeet.event_enddate,callback:function(t){e.$set(e.baseMeet,"event_enddate",t)},expression:"baseMeet.event_enddate"}})],1),a("el-form-item",{attrs:{label:"发票类型 Invoice Type",prop:"invoice_type"}},[a("el-radio",{attrs:{disabled:"",label:0},model:{value:e.baseMeet.invoice_type,callback:function(t){e.$set(e.baseMeet,"invoice_type",t)},expression:"baseMeet.invoice_type"}},[e._v("普票")]),a("el-radio",{attrs:{disabled:"",label:1},model:{value:e.baseMeet.invoice_type,callback:function(t){e.$set(e.baseMeet,"invoice_type",t)},expression:"baseMeet.invoice_type"}},[e._v("专票")]),a("el-radio",{attrs:{disabled:"",label:2},model:{value:e.baseMeet.invoice_type,callback:function(t){e.$set(e.baseMeet,"invoice_type",t)},expression:"baseMeet.invoice_type"}},[e._v("免税")])],1),a("el-form-item",{attrs:{label:"是否办理免税 Duty Free",prop:"is_duty_free"}},[a("el-radio",{attrs:{label:0},model:{value:e.baseMeet.is_duty_free,callback:function(t){e.$set(e.baseMeet,"is_duty_free",t)},expression:"baseMeet.is_duty_free"}},[e._v("否")]),a("el-radio",{attrs:{label:1},model:{value:e.baseMeet.is_duty_free,callback:function(t){e.$set(e.baseMeet,"is_duty_free",t)},expression:"baseMeet.is_duty_free"}},[e._v("是")])],1),a("el-form-item",{attrs:{label:"是否是DMC创建会议",prop:"meeting_type",hidden:""}},[a("el-input",{attrs:{value:"1"}})],1),a("el-form-item",{attrs:{label:"附件 Document Attachments"}},[a("div",{staticClass:"demand_500 text_left"},[a("el-upload",{ref:"upload",attrs:{"before-upload":e.fileLimit,action:e.UploadFilesUrl,"on-success":e.uploadFile,"on-preview":e.downloadFile,"on-remove":e.deleteFile,"file-list":e.fileList,"show-file-list":!0,multiple:!0}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选择文件")])],1),a("br"),a("span",{staticClass:"ps"},[e._v("注意: 只允许上传以下文件类型：doc、docx、xls、xlsx、pdf、ppt、pptx、jpeg、jpg、png、zip、eml、rtf、msg、gif、bmp、tif、tiff、rar、iso、7z、tar、bz2、gzip、txt、mp4、xps、odf，最大30M")])],1)]),a("el-form-item",{attrs:{label:"指定供应商 supplier"}},[a("el-input",{directives:[{name:"input-filter",rawName:"v-input-filter:int",arg:"int"}],staticClass:"demand_500",attrs:{disabled:""},model:{value:e.baseMeet.service_provider_name,callback:function(t){e.$set(e.baseMeet,"service_provider_name",t)},expression:"baseMeet.service_provider_name"}})],1),a("div",{staticClass:"row_around",staticStyle:{"margin-right":"50px"}},[a("el-button",{staticClass:"submit_btn",attrs:{type:"primary"},on:{click:function(t){return e.subEvent(0)}}},[e._v(e._s(this.$route.query.eventSearchType&&4!=this.$route.query.eventSearchType?"保存":"创建会议"))]),e.eventId&&4!=this.$route.query.eventSearchType?e._e():a("el-button",{staticClass:"submit_btn",attrs:{type:"info"},on:{click:function(t){return e.subEvent(1)}}},[e._v("保存草稿")])],1)],1)],1)])],1),e.hisDialog?a("el-dialog",{attrs:{title:"复制历史会议",visible:e.hisDialog,width:"650px",center:""},on:{"update:visible":function(t){e.hisDialog=t},close:function(t){e.hisDialog=!1}}},[e.eventList.length?a("div",{staticClass:"event_list"},[e._l(e.eventList,(function(t,n){return a("div",{key:n,staticClass:"event_item"},[a("p",{staticClass:"text_left"},[e._v("会议名称："+e._s(t.event_name))]),a("p",{staticClass:"text_left"},[e._v("活动类型："+e._s(t.activity_name))]),t.event_startdate&&t.event_enddate?a("p",{staticClass:"text_left"},[e._v("会议时间："+e._s(t.event_startdate.substring(0,10))+"--"+e._s(t.event_enddate.substring(0,10)))]):e._e(),a("p",{staticClass:"text_left"},[e._v("参会人数："+e._s(t.attendee_no))]),a("div",{staticClass:"flex_row justify_center"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.copyEvent(t,1)}}},[e._v("复制此会议")])],1)])})),a("div",{staticClass:"flex_row justify_center",staticStyle:{width:"100%"}},[a("el-pagination",{attrs:{layout:"prev, pager, next",total:e.pageInfo.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],2):e._e()]):e._e(),a("el-dialog",{attrs:{visible:e.hisStartDialog,width:"650px",center:""},on:{"update:visible":function(t){e.hisStartDialog=t},close:function(t){e.hisStartDialog=!1}}},[a("div",{staticClass:"his_title"},[a("span",[e._v("复制会议")]),a("em",[e._v("（复制完成后可在会议详情页编辑会议基本信息和采购需求）")])]),a("div",{staticClass:"his_date"},[a("span",[e._v("会议开始时间：")]),a("el-date-picker",{staticClass:"demand_200",attrs:{size:"small",clearable:"",type:"date","picker-options":e.pickerStart,"value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.hisStartDate,callback:function(t){e.hisStartDate=t},expression:"hisStartDate"}})],1),a("span",{staticClass:"dialog-footer flex_row justify_center",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.preStep}},[e._v("上一步")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.copyEvent(0,2)}}},[e._v("完 成")])],1)]),a("el-dialog",{attrs:{title:e.eventId?"保存成功":"会议创建完成",visible:e.demandDialog,width:"650px",center:""},on:{"update:visible":function(t){e.demandDialog=t},close:function(t){e.demandDialog=!1}}},[a("span",{staticClass:"dialog-footer flex_row justify_center",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.goDemand}},[e._v("填写采购需求")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.goDetail}},[e._v("查看会议详情")])],1)]),a("el-dialog",{attrs:{title:"客户联系人",visible:e.addContactDialog,"close-on-click-modal":!1,width:"500px",center:""},on:{"update:visible":function(t){e.addContactDialog=t},close:function(t){e.addContactDialog=!1}}},[a("el-form",{ref:"contactInfo",attrs:{model:e.contactInfo,rules:e.contactRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"姓名",prop:"name"}},[a("el-input",{staticClass:"demand_300",attrs:{size:"small",clearable:""},model:{value:e.contactInfo.name,callback:function(t){e.$set(e.contactInfo,"name",t)},expression:"contactInfo.name"}})],1),a("el-form-item",{attrs:{label:"电话",prop:"phone"}},[a("el-input",{staticClass:"demand_300",attrs:{type:"number",maxlength:11,size:"small",clearable:""},model:{value:e.contactInfo.phone,callback:function(t){e.$set(e.contactInfo,"phone",t)},expression:"contactInfo.phone"}})],1),a("el-form-item",{attrs:{label:"邮箱",prop:"mailbox"}},[a("el-input",{staticClass:"demand_300",attrs:{type:"email",size:"small",clearable:""},model:{value:e.contactInfo.mailbox,callback:function(t){e.$set(e.contactInfo,"mailbox","string"===typeof t?t.trim():t)},expression:"contactInfo.mailbox"}})],1),a("el-form-item",{attrs:{label:"公司",prop:"company_id"}},[a("el-select",{staticClass:"demand_300",attrs:{size:"small",clearable:"",filterable:""},on:{change:function(t){return e.getCustomerConfig(1)}},model:{value:e.contactInfo.company_id,callback:function(t){e.$set(e.contactInfo,"company_id",t)},expression:"contactInfo.company_id"}},e._l(e.customerList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.shortname,value:e.id.toString()}})})),1)],1),a("el-form-item",{attrs:{label:"部门",prop:"customer_id"}},[a("el-select",{staticClass:"demand_300",attrs:{size:"small",clearable:"",filterable:""},model:{value:e.contactInfo.customer_id,callback:function(t){e.$set(e.contactInfo,"customer_id",e._n(t))},expression:"contactInfo.customer_id"}},e._l(e.departmentList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.shortname,value:e.id}})})),1)],1)],1),a("span",{staticClass:"dialog-footer flex_row justify_center",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.addContactDialog=!1}}},[e._v("取 消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.addContactTap("contactRules")}}},[e._v("确 认")])],1)],1)],1)},i=[],s=(a("a9e3"),a("b0c0"),a("e9c4"),a("d3b7"),a("159b"),a("25f0"),a("7db0"),a("fb6a"),a("3ca3"),a("ddb0"),a("2b3d"),a("9861"),a("4de4"),a("393b")),r=a("2654"),o=a("f121"),l=a("df68"),c={name:"createEvent",data:function(){var e=this;return{fileList:[],UploadFilesUrl:o["b"]+"/MeetingMa/UploadFiles",uploadList:{},eventId:"",limitDate:new Date,addContactDialog:!1,contactInfo:{id:"",name:"",phone:"",mailbox:"",customer_id:"",company_id:""},contactRules:{name:[{required:!0,message:"请输入联系人姓名",trigger:"blur"}],phone:[{required:!0,message:"请输入联系人电话",trigger:"blur"},{pattern:/^((0\d{2,3}-\d{7,8})|(1[3567849]\d{9}))$/,message:"请输入合法手机号/电话号",trigger:"blur"}],mailbox:[{required:!0,message:"请输入联系人邮箱",trigger:"blur"},{validator:r["h"],trigger:"blur"}],customer_id:[{required:!0,message:"请选择部门",trigger:"change"}],company_id:[{required:!0,message:"请选择公司",trigger:"change"}]},hisDialog:!1,hisStartDialog:!1,demandDialog:!1,hisStartDate:"",container_height:document.documentElement.clientHeight-20,eventList:[],cityList:[],customerList:[],customerContactList:[],mealList:[],activityList:[],departmentList:[],serviceList:[],cityLisy:[],rules:{attendee_no:[{required:!0,message:"请输入参会人数",trigger:"blur"}],external_number:[{required:!0,message:"请输入外部人数",trigger:"blur"}],inside_number:[{required:!0,message:"请输入内部人数",trigger:"blur"}],event_name:[{required:!0,message:"请输入会议名称",trigger:"blur"}],oldEventId:[{required:!0,message:"请输入原团电脑号",trigger:"blur"}],tourist_group_type:[{required:!0,message:"请选择建团类型",trigger:"change"}],company_id:[{required:!0,message:"请选择客户",trigger:"change"}],activity_type:[{required:!0,message:"请选择活动类型",trigger:"change"}],event_city:[{required:!0,message:"请选择会议城市",trigger:"change"}],company_contacts:[{required:!0,message:"请选择客户联系人",trigger:"change"}],departmentName:[{required:!0,message:"客户联系人必须有所属部门",trigger:"change"}],event_startdate:[{required:!0,message:"请选择日期",trigger:"change"}],event_enddate:[{required:!0,message:"请选择日期",trigger:"change"}],service_type:[{required:!0,message:"请选择服务类型",trigger:"change"}],invoice_type:[{required:!0,message:"请选择发票类型",trigger:"change"}]},baseMeet:{event_name:"",tourist_group_type:"1",oldEventId:"",company_id:"",activity_type:"",cvent_no:"",total_budget:"",service_type:"",food_limit:"",attendee_no:0,inside_number:"",external_number:"",event_startdate:"",event_enddate:"",company_contacts:"",email:"",phone:"",MSA:"",invoice_type:1,is_duty_free:"",department:"",departmentName:"",event_city:"",document_attachments_file_path:[],fileInfos:[],service_provider_id:"",service_provider_name:"",online_meeting:!1,meeting_place:"",is_hotel:!1,meeting_type:1},pageInfo:{totalCount:0},createDate:(new Date).getTime(),pageSize:6,page:1,hisId:"",hisItem:"",his_startDate:"",newEventId:"",newEventName:"",pickerStart:{disabledDate:function(e){}},pickerEnd:{disabledDate:function(t){return e.baseMeet.event_enddate?t.getTime()<=new Date(e.baseMeet.event_startdate).getTime()-864e5||t.getTime()<=new Date(e.baseMeet.createDate).getTime()-864e5:t.getTime()>=new Date(e.event_startdate).getTime()-864e5}}}},directives:{inputFilter:s["a"]},watch:{"baseMeet.company_id":{deep:!0,handler:function(e,t){}},"baseMeet.company_contacts":{deep:!0,handler:function(e,t){}},"baseMeet.online_meeting":{deep:!0,handler:function(e,t){e?(this.rules.event_city[0].required=!1,this.baseMeet.event_city=""):this.rules.event_city[0].required=!0}},"baseMeet.inside_number":{deep:!0,handler:function(e,t){Number(e)&&e>0?(this.rules.external_number[0].required=!1,this.baseMeet.attendee_no=Number(e)+Number(this.baseMeet.external_number)):(this.baseMeet.inside_number="",this.baseMeet.attendee_no=this.baseMeet.external_number)}},"baseMeet.external_number":{deep:!0,handler:function(e,t){Number(e)&&e>0?(this.rules.inside_number[0].required=!1,this.baseMeet.attendee_no=Number(e)+Number(this.baseMeet.inside_number)):(this.baseMeet.external_number="",this.baseMeet.attendee_no=this.baseMeet.inside_number)}}},created:function(){this.getCustomerList(),this.getCityList(),this.getHistoryEvent(),this.getServiceType(),this.ServiceProviderUser()},mounted:function(){var e=this;this.$nextTick((function(){var t=e.$route.query;t&&t.type&&"edit"===t.type?(e.eventId=e.$route.query.id,e.baseMeet.id=e.$route.query.id,e.baseMeet.event_num=e.$route.query.event_num,e.getEventDetail()):e.eventId=""}))},methods:{timeStart:function(){if(this.baseMeet.event_startdate>this.baseMeet.event_enddate)return this.baseMeet.event_enddate=this.baseMeet.event_startdate},ServiceProviderUser:function(){var e=this;this.$api.ServiceProviderUser({},"POST").then((function(t){e.baseMeet.service_provider_id=t.service_provider_id,e.baseMeet.service_provider_name=t.name}))},getServiceType:function(){var e=this;this.$api.getServiceType({},"post").then((function(t){e.serviceList=t,e.baseMeet.service_type||(e.baseMeet.service_type=e.serviceList[0].id,e.baseMeet.invoice_type=1)}))},serviceTypeChange:function(e){"456d1027-413b-11ec-9db6-fa163ed463f8"==e?this.baseMeet.invoice_type=1:"59266863-413b-11ec-9db6-fa163ed463f8"==e&&(this.baseMeet.invoice_type=0)},addContactDialogTap:function(){this.addContactDialog=!0,this.contactInfo={id:"",name:"",phone:"",mailbox:"",customer_id:"",company_id:""},this.contactInfo.company_id=this.baseMeet.company_id,this.getCustomerConfig(1)},addContactTap:function(e){var t=this;this.$refs.contactInfo.validate((function(e){e&&t.$api.addContact({Parameter:JSON.stringify(t.contactInfo)},"post").then((function(e){e&&(t.addContactDialog=!1,t.$message.success("添加成功"),t.getCustomerConfig(2,"addContactSuccess"),t.baseMeet.company_contacts=e)}))}))},getEventDetail:function(){var e=this;this.$api.getEventDetail({eventId:this.baseMeet.event_num,eventSearchType:this.$route.query.eventSearchType},"GET").then((function(t){t.EventModels&&(e.baseMeet=t.EventModels[0],e.fileList=[],e.baseMeet.fileInfos.forEach((function(t){e.fileList.push({id:t.id,name:t.file_name,url:t.file_path})})),e.baseMeet.tourist_group_type=e.baseMeet.tourist_group_type.toString()),e.ServiceProviderUser(),e.baseMeet.company_id&&e.$api.GetCustomerContactList({id:e.baseMeet.company_id,type:1},"post").then((function(t){if(t&&!0!==t){e.customerContactList=t;var a=e.customerContactList.find((function(t){return t.id==e.baseMeet.company_contacts}));e.baseMeet.email=a.mailbox,e.baseMeet.phone=a.phone,e.getContactInfo(a.id)}else e.customerContactList=[]})),console.log(e.baseMeet)}))},subEvent:function(e){var t=this;this.baseMeet.event_status=e,0===e?(localStorage.setItem("event_city_code",this.baseMeet.event_city),this.$refs["baseMeet"].validate((function(e){e?(t.baseMeet.event_enddate=t.baseMeet.event_enddate.slice(0,10)+" 23:59:59",t.eventId?(t.baseMeet.id=t.eventId,t.$api.updateEvent(t.baseMeet,"POST").then((function(e){e&&(t.demandDialog=!0,t.newEventId=t.$route.query.id||t.eventId,t.newEventName=t.$route.query.name||t.baseMeet.event_name)}))):t.$api.createEvent(t.baseMeet,"POST").then((function(e){e&&(t.demandDialog=!0,t.newEventId=e.eventId,t.newEventName=e.eventName)}))):t.$message.warning("请完善会议信息")}))):this.eventId?(this.baseMeet.id=this.eventId,this.$api.updateEvent(this.baseMeet,"POST").then((function(e){t.$message.success("已保存至草稿")}))):this.$api.createEvent(this.baseMeet,"POST").then((function(e){t.eventId=e.eventId,t.$message.success("已保存至草稿")}))},fileLimit:function(e){var t=e.size/1024/1024<30;return t?Object(l["a"])(e):(this.$message.error("上传附件大小不能超过 30MB!"),!1)},uploadFile:function(e){this.uploadList=e,this.baseMeet.fileInfos||(this.baseMeet.fileInfos=[]),this.baseMeet.fileInfos.push({id:"",file_name:e.title,file_path:e.weburl})},deleteFile:function(e,t){var a=this;this.baseMeet.fileInfos=[],t.forEach((function(e){e.id?a.baseMeet.fileInfos.push({id:e.id,file_name:e.name,file_path:e.url}):a.baseMeet.fileInfos.push({id:"",file_name:e.name,file_path:e.response.weburl})}))},downloadFile:function(e){var t=document.createElement("a");fetch(e.url).then((function(e){return e.blob()})).then((function(a){t.href=URL.createObjectURL(a),console.log(t.href),t.download=e.name,document.body.appendChild(t),t.click()}))},goDemand:function(){this.$router.push({path:"/DMCEventDemand",query:{id:this.newEventId,name:this.newEventName}})},goDetail:function(){this.$router.push({path:"/DMCEventDetail",query:{id:this.newEventId,name:this.newEventName,eventSearchType:0}})},getCustomerList:function(){var e=this;this.$api.GetCustomerEventInfoPost({},"POST").then((function(t){e.customerList=t}))},getCustomerConfig:function(e,t){var a=this;2===e?(this.baseMeet.company_contacts="",this.baseMeet.department="",this.baseMeet.departmentName="",this.baseMeet.email="",this.baseMeet.phone="",this.baseMeet.activity_type="",this.baseMeet.food_limit="",this.$api.GetCustomerContactList({id:this.baseMeet.company_id,type:1},"post").then((function(e){e&&!0!==e?(a.customerContactList=e,t&&a.getContact()):a.customerContactList=[]}))):1===e&&(this.contactInfo.customer_id="",this.$api.getDepartment({CompanyID:this.contactInfo.company_id},"post").then((function(e){e&&!0!==e?a.departmentList=e:(a.$message.warning("请配置该公司部门"),a.contactInfo.customer_id="")})))},getContactInfo:function(e){var t=this;this.$api.getContactInfo({ContactID:e},"POST").then((function(a){a&&(t.baseMeet.department=a.departmentyid,t.$set(t.baseMeet,"departmentName",a.shortname),e?t.getMeetingType(a.departmentyid):t.activityList=[])}))},getMeetingType:function(e){var t=this,a={};a=e?{DepartmentyID:e}:{CompanyID:this.baseMeet.company_id},this.$api.getMeetingTypeShow(a,"POST").then((function(e){t.activityList=e}))},selectActive:function(){var e=this,t=this.activityList.find((function(t){return e.baseMeet.activity_type==t.id}));this.baseMeet.food_limit=t?t.meal_label:""},getContact:function(){var e=this,t=this.customerContactList.filter((function(t){return t.id==e.baseMeet.company_contacts}));this.baseMeet.activity_type="",this.baseMeet.food_limit="",t[0]?(this.baseMeet.email=t[0].mailbox,this.baseMeet.phone=t[0].phone,this.getContactInfo(t[0].id)):(this.baseMeet.email="",this.baseMeet.phone="",this.getContactInfo(""))},getCityList:function(){var e=this;this.$api.getCityList({},"GET").then((function(t){e.cityList=t}))},getHistoryEvent:function(){var e=this;this.$api.getEventList({page:this.page,pageSize:this.pageSize},"GET").then((function(t){e.eventList=t.EventModels,e.pageInfo=t.pageInfo}))},preStep:function(){this.hisDialog=!0,this.hisStartDialog=!1},copyEvent:function(e,t){var a=this;if(1===t)localStorage.setItem("event_city_code",e.event_city),this.hisItem=e,this.hisDialog=!1,this.hisStartDialog=!0;else{if(!this.hisStartDate)return void this.$message.warning("请选择时间！");this.$api.copyEvent({id:this.hisItem.id,eventStartDate:this.hisStartDate},"POST").then((function(e){a.hisStartDialog=!1,a.demandDialog=!0,a.newEventId=e.newEventId}))}},handleSizeChange:function(e){console.log("每页 ".concat(e," 条")),this.pageSize=e,this.getHistoryEvent()},handleCurrentChange:function(e){this.page=e,console.log("当前页: ".concat(e)),this.getHistoryEvent()}}},u=c,d=(a("a37d"),a("2877")),m=Object(d["a"])(u,n,i,!1,null,null,null);t["default"]=m.exports},a37d:function(e,t,a){"use strict";a("a49a")},a49a:function(e,t,a){}}]);