(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3391aba8"],{"070e":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"boss"},[s("ul",[s("li",{staticStyle:{color:"#0084e9",cursor:"pointer"},on:{click:function(e){return t.$router.go(-1)}}},[t._v(" 我的审批 ")]),s("li",{staticStyle:{color:"#7c7f82"}},[t._v(">")]),s("li",{staticStyle:{color:"#7c7f82"}},[t._v(" 中标审批（"+t._s(t.$route.query.event_name)+"） ")])])]),t._m(0),s("div",{staticClass:"basePart"},[s("base-part",{attrs:{source:"approve"}})],1),t._m(1),s("div",{staticClass:"numbers"},[s("el-table",{ref:"multipleTable",attrs:{data:t.num}},[s("el-table-column",{attrs:{label:"询价单号",prop:"inquiry_sheet_code",align:"center"}}),s("el-table-column",{attrs:{prop:"company_name",label:"旅行社名称 Travel Agency Name","show-overflow-tooltip":"",align:"center"}}),s("el-table-column",{staticStyle:{color:"#f91"},attrs:{prop:"total_price",label:"报价 Quotation","class-name":"offerPrice",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",{staticStyle:{color:"#f91","font-weight":"bold"}},[t._v(" ￥ "+t._s(e.row.total_price))])]}}])}),s("el-table-column",{attrs:{label:"操作 Actions",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{staticClass:"checkOffer",attrs:{type:"text",size:"small"},on:{click:function(s){return t.checkOffer(e.row.quoted_price_id)}}},[t._v(" 查看报价 ")])]}}])})],1)],1),t._m(2),s("div",{staticClass:"opinion"},[s("p",[t._v("审批意见:")]),s("div",{staticClass:"right"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.ApprovalOpinion,expression:"ApprovalOpinion"}],attrs:{name:"",id:"",cols:"30",rows:"10"},domProps:{value:t.ApprovalOpinion},on:{input:function(e){e.target.composing||(t.ApprovalOpinion=e.target.value)}}})]),s("div",{staticClass:"underside"},[s("el-button",{staticStyle:{"margin-left":"20px",width:"160px","margin-top":"30px"},attrs:{type:"primary",plain:""}},[t._v("邀请其他人审批")]),s("el-button",{staticStyle:{"margin-left":"70px",width:"160px","margin-top":"30px"},attrs:{type:"danger"},on:{click:function(e){return t.max("不通过")}}},[t._v("审批不通过")]),s("el-dialog",{attrs:{title:"确认审批结果",visible:t.dialogVisible,width:"30%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[s("span",[t._v(" 审批意见一旦提交则无法修改，是否确认当前审批 "),s("span",{staticClass:"disapprove",class:["通过"===t.passMessage?"pass":""]},[t._v(t._s(t.passMessage))])]),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:t.sendApprove}},[t._v("确 定")])],1)]),s("el-button",{staticStyle:{"margin-left":"70px",width:"160px","margin-top":"30px"},attrs:{type:"success"},on:{click:function(e){return t.max("通过")}}},[t._v("审批通过")])],1)]),t._m(3),s("div",{staticClass:"Steps"},[s("el-table",{ref:"multipleTable",attrs:{data:t.arr}},[s("el-table-column",{attrs:{label:"审批步骤",prop:"approve_name",align:"center"}}),s("el-table-column",{attrs:{prop:"fullname",label:"审批人","show-overflow-tooltip":"",align:"center"}}),s("el-table-column",{attrs:{label:"审批状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("button",{class:["approveStatusBtn","待审核"==e.row.type?"":"审核通过"==e.row.type?"approvePassBtn":"approveNotPassBtn"]},[t._v(" "+t._s(e.row.type)+" ")])]}}])}),s("el-table-column",{attrs:{prop:"remarks",label:"说明","show-overflow-tooltip":"",align:"center"}}),s("el-table-column",{attrs:{prop:"approve_data",label:"操作时间","show-overflow-tooltip":"",align:"center"}})],1)],1)])},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"blue_tit"},[a("img",{attrs:{src:s("ed89"),alt:""}}),a("p",[t._v("中标报价审批")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tour"},[s("p",[t._v("旅行社报价")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"interior"},[s("p",[t._v("内保审批")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"record"},[s("p",[t._v("审批记录")])])}],o=(s("e9c4"),s("7dc4")),n={data:function(){return{menus:[],arr:[],num:[],dialogVisible:!1,dialogVisibles:!1,passMessage:"",selectQuery:{},ApprovalOpinion:""}},components:{basePart:o["a"]},mounted:function(){this.selectQuery=this.$route.query,this.getDetail()},methods:{getDetail:function(){var t=this;this.$api.getEvent({ApproveID:this.selectQuery.ApproveID},"POST").then((function(e){t.arr=e.approve,t.num=e.inquirySheet,console.log(e)}))},max:function(t){this.dialogVisible=!0,this.passMessage=t},checkOffer:function(t){this.$router.push({path:"/offer",query:{foreign_key_id:t,id:this.$route.query.id,type:this.$route.query.type}})},sendApprove:function(){var t=this,e="不通过"===this.passMessage?"1":"0";this.$api.getsave({Parameter:JSON.stringify({status:e,id:this.selectQuery.ApproveID,remarks:this.ApprovalOpinion,message:"",objection:""})},"POST").then((function(e){e&&t.$message({message:"操作成功",type:"success"}),t.dialogVisible=!1,console.log(e),t.$router.push({path:"/approve"}),t.getDetail()}))}}},r=n,l=(s("32f9"),s("2877")),c=Object(l["a"])(r,a,i,!1,null,null,null);e["default"]=c.exports},"2d1a":function(t,e,s){"use strict";s("ec55")},"32f9":function(t,e,s){"use strict";s("e2c0")},"7dc4":function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"base_part"},[s("a",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"a_click",attrs:{href:t.downloadUrl,target:"_blank",download:""}}),"approve"==t.source||"bid"==t.source||"order"==t.source?s("div",{staticClass:"nformation flex_row align_center"},[s("p",{staticStyle:{"font-size":"16px","font-family":"PingFang SC-Semibold, PingFang SC","font-weight":"600",color:"#333333","border-left":"4px solid rgb(24, 135, 255)","padding-left":"5px"}},[t._v(" 会议基本信息 ")]),"bid"==t.source||"order"==t.source||"approve"==t.source?s("p",{staticStyle:{"font-size":"12px","font-family":"PingFang SC-Regular, PingFang SC","font-weight":"400",color:"#999999"}},[t._v(" （敏感信息对供应商隐藏） ")]):t._e(),s("div",{staticClass:"showBase_tap flex_row align_center",staticStyle:{"margin-left":"10px",color:"#409eff",cursor:"pointer"},on:{click:function(e){t.conferenceHiding=!t.conferenceHiding}}},[s("span",{staticStyle:{"font-size":"14px"}},[t._v(" "+t._s(t.conferenceHiding?"收起":"展开"))]),s("i",{class:t.conferenceHiding?"el-icon-arrow-up ":"el-icon-arrow-down"})])]):t._e(),"approve"==t.source||"bid"==t.source||"order"==t.source?s("div",{staticStyle:{padding:"0 0px","padding-right":"15px"}},[s("el-divider")],1):t._e(),"stepOne"==t.source?s("div",{staticClass:"flex_row justify_between"},[s("div",{staticClass:"flex_row align_center"},[s("span",{staticClass:"base_title",staticStyle:{"font-size":"14px","font-family":"PingFang SC-Semibold, PingFang SC","font-weight":"600",color:"#666"}},[t._v("会议基本信息 ")]),s("span",{staticClass:"base_time",staticStyle:{"font-size":"12px","font-family":"PingFang SC-Regular, PingFang SC","font-weight":"400",color:"#999999"}},[t._v(" （"+t._s(this.menus.create_date)+"）")]),s("div",{staticClass:"showBase_tap flex_row align_center",staticStyle:{"margin-left":"10px",color:"#409eff"},on:{click:function(e){t.conferenceHiding=!t.conferenceHiding}}},[s("span",[t._v(" "+t._s(t.conferenceHiding?"收起":"展开"))]),s("i",{class:t.conferenceHiding?"el-icon-arrow-up ":"el-icon-arrow-down"})])]),s("div",{class:["edit_base_tap"],on:{click:t.editBaseTap}},[s("span",{class:["base_title",(1==t.menus.b2baudstatus||!t.isShowCancelBtn&&t.eventStatu>0)&&!t.isDMC?"disableColor":""],staticStyle:{"font-size":"14px","font-family":"PingFang SC-粗体, PingFang SC","font-weight":"normal",color:"#409eff"}},[t._v("编辑基本信息 ")])])]):t._e(),s("div",{directives:[{name:"show",rawName:"v-show",value:t.conferenceHiding,expression:"conferenceHiding"}],class:["information","approve"==t.source||"bid"==t.source||"order"==t.source?"margin_auto":"",t.isMsd?"is-msd":""],staticStyle:{"margin-top":"10px"}},[s("el-descriptions",{attrs:{title:""}},[s("el-descriptions-item",{attrs:{label:"会议名称"}},[s("span",{staticClass:"colorTxt"},[t._v(t._s(this.menus.event_name))])]),s("el-descriptions-item",{attrs:{label:"建团类型"}},[s("span",{staticClass:"colorTxt"},[t._v(t._s(this.menus.tourist_group_type))])]),s("el-descriptions-item",{attrs:{label:"活动类型"}},[s("span",{staticClass:"colorTxt"},[t._v(t._s(this.menus.activity_type))])]),s("el-descriptions-item",{attrs:{label:"Cvent号"}},[s("span",{staticClass:"colorTxt"},[t._v(t._s(this.menus.cvent_no))])]),s("el-descriptions-item",{attrs:{label:"客户"}},[s("span",{staticClass:"colorTxt"},[t._v(t._s(this.menus.company_name))])]),s("el-descriptions-item",{attrs:{label:"团电脑号"}},[s("span",{staticClass:"colorTxt"},[t._v(t._s(this.menus.tourist_group_no))])]),s("el-descriptions-item",{attrs:{label:"团开始日期"}},[s("span",{staticClass:"colorTxt"},[t._v(t._s(this.menus.b2b_begin))])]),s("el-descriptions-item",{attrs:{label:"团结束日期"}},[s("span",{staticClass:"colorTxt"},[t._v(t._s(this.menus.b2b_end))])]),s("el-descriptions-item",{attrs:{label:"服务类型"}},[s("span",{staticClass:"colorTxt"},[t._v(t._s(this.menus.service_type))])]),s("el-descriptions-item",{attrs:{label:"会议地点"}},[s("span",{staticClass:"colorTxt"},[t._v(t._s(this.menus.meeting_place))]),"1"==t.menus.is_hotel?s("span",{staticClass:"colorTxt",staticStyle:{"margin-left":"10px"}},[t._v("（在酒店开会）")]):t._e()]),s("el-descriptions-item",{attrs:{label:"餐标限制"}},[s("span",{staticClass:"colorTxt"},[t._v(t._s(this.menus.food_limit))])]),s("el-descriptions-item",{attrs:{label:"参会人数"}},[s("span",{staticClass:"colorTxt"},[t._v(t._s(this.menus.attendee_no+"（内部："+t.menus.inside_number+", 外部："+t.menus.external_number+"）"))])]),s("el-descriptions-item",{attrs:{label:"会议开始日期"}},[s("span",{staticClass:"colorTxt"},[t._v(t._s((this.menus.event_startdate||"").split(" ")[0]))])]),s("el-descriptions-item",{attrs:{label:"会议结束日期"}},[s("span",{staticClass:"colorTxt"},[t._v(t._s((this.menus.event_enddate||"").split(" ")[0]))])]),s("el-descriptions-item",{attrs:{label:"会议总预算"}},[s("span",{staticClass:"colorTxt"},[t._v(t._s(this.menus.total_budget))])]),s("el-descriptions-item",{attrs:{label:"会议ID"}},[s("span",{staticClass:"colorTxt"},[t._v(t._s(this.menus.event_num))])]),s("el-descriptions-item",{attrs:{label:"会议创建人"}},[s("span",{staticClass:"colorTxt"},[t._v(t._s(this.menus.create_user))])]),s("el-descriptions-item",{attrs:{label:"客户联系人"}},[s("span",{staticClass:"colorTxt"},[t._v(t._s(this.menus.username))])]),s("el-descriptions-item",{attrs:{label:"客户所属部门"}},[s("span",{staticClass:"colorTxt"},[t._v(t._s(this.menus.department))])]),s("el-descriptions-item",{attrs:{label:"客户联系电话"}},[s("span",{staticClass:"colorTxt"},[t._v(t._s(this.menus.mobile))])]),s("el-descriptions-item",{attrs:{label:"客户邮箱"}},[s("span",{staticClass:"colorTxt"},[t._v(t._s(this.menus.email))])]),s("el-descriptions-item",{attrs:{label:"发票类型"}},[s("span",{staticClass:"colorTxt"},[t._v(t._s(this.menus.invoice_type))])]),s("el-descriptions-item",{attrs:{label:"是否办理免税"}},[s("span",{staticClass:"colorTxt"},[t._v(t._s(this.menus.duty_free))])]),s("el-descriptions-item",{attrs:{label:"创建时间"}},[s("span",{staticClass:"colorTxt"},[t._v(t._s(this.menus.create_date))])]),this.menus.service_provider_name?s("el-descriptions-item",{attrs:{label:"指定供应商"}},[s("span",{staticClass:"colorTxt"},[t._v(t._s(this.menus.service_provider_name))])]):t._e()],1),s("el-descriptions",{staticStyle:{"margin-top":"-20px"},attrs:{title:"",colon:!1,column:1}},[s("el-descriptions-item",{attrs:{label:"客户材料"}},[s("span",t._l(t.menus.files,(function(e,a){return s("span",{key:a},[s("span",{staticStyle:{cursor:"pointer",color:"#4ea9f0",margin:"0 10px"},on:{click:function(s){return t.handlePreview(e)}}},[t._v(" "+t._s(e.file_name)+" ")])])})),0)])],1),s("el-descriptions",{attrs:{title:"",colon:!1,column:1}},[s("el-descriptions-item",[s("el-button",{staticStyle:{"margin-bottom":"20px","margin-left":"-10px"},attrs:{type:"primary"},on:{click:function(e){t.poShow=!0}}},[t._v("添加PO")])],1)],1),t._l(t.UnDelPoData,(function(e,a){return s("el-descriptions",{key:a,style:0==a?"margin-top: 20px":"",attrs:{colon:!1,title:0==a?"PO信息":"",column:5}},[s("el-descriptions-item",{attrs:{label:"PO单号："}},[s("span",{staticClass:"colorTxt"},[t._v(t._s(e.po_order_no))])]),s("el-descriptions-item",{attrs:{label:"PO金额 ￥："}},[s("span",{staticClass:"colorTxt"},[t._v(t._s(e.po_price))])]),s("el-descriptions-item",{attrs:{label:"PO创建时间："}},[s("span",{staticClass:"colorTxt"},[t._v(t._s(t.dateFromat(e.po_create_date)))])]),s("el-descriptions-item",{attrs:{label:"PR 单号："}},[s("span",{staticClass:"colorTxt"},[t._v(t._s(e.pr_order_no))])]),s("el-descriptions-item",[s("span",{staticStyle:{"font-size":"15px",color:"rgb(64, 158, 255)",cursor:"pointer"},on:{click:function(s){return t.handleTap("delete",e.id)}}},[t._v("删除")])])],1)}))],2),s("el-dialog",{attrs:{visible:t.poShow,width:"500px",title:"PO"},on:{"update:visible":function(e){t.poShow=e}}},[s("div",[s("el-form",{ref:"poDataForm",attrs:{model:t.poData,"label-width":"100px","label-position":"left","hide-required-asterisk":!0,"destroy-on-close":"",rules:t.rules}},[s("el-form-item",{attrs:{prop:"po_order_no"}},[s("span",{attrs:{slot:"label"},slot:"label"},[t._v("PO单"),s("span",{staticClass:"color-name"},[t._v("*")])]),s("el-input",{staticClass:"demand_300",attrs:{placeholder:"请输入PO单号",size:"small",clearable:""},model:{value:t.poData.po_order_no,callback:function(e){t.$set(t.poData,"po_order_no",e)},expression:"poData.po_order_no"}})],1),s("el-form-item",{attrs:{prop:"po_price"}},[s("span",{attrs:{slot:"label"},slot:"label"},[t._v("PO金额"),s("span",{staticClass:"color-name"},[t._v("*")])]),s("el-input",{staticClass:"demand_300",attrs:{placeholder:"请输入PO金额",size:"small",clearable:""},model:{value:t.poData.po_price,callback:function(e){t.$set(t.poData,"po_price",e)},expression:"poData.po_price"}})],1),s("el-form-item",{attrs:{prop:"po_create_date"}},[s("span",{attrs:{slot:"label"},slot:"label"},[t._v("PO创建时间"),s("span",{staticClass:"color-name"},[t._v("*")])]),s("el-date-picker",{staticClass:"demand_300",attrs:{"value-format":"yyyy-MM-dd HH:mm",placeholder:"请选择PO创建时间",size:"small",clearable:""},model:{value:t.poData.po_create_date,callback:function(e){t.$set(t.poData,"po_create_date",e)},expression:"poData.po_create_date"}})],1),s("el-form-item",{attrs:{prop:"pr_order_no"}},[s("span",{attrs:{slot:"label"},slot:"label"},[t._v("PR"),s("span",{staticClass:"color-name"},[t._v("*")])]),s("el-input",{staticClass:"demand_300",attrs:{placeholder:"请输入PR号",size:"small",clearable:""},model:{value:t.poData.pr_order_no,callback:function(e){t.$set(t.poData,"pr_order_no",e)},expression:"poData.pr_order_no"}})],1)],1)],1),s("span",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.poShow=!1}}},[t._v("取 消")]),s("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:function(e){return t.handleTap("add")}}},[t._v("确 认")])],1)])],1)},i=[],o=(s("4de4"),s("d3b7"),s("ac1f"),s("5319"),s("caad"),s("3ca3"),s("ddb0"),s("2b3d"),s("9861"),s("b0c0"),{name:"basePart_2",props:["source","isDMC","isShowCancelBtn","eventStatu","isMsd"],data:function(){return{downloadUrl:"",menus:{files:[]},poShow:!1,conferenceHiding:!1,cityCode:"",poData:{id:"",pr_order_no:"",event_info_id:"",po_order_no:"",po_price:"",po_create_date:"",cmd:"add",create_user:"test"},UnDelPoData:[],hasUnDelPoData:!1,poList:[],files:[],rules:{po_order_no:[{required:!0,message:"请输入PO单号",trigger:"blur"}],po_price:[{required:!0,message:"请输入PO金额",trigger:"blur"}],po_create_date:[{required:!0,message:"请选择PO创建时间",trigger:"blur"}],pr_order_no:[{required:!0,message:"请输入PR",trigger:"blur"}]}}},mounted:function(){this.Service(),this.getPO()},methods:{getPO:function(){var t=this;this.$api.getPoTap({eventInfoId:this.$route.query.id},"GET").then((function(e){t.poList=e,t.UnDelPoData=t.poList.filter((function(t,e,s){return 0==t.is_delete})),t.hasUnDelPoData=!!t.UnDelPoData,console.log(t.hasUnDelPoData)}))},handleTap:function(t,e){var s=this;this.poData.event_info_id=this.$route.query.id,this.poData.cmd=t,e?(this.poData.id=e,this.$api.addPoTap(this.poData,"POST").then((function(t){s.poData.po_order_no="",s.poData.po_price="",s.poData.po_create_date="",s.poShow=!1,s.getPO()}))):this.$refs.poDataForm.validate((function(t){t&&s.$api.addPoTap(s.poData,"POST").then((function(t){s.poData.po_order_no="",s.poData.po_price="",s.poData.po_create_date="",s.poShow=!1,s.getPO()}))}))},poEdit:function(t){if(this.poShow=!0,this.poData=t,this.poData.po_create_date.indexOf(" ")<0){var e=this.dateFromat(this.poData.po_create_date);this.poData.po_create_date=new Date(e)}},handlePreview:function(t){var e=this;if(t.file_path){var s=t.file_path.substring(t.file_path.lastIndexOf(".")+1),a=["pdf","jpeg","jpg","png","txt"],i=["docx","doc","xls","xlsx","xlsm","ppt","pptx"];t.file_path=t.file_path.replace(/http:/,"https:"),this.downloadUrl=t.file_path,i.includes(s)?this.downloadUrl="https://view.officeapps.live.com/op/view.aspx?src="+encodeURIComponent(t.file_path):a.includes(s)?this.downloadUrl=t.file_path:this.$message.info("文件格式不支持预览，下载后查看"),setTimeout((function(){e.$refs.a_click.click()}),100)}},downloadFile:function(t){var e=document.createElement("a");fetch(t.file_path).then((function(t){return t.blob()})).then((function(s){e.href=URL.createObjectURL(s),console.log(e.href),e.download=t.file_name,document.body.appendChild(e),e.click()}))},dateFromat:function(t){if("string"==typeof t){var e=t.replace("/Date(","").replace(")/","");e=new Date(1*e);var s=e.getFullYear(),a=1*e.getMonth()+1,i=e.getDate(),o=s+"-"+a+"-"+i;return o}},editBaseTap:function(){this.isDMC?this.$router.push({name:"DMCcreateEvent",query:{event_num:this.menus.event_num,id:this.$route.query.id,name:this.$route.query.name,eventSearchType:this.$route.query.eventSearchType,type:"edit",getBack:!0}}):1==this.menus.b2baudstatus||!this.isShowCancelBtn&&void 0!==this.isShowCancelBtn&&0!=this.eventStatu?this.$message.info("当前信息不允许编辑"):this.$router.push({name:"CreateEvent",query:{event_num:this.menus.event_num,id:this.$route.query.id,name:this.$route.query.name,eventSearchType:this.$route.query.eventSearchType,type:"edit",getBack:!0}})},Service:function(){var t=this;this.$api.getData({MeetingID:this.$route.query.id},"POST").then((function(e){var s;t.menus=e,t.menus.files=null!==(s=t.menus.files)&&void 0!==s?s:[],t.cityCode=t.menus.event_city_code,localStorage.setItem("event_city_code",t.cityCode)}))}}}),n=o,r=(s("2d1a"),s("2877")),l=Object(r["a"])(n,a,i,!1,null,"75fdf0a2",null);e["a"]=l.exports},e2c0:function(t,e,s){},ec55:function(t,e,s){},ed89:function(t,e,s){t.exports=s.p+"img/锁定.f16270db.png"}}]);