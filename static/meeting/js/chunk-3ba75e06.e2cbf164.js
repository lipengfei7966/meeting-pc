(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3ba75e06"],{"054a":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"create_event box"},[a("el-container",{staticStyle:{height:"100%"}},[a("el-header",{staticClass:"space-between el-border"},[a("p",{staticStyle:{"font-size":"16px","font-family":"PingFang SC-Medium, PingFang SC","font-weight":"500",color:"#000000","padding-left":"5px","border-left":"4px solid rgb(24, 135, 255)"}},[e._v(" 填写会议基本信息 ")])]),a("el-main",[a("div",{staticClass:"base_meet"},[a("el-form",{ref:"baseMeet",attrs:{"hide-required-asterisk":!0,model:e.baseMeet,rules:e.rules,"label-width":"120px","label-position":"left"}},[a("el-form-item",{attrs:{prop:"event_name"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("会议名称"),a("span",{staticClass:"color-name"},[e._v("*")])]),a("el-input",{staticClass:"demand_500",attrs:{size:"small",clearable:""},model:{value:e.baseMeet.event_name,callback:function(t){e.$set(e.baseMeet,"event_name",t)},expression:"baseMeet.event_name"}})],1),a("el-form-item",{attrs:{prop:"tourist_group_type"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("建团类型"),a("span",{staticClass:"color-name"},[e._v("*")])]),a("el-select",{staticClass:"demand_500",attrs:{size:"small",clearable:""},model:{value:e.baseMeet.tourist_group_type,callback:function(t){e.$set(e.baseMeet,"tourist_group_type",t)},expression:"baseMeet.tourist_group_type"}},[a("el-option",{attrs:{label:"普通团",value:"1"}}),a("el-option",{attrs:{label:"转团",value:"0"}})],1)],1),0==e.baseMeet.tourist_group_type?a("el-form-item",{attrs:{prop:"oldEventId"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("原团电脑号"),a("span",{staticClass:"color-name"},[e._v("*")])]),a("el-input",{staticClass:"demand_500",attrs:{size:"small",clearable:""},model:{value:e.baseMeet.oldEventId,callback:function(t){e.$set(e.baseMeet,"oldEventId",t)},expression:"baseMeet.oldEventId"}})],1):e._e(),a("el-form-item",{attrs:{prop:"company_id"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("客户"),a("span",{staticClass:"color-name"},[e._v("*")])]),a("el-select",{staticClass:"demand_500",attrs:{size:"small",clearable:"",filterable:""},on:{change:function(t){return e.getCustomerConfig(2)}},model:{value:e.baseMeet.company_id,callback:function(t){e.$set(e.baseMeet,"company_id",t)},expression:"baseMeet.company_id"}},e._l(e.customerList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.shortname,value:e.id.toString()}})})),1)],1),a("el-form-item",{attrs:{prop:"company_contacts"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("客户联系人"),a("span",{staticClass:"color-name"},[e._v("*")])]),a("el-select",{staticClass:"demand_500",attrs:{size:"small",clearable:"",filterable:""},on:{change:e.getContact},model:{value:e.baseMeet.company_contacts,callback:function(t){e.$set(e.baseMeet,"company_contacts",t)},expression:"baseMeet.company_contacts"}},e._l(e.customerContactList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1),a("el-button",{staticClass:"mar_l10",attrs:{size:"small",type:"text"},on:{click:e.addContactDialogTap}},[e._v("添加客户联系人")])],1),a("el-form-item",{attrs:{prop:"departmentName"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("客户所属部门"),a("span",{staticClass:"color-name"},[e._v("*")])]),a("el-input",{staticClass:"demand_500",attrs:{size:"small",disabled:""},model:{value:e.baseMeet.departmentName,callback:function(t){e.$set(e.baseMeet,"departmentName",t)},expression:"baseMeet.departmentName"}})],1),a("el-form-item",{attrs:{label:"客户联系电话"}},[a("el-input",{staticClass:"demand_500",attrs:{size:"small",disabled:""},model:{value:e.baseMeet.phone,callback:function(t){e.$set(e.baseMeet,"phone",t)},expression:"baseMeet.phone"}})],1),a("el-form-item",{attrs:{label:"客户邮箱"}},[a("el-input",{staticClass:"demand_500",attrs:{size:"small",disabled:""},model:{value:e.baseMeet.email,callback:function(t){e.$set(e.baseMeet,"email",t)},expression:"baseMeet.email"}})],1),a("el-form-item",{attrs:{label:"MSA",prop:"MSA"}},[a("el-input",{staticClass:"demand_500",attrs:{size:"small",clearable:""},model:{value:e.baseMeet.MSA,callback:function(t){e.$set(e.baseMeet,"MSA",t)},expression:"baseMeet.MSA"}})],1),a("el-form-item",{attrs:{prop:"activity_type"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("活动类型"),a("span",{staticClass:"color-name"},[e._v("*")])]),a("el-select",{staticClass:"demand_500",attrs:{size:"small",clearable:""},on:{change:e.selectActive},model:{value:e.baseMeet.activity_type,callback:function(t){e.$set(e.baseMeet,"activity_type",t)},expression:"baseMeet.activity_type"}},e._l(e.activityList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"餐标限制",prop:"food_limit"}},[a("el-input",{staticClass:"demand_500",attrs:{size:"small",disabled:"",clearable:""},model:{value:e.baseMeet.food_limit,callback:function(t){e.$set(e.baseMeet,"food_limit",t)},expression:"baseMeet.food_limit"}})],1),a("el-form-item",{attrs:{label:"Cvent号",prop:"cvent_no"}},[a("el-input",{staticClass:"demand_500",attrs:{size:"small",clearable:""},model:{value:e.baseMeet.cvent_no,callback:function(t){e.$set(e.baseMeet,"cvent_no",t)},expression:"baseMeet.cvent_no"}})],1),a("el-form-item",{attrs:{label:"会议总预算"}},[a("el-input",{staticClass:"demand_500",attrs:{size:"small",clearable:""},model:{value:e.baseMeet.total_budget,callback:function(t){e.$set(e.baseMeet,"total_budget",t)},expression:"baseMeet.total_budget"}})],1),a("el-form-item",{attrs:{prop:"service_type"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("服务类型"),a("span",{staticClass:"color-name"},[e._v("*")])]),a("el-select",{staticClass:"demand_500",attrs:{size:"small",clearable:""},on:{change:e.serviceTypeChange},model:{value:e.baseMeet.service_type,callback:function(t){e.$set(e.baseMeet,"service_type",t)},expression:"baseMeet.service_type"}},e._l(e.serviceList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{prop:"event_city"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("会议城市"),a("span",{staticClass:"color-name"},[e._v("*")])]),a("el-select",{staticClass:"demand_500",attrs:{size:"small",disabled:Boolean(e.baseMeet.online_meeting),clearable:"",filterable:""},model:{value:e.baseMeet.event_city,callback:function(t){e.$set(e.baseMeet,"event_city",t)},expression:"baseMeet.event_city"}},e._l(e.cityList,(function(e){return a("el-option",{key:e.code,attrs:{label:e.value,value:e.code}})})),1),a("el-checkbox",{staticStyle:{"margin-left":"20px"},attrs:{"true-label":1,"false-label":0},model:{value:e.baseMeet.online_meeting,callback:function(t){e.$set(e.baseMeet,"online_meeting",t)},expression:"baseMeet.online_meeting"}},[e._v("线上会议")])],1),a("el-form-item",{attrs:{label:"会议地点",prop:"meeting_place"}},[a("el-input",{staticClass:"demand_500",attrs:{size:"small",clearable:""},model:{value:e.baseMeet.meeting_place,callback:function(t){e.$set(e.baseMeet,"meeting_place",t)},expression:"baseMeet.meeting_place"}}),a("el-checkbox",{staticStyle:{"margin-left":"20px"},attrs:{"true-label":1,"false-label":0},model:{value:e.baseMeet.is_hotel,callback:function(t){e.$set(e.baseMeet,"is_hotel",t)},expression:"baseMeet.is_hotel"}},[e._v("是否在酒店开会")])],1),a("el-form-item",{staticClass:"attendee_no",attrs:{prop:"attendee_no"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("参会人数"),a("span",{staticClass:"color-name"},[e._v("*")])]),a("el-col",{staticClass:"flex_row",attrs:{span:5}},[a("el-form-item",{staticClass:"attendee_no",attrs:{prop:"inside_number"}},[e._v(" 内部人数： "),a("el-input",{attrs:{size:"small",clearable:""},model:{value:e.baseMeet.inside_number,callback:function(t){e.$set(e.baseMeet,"inside_number",e._n(t))},expression:"baseMeet.inside_number"}})],1)],1),a("el-col",{staticClass:"flex_row",attrs:{span:5}},[a("el-form-item",{staticClass:"attendee_no",attrs:{prop:"external_number"}},[e._v(" 外部人数： "),a("el-input",{attrs:{size:"small",clearable:""},model:{value:e.baseMeet.external_number,callback:function(t){e.$set(e.baseMeet,"external_number",e._n(t))},expression:"baseMeet.external_number"}})],1)],1),a("el-col",{staticClass:"flex_row",attrs:{span:5}},[e._v(" 总人数："+e._s(e.baseMeet.attendee_no)+" ")])],1),a("el-form-item",{attrs:{prop:"event_startdate"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("会议开始日期"),a("span",{staticClass:"color-name"},[e._v("*")])]),a("el-date-picker",{staticClass:"demand_500",attrs:{size:"small",clearable:"",type:"date","picker-options":e.pickerStart,"value-format":"yyyy-MM-dd",placeholder:"选择日期"},on:{change:e.timeStart},model:{value:e.baseMeet.event_startdate,callback:function(t){e.$set(e.baseMeet,"event_startdate",t)},expression:"baseMeet.event_startdate"}})],1),a("el-form-item",{attrs:{prop:"event_enddate"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("会议结束日期"),a("span",{staticClass:"color-name"},[e._v("*")])]),a("el-date-picker",{staticClass:"demand_500",attrs:{size:"small",clearable:"",type:"date","picker-options":e.pickerEnd,"value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.baseMeet.event_enddate,callback:function(t){e.$set(e.baseMeet,"event_enddate",t)},expression:"baseMeet.event_enddate"}})],1),a("el-form-item",{attrs:{prop:"invoice_type"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("发票类型"),a("span",{staticClass:"color-name"},[e._v("*")])]),a("el-radio",{attrs:{disabled:"",label:0},model:{value:e.baseMeet.invoice_type,callback:function(t){e.$set(e.baseMeet,"invoice_type",t)},expression:"baseMeet.invoice_type"}},[e._v("普票")]),a("el-radio",{attrs:{disabled:"",label:1},model:{value:e.baseMeet.invoice_type,callback:function(t){e.$set(e.baseMeet,"invoice_type",t)},expression:"baseMeet.invoice_type"}},[e._v("专票")]),a("el-radio",{attrs:{disabled:"",label:2},model:{value:e.baseMeet.invoice_type,callback:function(t){e.$set(e.baseMeet,"invoice_type",t)},expression:"baseMeet.invoice_type"}},[e._v("免税")])],1),a("el-form-item",{attrs:{label:"是否办理免税",prop:"is_duty_free"}},[a("el-radio",{attrs:{label:0},model:{value:e.baseMeet.is_duty_free,callback:function(t){e.$set(e.baseMeet,"is_duty_free",t)},expression:"baseMeet.is_duty_free"}},[e._v("否")]),a("el-radio",{attrs:{label:1},model:{value:e.baseMeet.is_duty_free,callback:function(t){e.$set(e.baseMeet,"is_duty_free",t)},expression:"baseMeet.is_duty_free"}},[e._v("是")])],1),a("el-form-item",{attrs:{label:"是否是DMC创建会议",prop:"meeting_type",hidden:""}},[a("el-input",{attrs:{size:"small",value:"0"}})],1),a("el-form-item",{attrs:{label:"附件"}},[a("div",{staticClass:"demand_500 text_left"},[a("el-upload",{ref:"upload",attrs:{action:e.UploadFilesUrl,"before-upload":e.fileLimit,"on-success":e.uploadFile,"on-preview":e.downloadFile,"on-remove":e.deleteFile,"file-list":e.fileList,"show-file-list":!0,multiple:!0}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选择文件")])],1),a("br"),a("span",{staticClass:"ps"},[e._v("注意: 只允许上传以下文件类型：doc、docx、xls、xlsx、pdf、ppt、pptx、jpeg、jpg、png、zip、eml、rtf、msg、gif、bmp、tif、tiff、rar、iso、7z、tar、bz2、gzip、txt、mp4、xps、odf，最大30M")])],1)]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.establishFlag,expression:"establishFlag"}],staticClass:"div_next"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.subEvent(2)}}},[e._v("下一步")])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.establishFlag,expression:"!establishFlag"}],staticClass:"row_around",staticStyle:{"margin-right":"50px"}},[e.eventId&&4!=this.$route.query.eventSearchType?e._e():a("el-button",{staticClass:"submit_btn",attrs:{type:"info"},on:{click:function(t){return e.subEvent(1)}}},[e._v("保存草稿")]),"edit"==this.$route.query.type?a("el-button",{staticClass:"submit_btn",on:{click:function(t){return e.cancel()}}},[e._v("返回")]):e._e(),a("el-button",{staticClass:"submit_btn",attrs:{type:"primary"},on:{click:function(t){return e.subEvent(0)}}},[e._v(e._s("edit"==this.$route.query.type?"保存":"创建会议"))])],1)],1)],1)])],1),e.hisDialog?a("el-dialog",{attrs:{title:"复制历史会议",visible:e.hisDialog,width:"650px"},on:{"update:visible":function(t){e.hisDialog=t},close:function(t){e.hisDialog=!1}}},[e.eventList.length?a("div",{staticClass:"event_list"},[e._l(e.eventList,(function(t,s){return a("div",{key:s,staticClass:"event_item"},[a("p",{staticClass:"text_left"},[e._v("会议名称："+e._s(t.event_name))]),a("p",{staticClass:"text_left"},[e._v("活动类型："+e._s(t.activity_name))]),t.event_startdate&&t.event_enddate?a("p",{staticClass:"text_left"},[e._v(" 会议时间："+e._s(t.event_startdate.substring(0,10))+"--"+e._s(t.event_enddate.substring(0,10))+" ")]):e._e(),a("p",{staticClass:"text_left"},[e._v("参会人数："+e._s(t.attendee_no))]),a("div",{staticClass:"flex_row justify_center"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.copyEvent(t,1)}}},[e._v("复制此会议")])],1)])})),a("div",{staticClass:"flex_row justify_center",staticStyle:{width:"100%"}},[a("el-pagination",{attrs:{layout:"prev, pager, next",total:e.pageInfo.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],2):e._e()]):e._e(),a("el-dialog",{attrs:{visible:e.hisStartDialog,width:"650px",center:""},on:{"update:visible":function(t){e.hisStartDialog=t},close:function(t){e.hisStartDialog=!1}}},[a("div",{staticClass:"his_title"},[a("span",[e._v("复制会议")]),a("em",[e._v("（复制完成后可在会议详情页编辑会议基本信息和采购需求）")])]),a("div",{staticClass:"his_date"},[a("span",[e._v("会议开始时间：")]),a("el-date-picker",{staticClass:"demand_200",attrs:{size:"small",clearable:"",type:"date","picker-options":e.pickerStart,"value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.hisStartDate,callback:function(t){e.hisStartDate=t},expression:"hisStartDate"}})],1),a("span",{staticClass:"dialog-footer flex_row justify_center",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.preStep}},[e._v("上一步")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.copyEvent(0,2)}}},[e._v("完 成")])],1)]),a("el-dialog",{attrs:{title:e.eventId?"保存成功":"会议创建完成",visible:e.demandDialog,width:"650px"},on:{"update:visible":function(t){e.demandDialog=t},close:function(t){e.demandDialog=!1}}},[a("span",{staticClass:"dialog-footer flex_row justify_center",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.goDemand}},[e._v("填写采购需求")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.goDetail}},[e._v("查看会议详情")])],1)]),a("el-dialog",{attrs:{title:"客户联系人",visible:e.addContactDialog,"close-on-click-modal":!1,width:"500px"},on:{"update:visible":function(t){e.addContactDialog=t},close:function(t){e.addContactDialog=!1}}},[a("el-form",{ref:"contactInfo",attrs:{"hide-required-asterisk":!0,model:e.contactInfo,rules:e.contactRules,"label-width":"100px"}},[a("el-form-item",{attrs:{prop:"name"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("姓名"),a("span",{staticClass:"color-name"},[e._v("*")])]),a("el-input",{staticClass:"demand_300",attrs:{size:"small",clearable:""},model:{value:e.contactInfo.name,callback:function(t){e.$set(e.contactInfo,"name",t)},expression:"contactInfo.name"}})],1),a("el-form-item",{attrs:{prop:"phone"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("电话"),a("span",{staticClass:"color-name"},[e._v("*")])]),a("el-input",{staticClass:"demand_300",attrs:{type:"number",maxlength:11,size:"small",clearable:""},model:{value:e.contactInfo.phone,callback:function(t){e.$set(e.contactInfo,"phone",t)},expression:"contactInfo.phone"}})],1),a("el-form-item",{attrs:{prop:"mailbox"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("邮箱"),a("span",{staticClass:"color-name"},[e._v("*")])]),a("el-input",{staticClass:"demand_300",attrs:{type:"email",size:"small",clearable:""},model:{value:e.contactInfo.mailbox,callback:function(t){e.$set(e.contactInfo,"mailbox","string"===typeof t?t.trim():t)},expression:"contactInfo.mailbox"}})],1),a("el-form-item",{attrs:{prop:"company_id"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("公司"),a("span",{staticClass:"color-name"},[e._v("*")])]),a("el-select",{staticClass:"demand_300",attrs:{size:"small",clearable:"",filterable:""},on:{change:function(t){return e.getCustomerConfig(1)}},model:{value:e.contactInfo.company_id,callback:function(t){e.$set(e.contactInfo,"company_id",t)},expression:"contactInfo.company_id"}},e._l(e.customerList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.shortname,value:e.id.toString()}})})),1)],1),a("el-form-item",{attrs:{prop:"customer_id"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("部门"),a("span",{staticClass:"color-name"},[e._v("*")])]),a("el-select",{staticClass:"demand_300",attrs:{size:"small",clearable:"",filterable:""},model:{value:e.contactInfo.customer_id,callback:function(t){e.$set(e.contactInfo,"customer_id",e._n(t))},expression:"contactInfo.customer_id"}},e._l(e.departmentList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.shortname,value:e.id}})})),1)],1)],1),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.addContactDialog=!1}}},[e._v("取 消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.addContactTap("contactRules")}}},[e._v("确 定")])],1)],1)],1)},n=[],i=(a("a9e3"),a("d3b7"),a("159b"),a("25f0"),a("7db0"),a("4de4"),a("e9c4"),a("b0c0"),a("fb6a"),a("393b")),o=a("2654"),l=a("f121"),r=a("df68"),c={name:"createEvent",data:function(){var e=this;return{clientId:"",fileList:[],UploadFilesUrl:l["b"]+"/MeetingMa/UploadFiles",uploadList:{},eventId:"",limitDate:new Date,addContactDialog:!1,contactInfo:{id:"",name:"",phone:"",mailbox:"",customer_id:"",company_id:""},contactRules:{name:[{required:!0,message:"请输入联系人姓名",trigger:"blur"}],phone:[{required:!0,message:"请输入联系人电话",trigger:"blur"},{pattern:/^((0\d{2,3}-\d{7,8})|(1[3567849]\d{9}))$/,message:"请输入合法手机号/电话号",trigger:"blur"}],mailbox:[{required:!0,message:"请输入联系人邮箱",trigger:"blur"},{validator:o["h"],trigger:"blur"}],customer_id:[{required:!0,message:"请选择部门",trigger:"change"}],company_id:[{required:!0,message:"请选择公司",trigger:"change"}]},hisDialog:!1,hisStartDialog:!1,demandDialog:!1,hisStartDate:"",container_height:document.documentElement.clientHeight-20,eventList:[],cityList:[],customerList:[{id:7019,shortname:"中旅会展测试客户",count:24},{id:7025,shortname:"拜耳医药保健有限公司",count:37},{id:7026,shortname:"拜耳医药（上海）有限公司",count:15},{id:7027,shortname:"拜耳作物科学（中国）有限公司",count:3},{id:7039,shortname:"用友网络科技股份有限公司",count:2},{id:7053,shortname:"默沙东（中国）投资有限公司",count:32},{id:7054,shortname:"上海默沙东医药贸易有限公司",count:2},{id:7055,shortname:"杭州默沙东制药有限公司",count:8},{id:7056,shortname:"默沙东动物保健品（上海）有限公司",count:0},{id:7057,shortname:"默沙东研发（中国）有限公司",count:1},{id:7058,shortname:"安乐福（中国）智能科技有限公司",count:2},{id:7059,shortname:"欧加隆（上海）医药贸易有限公司",count:2},{id:7060,shortname:"欧加隆（上海）医药科技有限公司",count:14},{id:7061,shortname:"礼来（上海）管理有限公司",count:24},{id:7062,shortname:"礼来苏州制药有限公司",count:3}],customerContactList:[],mealList:[],activityList:[],departmentList:[],serviceList:[],cityLisy:[],rules:{attendee_no:[{required:!0,message:"请输入参会人数",trigger:"blur"}],external_number:[{required:!0,message:"请输入外部人数",trigger:"blur"}],inside_number:[{required:!0,message:"请输入内部人数",trigger:"blur"}],event_name:[{required:!0,message:"请输入会议名称",trigger:"blur"}],oldEventId:[{required:!0,message:"请输入原团电脑号",trigger:"blur"}],tourist_group_type:[{required:!0,message:"请选择建团类型",trigger:"change"}],company_id:[{required:!0,message:"请选择客户",trigger:"change"}],activity_type:[{required:!0,message:"请选择活动类型",trigger:"change"}],event_city:[{required:!0,message:"请选择会议城市",trigger:"change"}],company_contacts:[{required:!0,message:"请选择客户联系人",trigger:"change"}],departmentName:[{required:!0,message:"客户联系人必须有所属部门",trigger:["blur","change"]}],event_startdate:[{required:!0,message:"请选择日期",trigger:"change"}],event_enddate:[{required:!0,message:"请选择日期",trigger:"change"}],service_type:[{required:!0,message:"请选择服务类型",trigger:"change"}],invoice_type:[{required:!0,message:"请选择发票类型",trigger:"change"}]},baseMeet:{event_name:"",tourist_group_type:"1",oldEventId:"",company_id:"",activity_type:"",cvent_no:"",total_budget:"",service_type:"",food_limit:"",attendee_no:0,inside_number:"",external_number:"",event_startdate:"",event_enddate:"",company_contacts:"",email:"",phone:"",MSA:"",invoice_type:1,is_duty_free:"",department:"",departmentName:"",event_city:"",document_attachments_file_path:[],files:[],fileInfos:[],service_provider_id:"",online_meeting:!1,meeting_place:"",is_hotel:!1,meeting_type:0},pageInfo:{totalCount:0},createDate:(new Date).getTime(),pageSize:6,page:1,hisId:"",hisItem:"",his_startDate:"",newEventId:"",newEventName:"",pickerStart:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}},pickerEnd:{disabledDate:function(t){return e.baseMeet.event_enddate?t.getTime()<=new Date(e.baseMeet.event_startdate).getTime()-864e5||t.getTime()<=new Date(e.baseMeet.createDate).getTime()-864e5:t.getTime()>=new Date(e.event_startdate).getTime()-864e5}},establishFlag:!1}},directives:{inputFilter:i["a"]},watch:{"baseMeet.company_id":{deep:!0,handler:function(e,t){}},"baseMeet.company_contacts":{deep:!0,handler:function(e,t){}},"baseMeet.online_meeting":{deep:!0,handler:function(e,t){e?(this.rules.event_city[0].required=!1,this.baseMeet.event_city=""):this.rules.event_city[0].required=!0}},"baseMeet.inside_number":{deep:!0,handler:function(e,t){Number(e)&&e>0?(this.rules.external_number[0].required=!1,this.baseMeet.attendee_no=Number(e)+Number(this.baseMeet.external_number)):(this.baseMeet.inside_number="",this.baseMeet.attendee_no=this.baseMeet.external_number)}},"baseMeet.external_number":{deep:!0,handler:function(e,t){Number(e)&&e>0?(this.rules.inside_number[0].required=!1,this.baseMeet.attendee_no=Number(e)+Number(this.baseMeet.inside_number)):(this.baseMeet.external_number="",this.baseMeet.attendee_no=this.baseMeet.inside_number)}}},created:function(){console.log(this.$route),this.$route.params.hotel?(this.establishFlag=!0,console.log(this.$route),this.getCustomerList()):this.getCustomerList(),this.getCityList(),this.getServiceType()},mounted:function(){var e=this;this.$nextTick((function(){var t=e.$route.query;t&&t.type&&"edit"===t.type?(e.eventId=e.$route.query.id,e.baseMeet.id=e.$route.query.id,e.baseMeet.event_num=e.$route.query.event_num,e.getEventDetail()):e.eventId=""}))},methods:{getEventDetail:function(){var e=this;this.$api.getEventDetail({eventId:this.baseMeet.event_num,eventSearchType:this.$route.query.eventSearchType},"GET").then((function(t){t.EventModels&&(e.baseMeet=t.EventModels[0],e.fileList=[],e.baseMeet.fileInfos.forEach((function(t){e.fileList.push({id:t.id,name:t.file_name,url:t.file_path})})),e.baseMeet.tourist_group_type=e.baseMeet.tourist_group_type.toString()),e.baseMeet.company_id&&e.$api.GetCustomerContactList({id:e.baseMeet.company_id,type:1},"post").then((function(t){if(t&&!0!==t){e.customerContactList=t;var a=e.customerContactList.find((function(t){return t.id==e.baseMeet.company_contacts}));e.baseMeet.email=a.mailbox,e.baseMeet.phone=a.phone,e.getContactInfo(a.id)}else e.customerContactList=[]})),console.log(e.baseMeet)}))},getCustomerConfig:function(e,t){var a=this;2===e?(this.baseMeet.company_contacts="",this.baseMeet.department="",this.baseMeet.departmentName="",this.baseMeet.email="",this.baseMeet.phone="",this.baseMeet.activity_type="",this.baseMeet.food_limit="",this.$api.GetCustomerContactList({id:this.baseMeet.company_id,type:1},"post").then((function(e){e&&!0!==e?(a.customerContactList=e,t&&a.getContact()):a.customerContactList=[]}))):1===e&&(this.contactInfo.customer_id="",this.$api.getDepartment({CompanyID:this.contactInfo.company_id},"post").then((function(e){e&&!0!==e?a.departmentList=e:(a.$message.warning("请配置该公司部门"),a.contactInfo.customer_id="")})))},getContact:function(){var e=this,t=this.customerContactList.filter((function(t){return t.id==e.baseMeet.company_contacts}));this.baseMeet.activity_type="",this.baseMeet.food_limit="",t[0]?(this.baseMeet.email=t[0].mailbox,this.baseMeet.phone=t[0].phone,this.getContactInfo(t[0].id)):(this.baseMeet.email="",this.baseMeet.phone="",this.getContactInfo(""))},getContactInfo:function(e){var t=this;this.$api.getContactInfo({ContactID:e},"POST").then((function(a){a&&(t.baseMeet.department=a.departmentyid,t.$set(t.baseMeet,"departmentName",a.shortname),e?t.getMeetingType(a.departmentyid):t.activityList=[])}))},getMeetingType:function(e){var t=this,a={};a=e?{DepartmentyID:e}:{CompanyID:this.baseMeet.company_id},this.$api.getMeetingTypeShow(a,"POST").then((function(e){t.activityList=e}))},selectActive:function(){var e=this,t=this.activityList.find((function(t){return e.baseMeet.activity_type==t.id}));this.baseMeet.food_limit=t?t.meal_label:""},timeStart:function(){if(this.baseMeet.event_startdate>this.baseMeet.event_enddate)return this.baseMeet.event_enddate=this.baseMeet.event_startdate},getServiceType:function(){var e=this;this.$api.getServiceType({},"post").then((function(t){e.serviceList=t,e.baseMeet.service_type||(e.baseMeet.service_type=e.serviceList[0].id,e.baseMeet.invoice_type=1)}))},serviceTypeChange:function(e){"456d1027-413b-11ec-9db6-fa163ed463f8"==e?this.baseMeet.invoice_type=1:"59266863-413b-11ec-9db6-fa163ed463f8"==e&&(this.baseMeet.invoice_type=0)},addContactDialogTap:function(){this.addContactDialog=!0,this.contactInfo={id:"",name:"",phone:"",mailbox:"",customer_id:"",company_id:""},this.contactInfo.company_id=this.baseMeet.company_id,this.getCustomerConfig(1)},addContactTap:function(e){var t=this;this.$refs.contactInfo.validate((function(e){e&&(console.log(t.contactInfo),t.$api.addContact({Parameter:JSON.stringify(t.contactInfo)},"post").then((function(e){e&&(t.addContactDialog=!1,t.$message.success("添加成功"),t.getCustomerConfig(2,"addContactSuccess"),t.baseMeet.company_contacts=t.contactInfo.name,t.clientId=e)})))}))},subEvent:function(e){var t=this;this.baseMeet.event_status=e,this.clientId&&(this.baseMeet.company_contacts=this.clientId),0===e?(localStorage.setItem("event_city_code",this.baseMeet.event_city),this.$refs["baseMeet"].validate((function(e){e?(t.baseMeet.event_enddate=t.baseMeet.event_enddate.slice(0,10)+" 23:59:59",t.eventId?(t.baseMeet.id=t.eventId,t.$api.updateEvent(t.baseMeet,"POST").then((function(e){e&&(t.demandDialog=!0,t.newEventId=t.$route.query.id||t.eventId,t.newEventName=t.$route.query.name||t.baseMeet.event_name)}))):t.$api.createEvent(t.baseMeet,"POST").then((function(e){e&&(t.demandDialog=!0,t.newEventId=e.eventId,t.newEventName=e.eventName)}))):t.$message.warning("请完善会议信息")}))):1===e?this.eventId?(this.baseMeet.id=this.eventId,this.$api.updateEvent(this.baseMeet,"POST").then((function(e){t.$message.success("已保存至草稿")}))):this.$api.createEvent(this.baseMeet,"POST").then((function(e){t.eventId=e.eventId,t.$message.success("已保存至草稿")})):2===e&&(this.baseMeet.event_status=0,localStorage.setItem("event_city_code",this.baseMeet.event_city),this.$refs["baseMeet"].validate((function(e){e?(t.baseMeet.event_enddate=t.baseMeet.event_enddate.slice(0,10)+" 23:59:59",t.eventId?(t.baseMeet.id=t.eventId,t.$api.updateEvent(t.baseMeet,"POST").then((function(e){e&&(t.newEventId=t.$route.query.id,t.newEventName=t.$route.query.name||t.baseMeet.event_name,t.$nextTick((function(){t.$router.push({path:"/EventDemand",query:{id:t.newEventId,name:t.newEventName}})})))}))):t.$api.createEvent(t.baseMeet,"POST").then((function(e){e&&(t.newEventId=e.eventId,t.newEventName=e.eventName,sessionStorage.setItem("isSite",JSON.stringify(t.$route.params.hotel)),t.$nextTick((function(){t.$router.push({path:"/EventDemand",query:{isNext:0,id:t.newEventId,name:t.newEventName,isSite:t.$route.params.hotel}})})))}))):t.$message.warning("请完善会议信息")})))},fileLimit:function(e){var t=e.size/1024/1024<30;return t?Object(r["a"])(e):(this.$message.error("上传附件大小不能超过 30MB!"),!1)},uploadFile:function(e){this.uploadList=e,this.baseMeet.fileInfos||(this.baseMeet.fileInfos=[]),this.baseMeet.fileInfos.push({id:"",file_name:e.title,file_path:e.weburl})},deleteFile:function(e,t){var a=this;this.baseMeet.fileInfos=[],t.forEach((function(e){e.id?a.baseMeet.fileInfos.push({id:e.id,file_name:e.name,file_path:e.url}):a.baseMeet.fileInfos.push({id:"",file_name:e.name,file_path:e.response.weburl})}))},downloadFile:function(e){var t=e.response?e.response.weburl:e.url;window.open(t,"_blank")},goDemand:function(){this.$router.push({path:"/EventDemand",query:{id:this.newEventId,name:this.newEventName}})},goDetail:function(){this.$router.push({path:"/EventDetail",query:{id:this.newEventId,name:this.newEventName}})},getCustomerList:function(){var e=this;this.$api.GetCustomerEventInfoPost({},"POST").then((function(t){e.customerList=t}))},getCityList:function(){var e=this;this.$api.getCityList({},"GET").then((function(t){e.cityList=t}))},getHistoryEvent:function(){var e=this;this.$api.getEventList({page:this.page,pageSize:this.pageSize},"GET").then((function(t){e.eventList=t.EventModels,e.pageInfo=t.pageInfo}))},preStep:function(){this.hisDialog=!0,this.hisStartDialog=!1},copyEvent:function(e,t){var a=this;if(1===t)localStorage.setItem("event_city_code",e.event_city),this.hisItem=e,this.hisDialog=!1,this.hisStartDialog=!0;else{if(!this.hisStartDate)return void this.$message.warning("请选择时间！");this.$api.copyEvent({id:this.hisItem.id,eventStartDate:this.hisStartDate},"POST").then((function(e){a.hisStartDialog=!1,a.demandDialog=!0,a.newEventId=e.newEventId}))}},handleSizeChange:function(e){console.log("每页 ".concat(e," 条")),this.pageSize=e,this.getHistoryEvent()},handleCurrentChange:function(e){this.page=e,console.log("当前页: ".concat(e)),this.getHistoryEvent()},cancel:function(){window.history.go(-1)}}},u=c,d=(a("bfa8"),a("2877")),m=Object(d["a"])(u,s,n,!1,null,"2b9ea178",null);t["default"]=m.exports},2654:function(e,t,a){"use strict";a.d(t,"j",(function(){return n})),a.d(t,"k",(function(){return i})),a.d(t,"i",(function(){return o})),a.d(t,"h",(function(){return l})),a.d(t,"l",(function(){return r})),a.d(t,"e",(function(){return c})),a.d(t,"f",(function(){return u})),a.d(t,"b",(function(){return d})),a.d(t,"g",(function(){return m})),a.d(t,"a",(function(){return p})),a.d(t,"c",(function(){return b})),a.d(t,"d",(function(){return f}));a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0");function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}a("ac1f"),a("00b4"),a("d9e2"),a("a9e3"),a("159b");function n(e,t,a){var s=/^((0\d{2,3}-\d{7,8})|(1[34578]\d{9}))$/;""==t||void 0==t||null==t||s.test(t)||""==t?a():a(new Error("请输入正确的电话号码或者固话号码"))}function i(e,t,a){var s=/0\d{2}-\d{7,8}/;""==t||void 0==t||null==t||s.test(t)||""==t?a():a(new Error("请输入正确的固话（格式：区号+号码,如010-1234567）"))}function o(e,t,a){var s=/^[1][3,4,5,7,8][0-9]{9}$/;""==t||void 0==t||null==t||s.test(t)||""==t?a():a(new Error("请输入正确的电话号码"))}function l(e,t,a){var s=/^([a-zA-Z0-9]+[-_\.]?)+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/;""==t||void 0==t||null==t||s.test(t)?a():a(new Error("请输入正确的邮箱地址"))}function r(e,t,a){var s=/^(https?|ftp):\/\/([a-zA-Z0-9.-]+(:[a-zA-Z0-9.&%$-]+)*@)*((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])){3}|([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+\.(com|edu|gov|int|mil|net|org|biz|arpa|info|name|pro|aero|coop|museum|[a-zA-Z]{2}))(:[0-9]+)*(\/($|[a-zA-Z0-9.,?'\\+&%$#=~_-]+))*$/;""==t||void 0==t||null==t||s.test(t)?a():a(new Error("请输入正确的URL"))}function c(e,t,a){if(!t)return a(new Error("输入不可以为空"));setTimeout((function(){if(Number(t)){var e=/^[0-9]*[1-9][0-9]*$/,s=e.test(t);s?a():a(new Error("请输入正整数"))}else a(new Error("请输入正整数"))}),0)}function u(e,t,a){t||a(),setTimeout((function(){if(Number(t)){var e=/^[0-9]*[1-9][0-9]*$/,s=e.test(t);s?a():a(new Error("请输入正整数"))}else a(new Error("请输入正整数"))}),1e3)}function d(e,t){var a={},n=[];if(e=Array.isArray(e)?e:[],t)for(var i=0;i<e.length;i++)if(a[e[i].date]){for(var o=0;o<n.length;o++)if(e[i].date===n[o].date){n[o].settlement+=Number("object"==s(e[i].settlement_total_price)?e[i].settlement_total_price.value:e[i].settlement_total_price),n[o].orgSettlement+=Number("object"==s(e[i].total_price)?e[i].total_price.value:e[i].total_price),n[o].data.push(e[i]);break}}else n.push({date:e[i].date,settlement:Number("object"==s(e[i].settlement_total_price)?e[i].settlement_total_price.value:e[i].settlement_total_price),orgSettlement:Number("object"==s(e[i].total_price)?e[i].total_price.value:e[i].total_price),data:[e[i]]}),a[e[i].date]=e[i];else for(var l=0;l<e.length;l++)if(a[e[l].date]){for(var r=0;r<n.length;r++)if(e[l].date===n[r].date){n[r].settlement+="object"==s(e[l].settlement_price)?e[l].settlement_price.value:e[l].settlement_price,n[r].orgSettlement+="object"==s(e[l].price)?e[l].price.value:e[l].price,n[r].data.push(e[l]);break}}else n.push({date:e[l].date,settlement:"object"==s(e[l].settlement_price)?e[l].settlement_price.value:e[l].settlement_price,orgSettlement:"object"==s(e[l].price)?e[l].price.value:e[l].price,data:[e[l]]}),a[e[l].date]=e[l];return n}function m(e){var t={},a=[];e=Array.isArray(e)?e:[];for(var s=0;s<e.length;s++)if(t[e[s].checkindate]){for(var n=0;n<a.length;n++)if(e[s].checkindate===a[n].checkindate){"大床房"==e[s].roomtype?(a[n].bigBedNum=e[s].roomcount,a[n].totalNum+=e[s].roomcount):"双床房"==e[s].roomtype?(a[n].doubleBedNum=e[s].roomcount,a[n].totalNum+=e[s].roomcount):(a[n].suiteNum=e[s].roomcount,a[n].totalNum+=e[s].roomcount);break}}else e[s].bigBedNum=0,e[s].doubleBedNum=0,e[s].suiteNum=0,e[s].totalNum=0,"大床房"==e[s].roomtype?(e[s].bigBedNum=e[s].roomcount,e[s].totalNum+=e[s].roomcount):"双床房"==e[s].roomtype?(e[s].doubleBedNum=e[s].roomcount,e[s].totalNum+=e[s].roomcount):(e[s].suiteNum=e[s].roomcount,e[s].totalNum+=e[s].roomcount),a.push(e[s]),t[e[s].checkindate]=e[s];return a}function p(e){for(var t={},a=[],s=0;s<e.length;s++){var n=(e[s].build?e[s].build.price:0)+(e[s].rentalCosts?e[s].rentalCosts.price:0);if(e[s].equipment&&e[s].equipment.forEach((function(e){n+=e.price||0})),t[e[s].rentalCosts.time])for(var i=function(t){if(e[s].rentalCosts.time===a[t].time)return a[t].totalPrice+=(e[s].build?e[s].build.price:0)+(e[s].rentalCosts?e[s].rentalCosts.price:0),e[s].equipment&&e[s].equipment.forEach((function(e){a[t].totalPrice+=e.price||0})),a[t].data.push(e[s]),"break"},o=0;o<a.length;o++){var l=i(o);if("break"===l)break}else a.push({time:e[s].rentalCosts.time,totalPrice:n,data:[e[s]]}),t[e[s].rentalCosts.time]=e[s]}return a}function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"time",a={},s=[];e=e||[];for(var n=0;n<e.length;n++)if(a[e[n][t]]){for(var i=0;i<s.length;i++)if(e[n][t]===s[i].time){s[i].data.push(e[n]),s[i].car.push(e[n]);break}}else s.push({time:e[n][t],car_date:e[n][t].substring(0,10),breakfast:e[n].breakfast,networks:e[n].networks,describe:e[n].describe,otherrequirements:e[n].otherrequirements,type:e[n].type,room_budget:e[n].room_budget,purpose:e[n].purpose,offer_remarks:e[n].offer_remarks,comments:e[n].comments,data:[e[n]],car:[e[n]]}),a[e[n][t]]=e[n];return s}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"time",a={},s=[];e=e||[];for(var n=0;n<e.length;n++)s.push({time:e[n][t],car_date:e[n][t].substring(0,10),breakfast:e[n].breakfast,networks:e[n].networks,describe:e[n].describe,otherrequirements:e[n].otherrequirements,type:e[n].type,room_budget:e[n].room_budget,purpose:e[n].purpose,offer_remarks:e[n].offer_remarks,comments:e[n].comments,data:[e[n]],car:[e[n]]}),a[e[n][t]]=e[n];return s}},"32ec":function(e,t,a){},"393b":function(e,t,a){"use strict";a("ac1f"),a("5319"),a("4d63"),a("c607"),a("2c3e"),a("25f0"),a("00b4");var s=function(e,t,a){e.addEventListener(t,a,!1)},n=function(e){s(e,"keyup",(function(){e.value=e.value.replace(/\s+/,"")}))},i=function(e){s(e,"keyup",(function(){e.value=e.value.replace(/\D/g,""),console.log(e.value)}))},o=function(e){s(e,"keyup",(function(){e.value=e.value.replace(/[^\d.]*/g,""),isNaN(e.value)&&(e.value="")}))},l=function(e){s(e,"keyup",(function(){e.value=e.value.replace(/[^\a-\z\A-\Z0-9\u4E00-\u9FA5]/g,"")}))},r=function(e){s(e,"blur",(function(){if(e.value){var t=new RegExp("^(13|14|15|16|17|18|19)[0-9]{9}$");t.test(e.value)||(e.value="")}}))},c=function(e){s(e,"blur",(function(){if(e.value){var t=/(^#)|(^http(s*):\/\/[^\s]+\.[^\s]+)/;t.test(e.value)||(e.value="")}}))},u={bind:function(e,t){switch("input"!==e.tagName.toLowerCase()&&(e=e.getElementsByTagName("input")[0]),n(e),t.arg){case"int":i(e);break;case"price":o(e);break;case"special":l(e);break;case"phone":r(e);break;case"url":c(e);break;default:break}}},d=function(e){e.directive("inputFilter",u)};window.Vue&&(window.inputFilter=u,Vue.use(d)),u.install=d;t["a"]=u},"7db0":function(e,t,a){"use strict";var s=a("23e7"),n=a("b727").find,i=a("44d2"),o="find",l=!0;o in[]&&Array(1)[o]((function(){l=!1})),s({target:"Array",proto:!0,forced:l},{find:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),i(o)},bfa8:function(e,t,a){"use strict";a("32ec")}}]);