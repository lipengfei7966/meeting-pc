(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-44a1ac66"],{3698:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"orderList"},[s("div",{staticClass:"content"},[s("div",[s("screen",{attrs:{filtrate:t.filtrate},on:{screen:t.screen,reset:t.reset}})],1),s("div",[s("mettingList",{ref:"mettingList",attrs:{tableData:t.tableData.List,columns:t.columns,operate:t.operate},on:{classifyName:t.classifyName,handleSizeChange:t.handleSizeChange,handleCurrentChange:t.handleCurrentChange}})],1)]),s("el-dialog",{attrs:{title:"留言",visible:t.leaveMessageStatus,"before-close":function(t){e.itemData=null,t()},center:!0,width:"600px"},on:{"update:visible":function(e){t.leaveMessageStatus=e}}},[t.leaveMessageStatus?s("leaveMessage",{attrs:{id:t.leaveMessageId}}):t._e()],1)],1)},i=[],n=(a("4de4"),a("d3b7"),a("ac1f"),a("841c"),a("3e9f")),l=a("87da"),o=a("b7e4"),r={name:"OrderList",components:{leaveMessage:n["a"],screen:l["a"],mettingList:o["a"]},data:function(){return{leaveMessageStatus:!1,leaveMessageId:null,addProjectStatus:!1,itemData:null,search:{num:"",company_name:"",event_name:"",event_owner:"",startdate:null,enddate:null,status:""},allStatus:[{code:"0020-1",name:"订单执行中"},{code:"0020-2",name:"订单取消"},{code:"0020-3",name:"已创建待执行"},{code:"0020-4",name:"已执行待结算"},{code:"0020-5",name:"待确认结算单"},{code:"0020-6",name:"已确认待结算"},{code:"0020-7",name:"客户驳回结算单"},{code:"0020-8",name:"要求补充材料"}],tableData:{CurrentPage:1,List:[]},filtrate:[{label:"订单号",type:"input",modelVal:"",fieId:"num",inputType:"string"},{label:"公司名称",type:"input",modelVal:"",fieId:"company_name",inputType:"string"},{label:"活动名称",type:"input",modelVal:"",fieId:"event_name",inputType:"string"},{label:"联系人",type:"input",modelVal:"",fieId:"event_owner",inputType:"string"},{label:"开始时间",type:"datePicker",modelVal:"",fieId:"event_startdate"},{label:"结束时间",type:"datePicker",modelVal:"",fieId:"event_enddate"},{label:"状态",type:"select",fieId:"status",modelVal:"",selsetVal:[{code:"0020-1",name:"订单执行中"},{code:"0020-2",name:"订单取消"},{code:"0020-3",name:"已创建待执行"},{code:"0020-4",name:"已执行待结算"},{code:"0020-5",name:"待确认结算单"},{code:"0020-6",name:"已确认待结算"},{code:"0020-7",name:"客户驳回结算单"},{code:"0020-8",name:"要求补充材料"}]}],columns:[{label:"订单号",width:"160",prop:"num",align:"center",hidden:!0},{label:"公司名称",width:"220",prop:"company_name",align:"center",hidden:!0},{label:"会议名称",width:"220",prop:"event_name",align:"left",hidden:!0},{label:"联系人",width:"120",prop:"customer_contact_name",align:"center",hidden:!0},{label:"参会人数",width:"120",prop:"attendee_no",align:"right",hidden:!0},{label:"活动日期",width:"220",prop:"activityDate",slot:"activityDate",align:"center",hidden:!0},{label:"报价人",width:"120",prop:"fullname",align:"center",hidden:!0},{label:"报价时间",width:"160",prop:"offer_data",align:"center",hidden:!0},{label:"报价",prop:"price",align:"right",hidden:!0},{label:"状态",width:"140",prop:"statusname",slot:"statusname",align:"center",hidden:!0}],operate:[{propName:"查看",badge:!0,classifyName:"examine"},{propName:"原询价单",classifyName:"rawList"},{propName:"留言",badge:!0,classifyName:"leaveWord"}],pageSize:10,page:1,state:!0}},methods:{leaveMessage:function(e){var t=this.tableData.List.filter((function(t){return t.event_inquiry_sheet_object_id==e.event_inquiry_sheet_object_id}));t.length>0&&(t[0].new_message_count=0),this.leaveMessageId=e.event_inquiry_sheet_object_id,this.leaveMessageStatus=!0},select:function(e){this.$router.push({name:"orderInfo",params:{id:e.id}})},selectinquiry:function(e){var t=this.$router.resolve({name:"DMCquotedprice",params:{id:e.event_inquiry_sheet_object_id,isSubmit:0}});window.open(t.href,"_blank")},offShelf:function(e,t){var a=this;this.$api.casefrozen({id:t.id},"POST").then((function(e){a.$message({message:"冻结成功！",type:"success"}),a.GetList()}))},onDelete:function(e,t){var a=this;this.$api.casedelete({id:t.id},"POST").then((function(e){a.$message({message:"删除成功！",type:"success"}),a.GetList()}))},GetList:function(){var e=this;this.$api.orderformList({Page:this.page,Rows:this.pageSize,search:this.search},"POST").then((function(t){t&&(e.state=!0),e.tableData=t,e.page=e.tableData.CurrentPage,e.$refs.mettingList.pageIndex=e.page,e.$refs.mettingList.pageSize=e.pageSize,e.$refs.mettingList.totalCount=e.tableData.Counts}))},screen:function(e){this.search=e,this.GetList(),console.log(this.search)},reset:function(){this.search={num:"",company_name:"",event_name:"",event_owner:"",startdate:null,enddate:null,status:""},this.pageSize=10,this.page=1,this.GetList(),console.log("重置")},classifyName:function(e,t){var a=this.$options.methods,s=this;a[e](s,t)},handleSizeChange:function(e){this.pageSize=e,this.page=1,this.state=!1,this.GetList(),console.log("每页 ".concat(e," 条"))},handleCurrentChange:function(e){this.state&&(this.page=e,this.GetList(),console.log("当前页: ".concat(e)))},examine:function(e,t){e.select(t),console.log(e,t)},rawList:function(e,t){e.selectinquiry(t),console.log(t)},leaveWord:function(e,t){e.leaveMessage(t),console.log(t)}},mounted:function(){this.GetList(),this.$refs.mettingList.tableTitle="我的订单",this.$refs.mettingList.editWidth=200}},c=r,d=(a("4901"),a("2877")),u=Object(d["a"])(c,s,i,!1,null,"1db80f54",null);t["default"]=u.exports},"3e9f":function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"leave-message"},[a("a",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"a_click",attrs:{href:e.downloadUrl,target:"_blank",download:""}}),a("div",{staticClass:"srcoll"},[a("div",{staticClass:"message"},e._l(e.list,(function(t){return a("div",{key:t.id,staticClass:"item",class:{me:0==t.type}},[a("div",{staticClass:"date"},[e._v(e._s(0==t.type?t.Party_A+"@":t.Party_B+"@")+e._s(t.createtime))]),0==t.message_type?a("div",{staticClass:"msg"},[e._v(e._s(t.message))]):a("div",{staticClass:"msg"},[a("a",{staticStyle:{cursor:"pointer"},on:{click:function(a){return e.handlePreview(t.filepath)}}},[e._v(e._s(t.filename))])])])})),0)]),a("div",{staticClass:"edit"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.text,expression:"text"}],attrs:{placeholder:"在此给客户留言..."},domProps:{value:e.text},on:{input:function(t){t.target.composing||(e.text=t.target.value)}}}),a("el-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:e.addMsg}},[e._v("留言")])],1)])},i=[],n=(a("498a"),a("ac1f"),a("5319"),a("caad"),a("fb6a"),{props:{id:String},data:function(){return{downloadUrl:"",list:[],text:""}},mounted:function(){this.getMsgList()},methods:{getMsgList:function(){var e=this;this.$api.Leavingmessagelist({id:this.id},"POST").then((function(t){e.list=t}))},addMsg:function(){var e=this;this.text.trim()?this.$api.addLeavingmessage({message:this.text,inquiry_sheet_object_id:this.id},"POST").then((function(t){e.text="",e.getMsgList()})):this.$message.error("请输入留言信息")},handlePreview:function(e){var t=this;if(e){var a=e.substring(e.lastIndexOf(".")+1),s=["pdf","jpeg","jpg","png","txt"],i=["docx","doc","xls","xlsx","xlsm","ppt","pptx"];e=e.replace(/http:/,"https:"),this.downloadUrl=e,i.includes(a)?this.downloadUrl="https://view.officeapps.live.com/op/view.aspx?src="+encodeURIComponent(e):s.includes(a)?this.downloadUrl=e:(this.downloadUrl=e,this.$message.info("文件格式不支持预览，ssss下载后查看")),setTimeout((function(){t.$refs.a_click.click()}),100)}},downloadFile:function(e){var t=e.slice(e.lastIndexOf(",")+1),a=e.slice(0,e.lastIndexOf(",")),s=document.createElement("a");s.href=t,s.download=a,document.body.appendChild(s),s.click()}}}),l=n,o=(a("cab5"),a("2877")),r=Object(o["a"])(l,s,i,!1,null,"12af1877",null);t["a"]=r.exports},4901:function(e,t,a){"use strict";a("e62f")},"498a":function(e,t,a){"use strict";var s=a("23e7"),i=a("58a8").trim,n=a("c8d2");s({target:"String",proto:!0,forced:n("trim")},{trim:function(){return i(this)}})},8903:function(e,t,a){},c8d2:function(e,t,a){var s=a("5e77").PROPER,i=a("d039"),n=a("5899"),l="​᠎";e.exports=function(e){return i((function(){return!!n[e]()||l[e]()!==l||s&&n[e].name!==e}))}},cab5:function(e,t,a){"use strict";a("8903")},e62f:function(e,t,a){}}]);