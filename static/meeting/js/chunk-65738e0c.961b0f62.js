(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-65738e0c"],{acd6:function(t,e,i){"use strict";var s=i("4ff3"),o=i.n(s),a=i("f121");const n=a["b"];e["a"]=function(t,e,i){return new Promise((function(s,a){const r=()=>{"/Template/GetTemplate"==t?o()({method:"post",url:n+t,data:e,headers:{"Content-Type":"application/json;charset=utf-8"}}).then(t=>{let s=document.createElement("a"),o=t.data.path.substring(t.data.path.lastIndexOf("."));fetch(t.data.path).then(t=>t.blob()).then(t=>{s.href=URL.createObjectURL(t),console.log(s.href),5==e.type||e.type,s.download=i+o,document.body.appendChild(s),s.click()})}):o()({method:"post",url:n+t,data:e,responseType:"blob",headers:{"Content-Type":"application/json;charset=utf-8"}}).then(s=>{console.log(s);let o=s.data;const a=new FileReader;a.readAsDataURL(o),a.onload=s=>{let o=document.createElement("a");o.style.display="none","/quotation/exportexcel"==t||"/SettlementSheet/ExportExcel1"==t||"/orderform/exportexcel"==t||"/Quotation/ExportExcel"==t?o.download=i+".xls":"/Template/GetTemplate"==t?5==e.type||6==e.type?o.download=i+".docx":o.download=i+".xls":"/Reporting/GetExcel"==t&&(o.download=i+".xls"),o.href=s.target.result;document.body;document.body.appendChild(o),o.click(),document.body.removeChild(o)}})};r()}))}},ada3:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"orderInfo"},[e("a",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"d_click",attrs:{href:t.downloadUrl,target:"_blank",download:""}}),e("div",{staticClass:"title"},[t._v(" 我的订单 - "),t.info?[t._v(" "+t._s(t.info.num)+" ")]:t._e()],2),t.info?e("div",{staticClass:"content"},["0020-1"===this.info.status?e("div",{staticClass:"tips"},[e("p",[t._v("订单状态：订单执行中")]),e("p",[t._v("会议进行中，请实时上传结算凭证文件！")]),e("p",[e("el-button",{attrs:{type:"primary"},on:{click:t.settlement}},[t._v(" "+t._s(t.info.settlement_sheet_status===t.settlement_sheet_status_draft?"提交结算单(草稿)":"提交结算单")+" ")])],1)]):t._e(),"0020-3"===this.info.status?e("div",{staticClass:"tips"},[e("p",[t._v("订单状态：已创建待执行")]),e("p",[t._v(" 请查看以下订单详情，如果客户需要使用会议室等场地，请为客户预留档期。 ")]),e("p",{staticClass:"special"},[e("span",[t._v("如果您遇到特殊情况需要取消订单，可以点击")]),e("el-link",{staticClass:"special_link",attrs:{name:"cancel",type:"primary"},on:{click:t.cancelorderform}},[t._v("取消订单")]),e("span",[t._v("并说明原委，我们将同时为您发送短信和邮件向客户致歉。")])],1)]):"0020-2"===this.info.status?e("div",{staticClass:"tips"},[e("p",[t._v("订单状态：已取消")]),e("p",[t._v(" "+t._s(t.info.contacts)+" - "+t._s(t.info.company_name)+" - 取消了订单 ("+t._s(t.info.activity_name)+") ")])]):t._e(),"0020-4"===this.info.status?e("div",{staticClass:"tips"},[e("p",[t._v("订单状态：已执行待结算")]),e("p",[t._v(" 会议服务商服务已经结束，请向客户提交结算单。结算单被确认后，您可以快递发票和结算单，以便客户付款。 ")]),e("p",[e("el-button",{attrs:{type:"primary"},on:{click:t.settlement}},[t._v(" "+t._s(t.info.settlement_sheet_status===t.settlement_sheet_status_draft?"提交结算单(草稿)":"提交结算单")+" ")])],1)]):"0020-5"===this.info.status?e("div",{staticClass:"tips"},[e("p",[t._v("订单状态：待确认结算单")]),e("p",{staticClass:"special"},[e("span",[t._v("已提交结算单，正在等待客户确认。 ")]),e("span",[t._v("审批环节："+t._s(t.info.approval_phase)+"， ")]),e("span",[t._v("审批人："+t._s(t.info.approval_people)+" ")])]),e("p",[e("el-button",{attrs:{type:"primary"},on:{click:t.settlement}},[t._v("查看结算单")])],1)]):"0020-6"===this.info.status?e("div",{staticClass:"tips"},[e("p",[t._v("订单状态：已确认结算单")]),e("p",[t._v("客户确认了您的结算单，您可以与客户沟通发票、付款的事宜。")])]):"0020-7"===this.info.status?e("div",{staticClass:"tips"},[e("p",[t._v("订单状态：客户驳回结算单")]),e("p",[t._v("客户对结算单有异议，请查看、修改后重新移交结算单。")]),this.info.orderform_settlement_customer_objection?e("p",[t._v(" 客户异议： "),e("el-button",{staticStyle:{"font-size":"16px"},attrs:{type:"text"},on:{click:function(e){t.objectionVisible=!0}}},[t._v(" 查看异议 ")])],1):t._e(),e("p",[e("el-button",{attrs:{type:"primary"},on:{click:t.settlement}},[t._v("提交结算单")])],1)]):"0020-8"===this.info.status?e("div",{staticClass:"tips"},[e("p",[t._v("订单状态：要求补充结算单材料")]),e("p",[t._v("客户对结算单有异议，请查看、修改后重新移交结算单。")]),this.info.orderform_settlement_customer_objection?e("div",[t._v(" 客户异议： "),e("el-button",{staticStyle:{"font-size":"16px"},attrs:{type:"text"},on:{click:function(e){t.objectionVisible=!0}}},[t._v(" 查看异议 ")])],1):t._e(),e("p",[e("el-button",{attrs:{type:"primary"},on:{click:t.settlement}},[t._v("提交结算单")])],1)]):t._e(),e("div",{staticClass:"diameter"},[e("el-collapse",{attrs:{accordion:""}},t._l(t.select,(function(i,s){return e("el-collapse-item",{key:s},[e("template",{slot:"title"},[t._v(" 第"+t._s(s+1)+"次结算记录： "),i.showDetail?t._e():e("span",{on:{click:function(t){i.showDetail=!i.showDetail}}},[e("i",{staticClass:"header-icon el-icon-caret-top"}),t._v(" 展开 ")]),i.showDetail?e("span",{on:{click:function(t){i.showDetail=!i.showDetail}}},[e("i",{staticClass:"header-icon el-icon-caret-bottom"}),t._v(" 收起 ")]):t._e()]),t._l(i.data,(function(i,s){return e("div",{key:s,staticStyle:{margin:"10px 0","border-bottom":"1px solid #ccc"}},[e("p",[t._v(t._s(i.date))]),e("p",[t._v(t._s(i.username)+" ( "+t._s(i.company_name)+" )")]),e("p",[t._v(t._s(i.state))]),e("div",{staticClass:"objectionDetailStyle",domProps:{innerHTML:t._s(i.message)},on:{click:function(e){return t.getImg(e)}}}),t._l(i.array,(function(i,s){return e("div",{key:s,staticClass:"flex_row"},[e("p",[t._v(t._s(i.name)+":")]),e("p",t._l(i.value,(function(i,s){return e("span",{key:s,staticClass:"filename",on:{click:function(e){return t.handlePreview(i)}}},[t._v(" "+t._s(i.name)+" ")])})),0)])})),t._l(i.dissent,(function(i,s){return e("div",{key:s,staticClass:"flex_row"},[e("p",[t._v(t._s(i.name)+":")]),e("p",[t._v(" "+t._s(i.value)+" ")])])}))],2)}))],2)})),1)],1),e("div",{staticClass:"info"},[e("div",{staticClass:"line"},[e("div",{staticClass:"item"},[e("div",{staticClass:"label"},[t._v("订单号")]),e("div",{staticClass:"context"},[t._v(t._s(t.info.num))])]),e("div",{staticClass:"item"},[e("div",{staticClass:"label"},[t._v("联系人")]),e("div",{staticClass:"context"},[t._v(t._s(t.info.contacts))])])]),e("div",{staticClass:"line"},[e("div",{staticClass:"item"},[e("div",{staticClass:"label"},[t._v("下单时间")]),e("div",{staticClass:"context"},[t._v(t._s(t._f("date_ex")(t.info.submit_time)))])]),e("div",{staticClass:"item"},[e("div",{staticClass:"label"},[t._v("联系方式")]),e("div",{staticClass:"context"},[t._v(" "+t._s(t.info.customer_service_telephone_numbers)+" ")])])]),e("div",{staticClass:"line"},[e("div",{staticClass:"item"},[e("div",{staticClass:"label"},[t._v("活动名称")]),e("div",{staticClass:"context"},[t._v(t._s(t.info.activity_name))])]),e("div",{staticClass:"item"},[e("div",{staticClass:"label"},[t._v("客户名称")]),e("div",{staticClass:"context"},[t._v(t._s(t.info.company_name))])])]),e("div",{staticClass:"line"},[e("div",{staticClass:"item"},[e("div",{staticClass:"label"},[t._v("活动日期")]),e("div",{staticClass:"context"},[t._v(t._s(t.info.activity_date))])]),e("div",{staticClass:"item"},[e("div",{staticClass:"label"},[t._v("报价日期")]),e("div",{staticClass:"context"},[t._v(t._s(t._f("date_ex")(t.info.offer_data)))])])]),e("div",{staticClass:"line"},[e("div",{staticClass:"item"},[e("div",{staticClass:"label"},[t._v("采购酒店")]),e("div",{staticClass:"context"},[t._v(t._s(t.info.hotel_name))])])])]),1==t.whetherShow.kp_notice_file||1==t.whetherShow.invoice_file||1==t.whetherShow.cvent_date?e("div",{staticClass:"info"},[e("div",{staticClass:"line"},[1==t.whetherShow.kp_notice_file?e("div",{staticClass:"item"},[e("div",{staticClass:"label"},[t._v("开票通知文件")]),e("div",{staticClass:"context",staticStyle:{display:"flex"}},[e("ul",{staticStyle:{"margin-right":"50px"}},t._l(t.fileList.kpFile,(function(i,s){return e("li",{key:s,staticStyle:{margin:"10px 0"}},[e("span",{staticStyle:{color:"#409eff",cursor:"pointer"},on:{click:function(e){return t.downloadFile(i)}}},[t._v(" "+t._s(i.filename)+" ")]),e("span",[t._v(" 上传时间： "+t._s(i.create_time)+" ")])])})),0),e("el-upload",{ref:"upload",attrs:{action:t.UploadFilesUrl,"on-success":t.uploadFile,"on-preview":t.downloadFile,"file-list":t.fileList.kpFile,"show-file-list":!1,multiple:!0}},[e("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[t._v("选择文件")])],1)],1)]):t._e()]),e("div",{staticClass:"line"},[1==t.whetherShow.invoice_file?e("div",{staticClass:"item"},[e("div",{staticClass:"label"},[t._v("发票附件")]),e("div",{staticClass:"context"},[e("ul",t._l(t.fileList.fpFile,(function(i,s){return e("li",{key:s},[e("span",{staticStyle:{color:"#409eff",cursor:"pointer"},on:{click:function(e){return t.downloadFile(i)}}},[t._v(" "+t._s(i.filename)+" ")]),e("span",[t._v(" 上传时间： "+t._s(i.create_time)+" ")])])})),0)])]):t._e(),1==t.whetherShow.cvent_date?e("div",{staticClass:"item"},[e("div",{staticClass:"label"},[t._v("Cevent 上传完成日期")]),e("div",{staticClass:"context",staticStyle:{display:"flex","justify-content":"space-between"}},[e("span",{staticStyle:{"line-height":"30px"}},[t._v(" "+t._s(t.fileList.cventDate)+" ")]),e("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},on:{click:function(e){t.CeventDateDialog=!0}},slot:"trigger"},[t._v("编辑")])],1)]):t._e()])]):t._e(),e("div",{staticClass:"info"},[e("div",{staticClass:"line"},[e("div",{staticClass:"item"},[e("div",{staticClass:"label"},[t._v("报价人")]),e("div",{staticClass:"context"},[t._v(t._s(t.info.bidder))])]),e("div",{staticClass:"item"},[e("div",{staticClass:"label"},[t._v("报价时间")]),e("div",{staticClass:"context"},[t._v(" "+t._s(t._f("date_ex")(t.info.offer_data))+" ")])])])]),e("div",{staticClass:"info"},[e("div",{staticClass:"line"},[e("div",{staticClass:"item"},[e("div",{staticClass:"label"},[t._v("历史附件")]),e("div",{staticClass:"context"},[e("p",[t._v("客户已通过邮件发送该订单的 “询价单” 至以下人员：")]),e("p",[t._v(t._s(t.info.mailbox))]),e("p",[e("el-button",{attrs:{type:"primary"},on:{click:t.quotedprice}},[t._v("最终报价单")]),"0020-6"===this.info.status?e("el-button",{attrs:{type:"primary"},on:{click:t.settlement}},[t._v("结算单 ")]):t._e()],1)])])])]),e("div",{staticClass:"info"},[e("div",{staticClass:"line"},[e("div",{staticClass:"item"},[e("div",{staticClass:"label need",staticStyle:{width:"100%"}},[t._v(" 客户需求 "),e("div",{staticClass:"excel"},[e("a",{staticStyle:{cursor:"pointer"},on:{click:t.excelexport}},[t._v("下载excel")])])])])]),e("div",{staticClass:"line"},[e("div",{staticClass:"item"},[e("div",{staticClass:"label"},[t._v("客房需求")]),e("div",{staticClass:"context"},[t._l(t.info.quoted_price_room,(function(i){return e("div",{key:i.id,staticClass:"hyxq_item"},[e("div",{staticClass:"date"},[t._v(" 日期："+t._s(t._f("date_day")(i.date))+" 客房价格 ")]),t._l(i.room_list,(function(i){return e("div",{key:i.id,staticClass:"c_item"},[t._v(" "+t._s(i.roomtypename)+" "+t._s(i.roomcount)+"间 "),e("span",{staticClass:"quotedprice"},[t._v("报价：￥"+t._s(i.unitprice.toFixed(2))+"*"+t._s(i.provide_count)+"间 ￥"+t._s(i.totalprice.toFixed(2)))]),e("p",[t._v("报价备注："+t._s(i.remarks))])])}))],2)})),e("br"),e("br"),t._v(" 客房报价总备注："+t._s(t.info.room_remarks)+" "),e("br"),t._v(" 客房报价小计："),e("span",{staticClass:"quotedprice"},[t._v("￥"+t._s(this.allMoney.toFixed(2)))])],2)]),e("div",{staticClass:"item"},[e("div",{staticClass:"label"},[t._v("会议需求")]),e("div",{staticClass:"context"},[t._l(t.info.quoted_price_conference,(function(i){return e("div",{key:i.id,staticClass:"hyxq_item"},[e("div",{staticClass:"date"},[t._v("日期："+t._s(t._f("date_day")(i.date)))]),t._l(i.conference_list,(function(s){return e("div",{key:s.id,staticClass:"c_item"},[1==s.type?e("div",[t._v(" "+t._s(s.item+s.order_name+s.typename)+" "+t._s(s.starttime)+"-"+t._s(s.endtime)+" "+t._s(s.roomsetuptypename)+" "+t._s(s.attendees)+" 人，会场面积范围："+t._s(s.min_area)+"~"+t._s(s.max_area)+" sqm "),e("div",{staticClass:"quotedprice"},[t._v(" 报价：￥"+t._s(s.price.toFixed(2))+" ")]),e("div",[t._v("报价备注:"+t._s(s.comments))])]):2==s.type?e("div",[t._v(" "+t._s(s.related_information)+" "+t._s(t._f("date_day")(i.date))+" "+t._s(s.starttime)+"~ "+t._s(t._f("date_day")(i.date))+" "+t._s(s.endtime)+" "),e("div",{staticClass:"quotedprice"},[t._v(" 报价：￥"+t._s(s.price.toFixed(2))+" ")])]):3==s.type?e("div",[e("p",[t._v(" "+t._s(s.item+s.order_name+s.typename)+": "+t._s(s.equipment)+" ")]),e("p",[e("span",{staticClass:"quotedprice"},[t._v("报价：￥"+t._s(s.price.toFixed(2))+" ")])]),e("p",[t._v("报价备注："+t._s(s.comments))])]):4==s.type?e("div",[e("p",[t._v(" "+t._s(s.item+s.order_name+s.quoted_name)+": "+t._s(s.equipment)+" ")]),e("p",[e("span",{staticClass:"quotedprice"},[t._v("报价：￥"+t._s(s.price.toFixed(2))+" ")])]),e("p",[t._v("报价备注："+t._s(s.comments))])]):t._e()])}))],2)})),e("br"),e("br"),t._v(" 会场报价总备注："+t._s(t.info.conference_remarks)+" "),e("div",{staticClass:"quotedpricesum"},[t._v(" 会场报价小计"),e("span",{staticClass:"quotedprice"},[t._v("￥"+t._s((this.EquipmentMoney+this.meetingMoney).toFixed(2)))])])],2)])]),e("div",{staticClass:"line"},[e("div",{staticClass:"item"},[e("div",{staticClass:"label"},[t._v("酒店内用餐需求")]),e("div",{staticClass:"context"},[t._l(t.info.quoted_price_food,(function(i){return e("div",{key:i.id,staticClass:"hyxq_item"},[e("div",{staticClass:"date"},[t._v("日期："+t._s(t._f("date_day")(i.date)))]),t._l(i.food_list,(function(i){return e("div",{key:i.id,staticClass:"c_item"},[e("span",[t._v(t._s(i.foodtypename))]),t._v(" "+t._s(i.usetype?`[${i.usetype}]`:"")+" "+t._s(i.personcount)+" 人 "),e("p",{staticClass:"quotedprice"},[t._v(" 报价：￥"+t._s(i.price.toFixed(2))+"*"+t._s(i.personcount)+" 人 ￥"+t._s((i.price*i.personcount).toFixed(2))+" 备注："+t._s(i.offer_remarks)+" ")])])}))],2)})),e("br"),e("br"),e("div",{staticClass:"quotedpricesum"},[t._v(" 餐饮报价小计："),e("span",{staticClass:"quotedprice"},[t._v("￥"+t._s(this.repastAllMoney.toFixed(2)))])])],2)]),e("div",{staticClass:"item"},[e("div",{staticClass:"label"},[t._v("酒店外用餐需求")]),e("div",{staticClass:"context"},[t._l(t.info.quoted_price_outside_food,(function(i){return e("div",{key:i.id,staticClass:"hyxq_item"},[e("div",{staticClass:"date"},[t._v("日期："+t._s(t._f("date_day")(i.date)))]),t._l(i.food_list,(function(i){return e("div",{key:i.id,staticClass:"c_item"},[e("span",[t._v(t._s(i.foodtypename))]),t._v(" "+t._s(i.usetype?`[${i.usetype}]`:"")+" "+t._s(i.personcount)+" 人 "),e("p",{staticClass:"quotedprice"},[t._v(" 报价：￥"+t._s(i.price.toFixed(2))+"*"+t._s(i.personcount)+" 人 ￥"+t._s((i.price*i.personcount).toFixed(2))+" 备注："+t._s(i.offer_remarks)+" ")])])}))],2)})),e("br"),e("br"),e("div",{staticClass:"quotedpricesum"},[t._v(" 餐饮报价小计："),e("span",{staticClass:"quotedprice"},[t._v("￥"+t._s(this.otherFoodAllMoney.toFixed(2)))])])],2)])]),e("div",{staticClass:"line"},[e("div",{staticClass:"item"},[e("div",{staticClass:"label"},[t._v("交通需求")]),e("div",{staticClass:"context"},[e("p",{staticClass:"date"},[t._v("大交通")]),t._l(t.info.quoted_price_transportation,(function(i){return e("div",{key:i.id,staticClass:"hyxq_item"},[e("p",{staticClass:"date"},[t._v("日期： "+t._s(t._f("date_day")(i.date)))]),t._l(i.transportation_list,(function(i){return e("div",{key:i.id,staticClass:"c_item"},[t._v(" "+t._s(i.origincity)+" - "+t._s(i.destinationcity)+" "+t._s(i.transtypename)+" "+t._s(i.seatclassesname)+" "+t._s(i.passengercount)+"人 "),e("p",{staticClass:"quotedprice"},[t._v(" 报价：￥"+t._s(i.unitprice.toFixed(2))+"*"+t._s(i.passengercount)+" 人 ￥"+t._s((i.unitprice*i.passengercount).toFixed(2))+" 备注："+t._s(i.offerremarks)+" ")]),e("p",[t._v("报价备注："+t._s(i.requirement))])])}))],2)})),e("br"),t._v(" 大交通报价总备注："+t._s(t.info.transportation_remarks)+" "),e("br"),e("br"),e("div",{staticClass:"date"},[t._v("地面交通")]),t._l(t.info.quoted_price_car,(function(i){return e("div",{key:i.id,staticClass:"hyxq_item"},[e("div",{staticClass:"date"},[t._v("日期："+t._s(t._f("date_day")(i.date)))]),t._l(i.car_list,(function(i){return e("div",{key:i.id,staticClass:"c_item"},[e("p",[e("span",[t._v(t._s(i.purposename)+" ")]),t._v(" "+t._s(i.vehicletypename)+" "+t._s(i.carcount)+"辆 "+t._s(i.vehiclecount)+"人 ")]),i.city?e("p",[e("span",[t._v("用车城市")]),t._v(" "+t._s(i.city))]):t._e(),e("p",{staticClass:"quotedprice"},[t._v(" 报价：￥"+t._s(i.price.toFixed(2))+"*"+t._s(i.carcount)+"辆 ￥"+t._s((i.price*i.carcount).toFixed(2))+" 备注："+t._s(i.offer_remarks)+" ")])])}))],2)})),e("br"),t._v(" 地面交通报价总备注："+t._s(t.info.car_remarks)+" "),e("br"),e("br"),e("div",{staticClass:"quotedpricesum"},[t._v(" 交通报价小计"),e("span",{staticClass:"quotedprice"},[t._v("￥"+t._s((this.IntercityTransportationAllMoney+this.CityAllMoney).toFixed(2)))])])],2)]),e("div",{staticClass:"item"},[e("div",{staticClass:"label"},[t._v("其他服务")]),e("div",{staticClass:"context"},[t._l(t.info.quoted_price_other,(function(i){return e("div",{key:i.id,staticClass:"hyxq_item",staticStyle:{margin:"0"}},[e("div",{staticClass:"c_item",staticStyle:{"line-height":"25px"}},[e("span",[t._v(t._s(i.servicetypename))]),t._v(" 数量"+t._s(i.demandparticipatecount)+" "),e("p",{staticClass:"quotedprice"},[t._v(" 报价：￥"+t._s(i.price.toFixed(2))+" * "+t._s(i.offerparticipatecount)+" ￥"+t._s((i.price*i.offerparticipatecount*i.offerservicedaycount).toFixed(2))+" 备注："+t._s(i.offerremarks)+" ")]),e("p",[t._v("需求备注："+t._s(i.describe))]),e("p",[t._v("报价备注："+t._s(i.offer_remarks))]),e("br")])])})),e("br"),t._v(" 其他需求报价总备注："+t._s(t.info.other_remarks)+" "),e("br"),e("br"),e("div",{staticClass:"quotedpricesum"},[t._v(" 其他需求报价小计"),e("span",{staticClass:"quotedprice"},[t._v("￥"+t._s(this.otherAllMoney.toFixed(2)))])])],2)])]),e("div",{staticClass:"line"},[e("div",{staticClass:"item"},[e("div",{staticClass:"label"},[t._v("服务费和增值税")]),e("div",{staticClass:"context"},[e("p",{staticClass:"bold"},[t._v("服务费")]),e("p",[t._v(" 非直采服务费 "),e("span",{staticClass:"quotedprice"},[t._v("￥"+t._s(this.serveAllMoney.toFixed(2)))])]),e("p",[t._v(" 直采服务费 "),e("span",{staticClass:"quotedprice"},[t._v("￥"+t._s(this.AdvancesMoney.toFixed(2)))])]),e("br"),e("p",{staticClass:"bold"},[t._v("税费")]),e("p",[e("span",{staticClass:"quotedprice"},[t._v("￥"+t._s(this.Taxes.toFixed(2)))])])])])]),e("div",{staticClass:"line"},[e("div",{staticClass:"item"},[e("div",{staticClass:"label"},[t._v("总报价")]),e("div",{staticClass:"context"},[e("span",{staticClass:"quotedprice"},[t._v("￥"+t._s(t.totalPrices.toFixed(2)))])])])])]),e("el-dialog",{attrs:{title:"添加项目",visible:t.addProjectStatus,"before-close":t=>{this.itemData=null,t()},width:"700px"},on:{"update:visible":function(e){t.addProjectStatus=e}}},[t.addProjectStatus?e("projectAdded",{attrs:{"item-data":t.itemData},on:{onColse:t.projectSave}}):t._e()],1),e("el-dialog",{attrs:{title:"编辑 Cevent 上传完成日期",visible:t.CeventDateDialog,width:"700px"},on:{"update:visible":function(e){t.CeventDateDialog=e}}},[e("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期时间"},model:{value:t.fileList.cventDate,callback:function(e){t.$set(t.fileList,"cventDate",e)},expression:"fileList.cventDate"}}),e("div",{staticStyle:{"margin-top":"50px","text-align":"center"}},[e("el-button",{on:{click:function(e){t.CeventDateDialog=!1}}},[t._v("取消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.saveCeventDate}},[t._v("保存")])],1)],1),e("el-dialog",{attrs:{title:"审批意见",visible:t.objectionVisible,"close-on-click-modal":!1,width:"70%",center:""},on:{"update:visible":function(e){t.objectionVisible=e},open:t.GetSettlementObjection}},[e("div",[e("p",[t._v(t._s(t.objectionDetail.date))]),e("p",[t._v(" "+t._s(t.objectionDetail.username)+" （"+t._s(t.objectionDetail.company_name)+"） ")]),e("p",{style:"color:"+("审核不通过"==t.objectionDetail.state?"red":"")},[t._v(" "+t._s(t.objectionDetail.state)+" ")]),e("p",{staticStyle:{"margin-top":"20px"}},[t._v("其他异议：")]),e("div",{staticClass:"objectionDetailStyle",domProps:{innerHTML:t._s(this.info.orderform_settlement_customer_objection)},on:{click:function(e){return t.getImg(e)}}})]),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.objectionVisible=!1}}},[t._v("关 闭")])],1)])],1):t._e()])},o=[],a=i("97aa"),n=i("cf45"),r=(i("df68"),i("f121")),c=i("acd6"),l={name:"OrderInfo",components:{projectAdded:a["a"]},data(){return{downloadUrl:"",fileList:{kpFile:[],fpFile:[],cventDate:""},objectionDetail:{username:"",company_name:"",date:"",message:"",state:""},objectionVisible:!1,select:[],UploadFilesUrl:r["b"]+"/MeetingMa/UploadFiles",uploadList:{},whetherShow:{cvent_date:0,invoice_file:0,kp_notice_file:0},info:null,addProjectStatus:!1,CeventDateDialog:!1,itemData:null,settlement_sheet_status_draft:"0029-1",excelAddress:"",totalPrices:""}},computed:{dayMoney:()=>function(t){let e=0;return t.forEach(t=>{e+=Number(t.provide_count)*this.positiveFloatSix(t.unitprice)}),this.positiveFloatSix(e)},allMoney:function(){let t=0;return this.info.quoted_price_room&&this.info.quoted_price_room.length>0&&this.info.quoted_price_room.forEach(e=>{t+=this.positiveFloatSix(this.dayMoney(e.room_list))}),this.positiveFloatSix(t)},meetingDayMoney:()=>function(t,e){let i=0;return t.forEach(t=>{i+=this.positiveFloatSix(t.price)}),this.positiveFloatSix(i)},meetingMoney:function(){let t=0;return this.info.quoted_price_conference&&this.info.quoted_price_conference.length>0&&this.info.quoted_price_conference.forEach(e=>{let i=e.conference_list.filter(t=>3!=t.type);t+=this.meetingDayMoney(i)}),this.positiveFloatSix(t)},EquipmentMoney:function(){let t=0;return this.info.quoted_price_conference&&this.info.quoted_price_conference.length>0&&this.info.quoted_price_conference.forEach(e=>{let i=e.conference_list.filter(t=>3==t.type);t+=this.meetingDayMoney(i)}),this.positiveFloatSix(t)},meetingAllMoney:function(){let t=0;return this.info.quoted_price_conference&&this.info.quoted_price_conference.length>0&&this.info.quoted_price_conference.forEach(e=>{t+=this.meetingDayMoney(e.conference_list)}),this.positiveFloatSix(t)},repastDayMoney:()=>function(t){let e=0;return t.forEach(t=>{e+=this.positiveInteger(t.personcount)*this.positiveFloatSix(t.price)}),this.positiveFloatSix(e)},repastAllMoney:function(){let t=0;return this.info.quoted_price_food&&this.info.quoted_price_food.length>0&&this.info.quoted_price_food.forEach(e=>{t+=this.repastDayMoney(e.food_list)}),this.positiveFloatSix(t)},otherFoodDayMoney:()=>function(t){let e=0;return t.forEach(t=>{e+=this.positiveInteger(t.personcount)*this.positiveFloatSix(t.price)}),this.positiveFloatSix(e)},otherFoodAllMoney:function(){let t=0;return this.info.quoted_price_outside_food&&this.info.quoted_price_outside_food.length>0&&this.info.quoted_price_outside_food.forEach(e=>{t+=this.otherFoodDayMoney(e.food_list)}),this.positiveFloatSix(t)},IntercityTransportationDayMoney:()=>function(t){let e=0;return t.forEach(t=>{e+=this.positiveInteger(t.passengercount)*this.positiveFloatSix(t.unitprice)}),this.positiveFloatSix(e)},IntercityTransportationAllMoney:function(){let t=0;return this.info.quoted_price_transportation&&this.info.quoted_price_transportation.length>0&&this.info.quoted_price_transportation.forEach(e=>{t+=this.IntercityTransportationDayMoney(e.transportation_list)}),this.positiveFloatSix(t)},CityDayMoney:()=>function(t){let e=0;return t.forEach(t=>{e+=this.positiveInteger(t.carcount)*this.positiveFloatSix(t.price)}),this.positiveFloatSix(e)},CityAllMoney:function(){let t=0;return this.info.quoted_price_car&&this.info.quoted_price_car.length>0&&this.info.quoted_price_car.forEach(e=>{t+=this.CityDayMoney(e.car_list)}),this.positiveFloatSix(t)},otherAllMoney:function(){let t=0;return this.info.quoted_price_other&&this.info.quoted_price_other.length>0&&this.info.quoted_price_other.forEach(e=>{t+=this.positiveInteger(e.offerparticipatecount)*this.positiveInteger(e.offerservicedaycount)*this.positiveFloatSix(e.price)}),this.positiveFloatSix(t)},money:function(){return this.info.total_price=Object(n["o"])(this.allMoney)+Object(n["o"])(this.meetingAllMoney)+Object(n["o"])(this.repastAllMoney)+Object(n["o"])(this.otherFoodAllMoney)+Object(n["o"])(this.IntercityTransportationAllMoney)+Object(n["o"])(this.CityAllMoney)+Object(n["o"])(this.otherAllMoney),Object(n["o"])(this.info.total_price)},TravelAgencyMoney:function(){return this.positiveFloatSix(this.info.travelagency_payment_money*this.info.travelagency_payment_proportion/100)},AdvancesMoney:function(){return Object(n["o"])(this.positiveFloatSix(this.info.advance_amount)*(this.positiveFloatSix(this.info.advance_proportion)/100))},OutsideHotelMoney:function(){return this.positiveFloatSix(this.info.off_hotel_expenses*this.info.off_hotel_proportion/100)},serviceAllMoney:function(){return Object(n["o"])(this.TravelAgencyMoney+this.AdvancesMoney+this.OutsideHotelMoney)},serveAllMoney:function(){let t=0;if(0==this.info.event_info_configure.service_fee_calculation_method)t=this.allMoney.toFixed(2)*(this.info.event_info_configure.room_inquiry_service_taxrate/100)+this.meetingAllMoney.toFixed(2)*(this.info.event_info_configure.conference_inquiry_service_taxrate/100)+this.repastAllMoney.toFixed(2)*(this.info.event_info_configure.hotel_food_inquiry_service_taxrate/100)+this.otherFoodAllMoney.toFixed(2)*(this.info.event_info_configure.others_food_inquiry_service_taxrate/100)+this.IntercityTransportationAllMoney.toFixed(2)*(this.info.event_info_configure.transportation_inquiry_service_taxrate/100)+this.CityAllMoney.toFixed(2)*(this.info.event_info_configure.car_inquiry_service_taxrate/100),this.offline_quoted_price_others.forEach(e=>{t+=e.offerparticipatecount*e.price*e.service_taxrate/100});else if(1==this.info.event_info_configure.service_fee_calculation_method){let e=0;e+=this.info.event_info_configure.room_inquiry_isnotservice?this.allMoney:0,e+=this.info.event_info_configure.conference_inquiry_isnotservice?this.meetingAllMoney:0,e+=this.info.event_info_configure.hotel_food_inquiry_isnotservice?this.repastAllMoney:0,e+=this.info.event_info_configure.others_food_inquiry_isnotservice?this.otherFoodAllMoney:0,e+=this.info.event_info_configure.transportation_inquiry_isnotservice?this.IntercityTransportationAllMoney:0,e+=this.info.event_info_configure.car_inquiry_isnotservice?this.CityAllMoney:0,this.info.quoted_price_other.forEach(t=>{e+=t.isnotservice?t.offerparticipatecount*t.price:0}),this.severEveryMoneyList=[],this.info.event_info_ladder_taxrates.forEach((i,s)=>{e<=i.ladder_min||(e>=i.ladder_min&&e<=i.ladder_max?(t+=(e-i.ladder_min+(0==s?0:1))*i.ladder_taxrate/100,this.severEveryMoneyList.push(Object(n["o"])((e-i.ladder_min+(0==s?0:1))*i.ladder_taxrate/100*this.info.fzc_service/100))):e>i.ladder_max&&this.info.event_info_ladder_taxrates[s+1]?(this.severEveryMoneyList.push(Object(n["o"])((i.ladder_max-i.ladder_min+(0==s?0:1))*i.ladder_taxrate/100*this.info.fzc_service/100)),t+=(i.ladder_max-i.ladder_min+(0==s?0:1))*i.ladder_taxrate/100):e>=i.ladder_max&&!this.info.event_info_ladder_taxrates[s+1]&&(this.severEveryMoneyList.push(Object(n["o"])((e-i.ladder_min+(0==s?0:1))*i.ladder_taxrate/100*this.info.fzc_service/100)),t+=(e-i.ladder_min+(0==s?0:1))*i.ladder_taxrate/100))})}else if(2==this.info.event_info_configure.service_fee_calculation_method){let i=0;i+=this.info.event_info_configure.room_inquiry_isnotservice?this.allMoney:0,i+=this.info.event_info_configure.conference_inquiry_isnotservice?this.meetingAllMoney:0,i+=this.info.event_info_configure.hotel_food_inquiry_isnotservice?this.repastAllMoney:0,i+=this.info.event_info_configure.others_food_inquiry_isnotservice?this.otherFoodAllMoney:0,i+=this.info.event_info_configure.transportation_inquiry_isnotservice?this.IntercityTransportationAllMoney:0,i+=this.info.event_info_configure.car_inquiry_isnotservice?this.CityAllMoney:0,this.info.quoted_price_other.forEach(t=>{i+=t.isnotservice?t.offerparticipatecount*t.price:0}),this.serviceTotalMoney=i;for(var e=0;e<this.info.event_info_grade_taxrates.length;e++)if(e==this.info.event_info_grade_taxrates.length-1||i>=this.info.event_info_grade_taxrates[e].grade_money&&i<this.info.event_info_grade_taxrates[e+1].grade_money){t=i*this.info.event_info_grade_taxrates[e].grade_taxrate/100,this.grade_taxrate=this.info.event_info_grade_taxrates[e].grade_taxrate;break}}return t*=this.info.fzc_service/100,1==this.info.event_info_configure.minimum_service_fee&&t<this.info.event_info_configure.minimum_service_fee_money&&(t=this.info.event_info_configure.minimum_service_fee_money),this.info.feizhicai_service=t,t},Taxes:function(){let t=0;return"VAT"==this.info.taxtype?(t=this.info.event_info_configure.fzc_service_fee_money?(this.money+this.serveAllMoney)*this.positiveFloatSix(this.info.taxrate)/100:(this.money+this.serveAllMoney-this.info.feizhicai_service)*this.positiveFloatSix(this.info.taxrate)/100,t):0*(this.money+this.serveAllMoney)},OrderPrice:function(){return this.money+this.serveAllMoney+this.AdvancesMoney+this.Taxes}},methods:{positiveInteger:n["q"],positiveFloat:n["m"],positiveFloatSix:n["o"],excelExport:c["a"],formatDate:n["d"],WhetherShow(){this.$api.WhetherShow({OrderID:this.$route.params.id},"post").then(t=>{this.whetherShow=t})},GetSettlementObjection(){this.$api.GetSettlementObjection({OrderFromID:this.$route.params.id},"POST").then(t=>{this.objectionDetail=t})},getImg(t){console.log(t),console.log(t.target.currentSrc);let e=t.target.currentSrc;e&&this.$hevueImgPreview(e)},handlePreview(t){if(!t.value)return;let e=t.value.substring(t.value.lastIndexOf(".")+1),i=["pdf","jpeg","jpg","png","txt"],s=["docx","doc","xls","xlsx","xlsm","ppt","pptx"];t.value=t.value.replace(/http:/,"https:"),this.downloadUrl=t.value,s.includes(e)?this.downloadUrl="https://view.officeapps.live.com/op/view.aspx?src="+encodeURIComponent(t.value):i.includes(e)?this.downloadUrl=t.value:this.$message.info("文件格式不支持预览，下载后查看"),setTimeout(()=>{this.$refs.d_click.click()},100)},ApproveRecordDownloadFile(t){let e=document.createElement("a");e.href=t.value,e.download=t.name,e.target="_blank",document.body.appendChild(e),e.click()},getSelect(){this.$api.getrecord({OrderID:this.$route.params.id},"POST").then(t=>{this.select=t,this.select.forEach(t=>{this.$set(t,"showDetail",!1)})})},GetFile(){this.$api.GetFile({OrderID:this.$route.params.id,SheetID:""},"POST").then(t=>{this.fileList=t})},saveCeventDate(){this.$api.CventDateAdd({OrderID:this.$route.params.id,Datetime:this.fileList.cventDate},"POST").then(t=>{t&&(this.CeventDateDialog=!1)})},excelexport(){var t="DMC报价单"+this.info.event_info_id;this.excelExport("/Template/GetTemplate",{eventid:this.info.event_info_id,type:3,param:this.info.quoted_price_id},t)},uploadFile(t){this.uploadList=t;let e={orderid:this.$route.params.id,sheet_id:"",type:1,file_name:t.title,file_path:t.weburl};this.$api.FileAdd(e,"post").then(t=>{t&&(this.$message.success("上传成功"),this.GetFile())})},downloadFile(t){var e,i;let s=null!==(e=t.file_path)&&void 0!==e?e:t.filepath;null!==(i=t.file_name)&&void 0!==i||t.filename;if(!s)return;let o=s.substring(s.lastIndexOf(".")+1),a=["pdf","jpeg","jpg","png","txt"],n=["docx","doc","xls","xlsx","xlsm","ppt","pptx"];s=s.replace(/http:/,"https:"),this.downloadUrl=s,n.includes(o)?this.downloadUrl="https://view.officeapps.live.com/op/view.aspx?src="+encodeURIComponent(s):a.includes(o)?this.downloadUrl=s:this.$message.info("文件格式不支持预览，下载后查看"),setTimeout(()=>{this.$refs.d_click.click()},100)},project(){this.info.project_id?this.$router.push({name:"ItineraryManagement",params:{id:this.info.project_id}}):this.addProjectStatus=!0},projectSave(t){this.$api.projectsave(t,"POST").then(e=>{this.$message({message:t.id?"修改成功！":"添加成功！",type:"success"}),this.$router.push({name:"ItineraryManagement",params:{id:this.info.project_id}})})},quotedprice(){let t=this.$router.resolve({name:"DMCquotedprice",params:{id:this.info.quoted_price_id,isSubmit:0}});window.open(t.href,"_blank")},settlement(){let t=this.$route.params.id,e=1;this.info.settlement_sheet_status,this.settlement_sheet_status_draft,"0020-5"!==this.info.status&&"0020-6"!==this.info.status&&"0020-8"!==this.info.status||(e=0),0==this.info.serviceprovider_or_hotel?this.$router.push({name:"settleAccounts_Hotel",params:{id:t,issubmit:e}}):this.$router.push({name:"settleAccounts",params:{id:t,issubmit:e}})},cancelorderform(){this.$prompt("请简要说明取消订单的原因","拒绝接单",{confirmButtonText:"确定",cancelButtonText:"取消",inputType:"textarea"}).then(({value:t})=>{this.$api.cancelorderform({id:this.info.orderform_id,object_id:this.info.object_id,reason:t},"POST").then(t=>{t?(this.$message({message:"订单已取消",type:"success"}),this.$router.go(0)):this.$message({message:"订单取消失败",type:"fail"})})}).catch(()=>{})},againform(){this.$api.againform({id:this.info.orderform_id,object_id:this.info.object_id},"POST").then(t=>{t?this.$message({message:"提醒成功",type:"success"}):this.$message({message:"提醒失败",type:"fail"})})}},mounted(){this.WhetherShow(),this.getSelect(),this.$api.orderInfo({id:this.$route.params.id},"POST").then(t=>{this.info=t,this.totalPrices=t.total_price,0!=this.info.event_info_configure.service_fee_ratio&&null!=this.info.fzc_service||(this.info.fzc_service=100),"0020-6"===this.info.status&&this.GetFile()})}},_=l,d=(i("fecc"),i("0b56")),p=Object(d["a"])(_,s,o,!1,null,"5dc5f15e",null);e["default"]=p.exports},bf4d:function(t,e,i){},fecc:function(t,e,i){"use strict";i("bf4d")}}]);