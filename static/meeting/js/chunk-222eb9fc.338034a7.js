(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-222eb9fc"],{"01fb":function(e,t,a){"use strict";a("04ff")},"04ff":function(e,t,a){},"0e5c":function(e,t,a){"use strict";a("d3b7");var r=a("5829"),o=a("2b0e");t["a"]=function(e){return new Promise((function(t,a){var n=[],i={},s=e.length;console.log(e.length,e);var l=function a(){return 0==e.length?t(n):String(e[0].file).IsPicture()?(e.shift(),a()):void r["a"].upload({file:e[0].file},"POST",{type:"form"}).then((function(r){console.log(r);var l=!0;if(void 0!=r&&""==r.FilePath&&""==r.OriginalFileName&&(console.log("重复了"),r=void 0,l=!1),void 0==r&&l){o["default"].prototype.$alert("网络不稳定, 文件上传失败, 请重新上传","提示",{confirmButtonText:"确定",callback:function(e){o["default"].prototype.$message({message:"上传失败的文件已标记",type:"warning"})}});var c=s-e.length;return t({tag:c,uploadImageList:n})}i=r,n.push(i),e.shift(),a()}))};l()}))}},2654:function(e,t,a){"use strict";a.d(t,"j",(function(){return o})),a.d(t,"k",(function(){return n})),a.d(t,"i",(function(){return i})),a.d(t,"h",(function(){return s})),a.d(t,"l",(function(){return l})),a.d(t,"e",(function(){return c})),a.d(t,"f",(function(){return u})),a.d(t,"b",(function(){return m})),a.d(t,"g",(function(){return d})),a.d(t,"a",(function(){return p})),a.d(t,"c",(function(){return f})),a.d(t,"d",(function(){return _}));var r=a("53ca");a("ac1f"),a("00b4"),a("d9e2"),a("a9e3"),a("d3b7"),a("159b");function o(e,t,a){var r=/^((0\d{2,3}-\d{7,8})|(1[34578]\d{9}))$/;""==t||void 0==t||null==t||r.test(t)||""==t?a():a(new Error("请输入正确的电话号码或者固话号码"))}function n(e,t,a){var r=/0\d{2}-\d{7,8}/;""==t||void 0==t||null==t||r.test(t)||""==t?a():a(new Error("请输入正确的固话（格式：区号+号码,如010-1234567）"))}function i(e,t,a){var r=/^[1][3,4,5,7,8][0-9]{9}$/;""==t||void 0==t||null==t||r.test(t)||""==t?a():a(new Error("请输入正确的电话号码"))}function s(e,t,a){var r=/^([a-zA-Z0-9]+[-_\.]?)+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/;""==t||void 0==t||null==t||r.test(t)?a():a(new Error("请输入正确的邮箱地址"))}function l(e,t,a){var r=/^(https?|ftp):\/\/([a-zA-Z0-9.-]+(:[a-zA-Z0-9.&%$-]+)*@)*((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])){3}|([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+\.(com|edu|gov|int|mil|net|org|biz|arpa|info|name|pro|aero|coop|museum|[a-zA-Z]{2}))(:[0-9]+)*(\/($|[a-zA-Z0-9.,?'\\+&%$#=~_-]+))*$/;""==t||void 0==t||null==t||r.test(t)?a():a(new Error("请输入正确的URL"))}function c(e,t,a){if(!t)return a(new Error("输入不可以为空"));setTimeout((function(){if(Number(t)){var e=/^[0-9]*[1-9][0-9]*$/,r=e.test(t);r?a():a(new Error("请输入正整数"))}else a(new Error("请输入正整数"))}),0)}function u(e,t,a){t||a(),setTimeout((function(){if(Number(t)){var e=/^[0-9]*[1-9][0-9]*$/,r=e.test(t);r?a():a(new Error("请输入正整数"))}else a(new Error("请输入正整数"))}),1e3)}function m(e,t){var a={},o=[];if(e=Array.isArray(e)?e:[],t)for(var n=0;n<e.length;n++)if(a[e[n].date]){for(var i=0;i<o.length;i++)if(e[n].date===o[i].date){o[i].settlement+=Number("object"==Object(r["a"])(e[n].settlement_total_price)?e[n].settlement_total_price.value:e[n].settlement_total_price),o[i].orgSettlement+=Number("object"==Object(r["a"])(e[n].total_price)?e[n].total_price.value:e[n].total_price),o[i].data.push(e[n]);break}}else o.push({date:e[n].date,settlement:Number("object"==Object(r["a"])(e[n].settlement_total_price)?e[n].settlement_total_price.value:e[n].settlement_total_price),orgSettlement:Number("object"==Object(r["a"])(e[n].total_price)?e[n].total_price.value:e[n].total_price),data:[e[n]]}),a[e[n].date]=e[n];else for(var s=0;s<e.length;s++)if(a[e[s].date]){for(var l=0;l<o.length;l++)if(e[s].date===o[l].date){o[l].settlement+="object"==Object(r["a"])(e[s].settlement_price)?e[s].settlement_price.value:e[s].settlement_price,o[l].orgSettlement+="object"==Object(r["a"])(e[s].price)?e[s].price.value:e[s].price,o[l].data.push(e[s]);break}}else o.push({date:e[s].date,settlement:"object"==Object(r["a"])(e[s].settlement_price)?e[s].settlement_price.value:e[s].settlement_price,orgSettlement:"object"==Object(r["a"])(e[s].price)?e[s].price.value:e[s].price,data:[e[s]]}),a[e[s].date]=e[s];return o}function d(e){var t={},a=[];e=Array.isArray(e)?e:[];for(var r=0;r<e.length;r++)if(t[e[r].checkindate]){for(var o=0;o<a.length;o++)if(e[r].checkindate===a[o].checkindate){"大床房"==e[r].roomtype?(a[o].bigBedNum=e[r].roomcount,a[o].totalNum+=e[r].roomcount):"双床房"==e[r].roomtype?(a[o].doubleBedNum=e[r].roomcount,a[o].totalNum+=e[r].roomcount):(a[o].suiteNum=e[r].roomcount,a[o].totalNum+=e[r].roomcount);break}}else e[r].bigBedNum=0,e[r].doubleBedNum=0,e[r].suiteNum=0,e[r].totalNum=0,"大床房"==e[r].roomtype?(e[r].bigBedNum=e[r].roomcount,e[r].totalNum+=e[r].roomcount):"双床房"==e[r].roomtype?(e[r].doubleBedNum=e[r].roomcount,e[r].totalNum+=e[r].roomcount):(e[r].suiteNum=e[r].roomcount,e[r].totalNum+=e[r].roomcount),a.push(e[r]),t[e[r].checkindate]=e[r];return a}function p(e){for(var t={},a=[],r=0;r<e.length;r++){var o=(e[r].build?e[r].build.price:0)+(e[r].rentalCosts?e[r].rentalCosts.price:0);if(e[r].equipment&&e[r].equipment.forEach((function(e){o+=e.price||0})),t[e[r].rentalCosts.time])for(var n=function(t){if(e[r].rentalCosts.time===a[t].time)return a[t].totalPrice+=(e[r].build?e[r].build.price:0)+(e[r].rentalCosts?e[r].rentalCosts.price:0),e[r].equipment&&e[r].equipment.forEach((function(e){a[t].totalPrice+=e.price||0})),a[t].data.push(e[r]),"break"},i=0;i<a.length;i++){var s=n(i);if("break"===s)break}else a.push({time:e[r].rentalCosts.time,totalPrice:o,data:[e[r]]}),t[e[r].rentalCosts.time]=e[r]}return a}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"time",a={},r=[];e=e||[];for(var o=0;o<e.length;o++)if(a[e[o][t]]){for(var n=0;n<r.length;n++)if(e[o][t]===r[n].time){r[n].data.push(e[o]),r[n].car.push(e[o]);break}}else r.push({time:e[o][t],car_date:e[o][t].substring(0,10),breakfast:e[o].breakfast,networks:e[o].networks,describe:e[o].describe,otherrequirements:e[o].otherrequirements,type:e[o].type,room_budget:e[o].room_budget,purpose:e[o].purpose,offer_remarks:e[o].offer_remarks,comments:e[o].comments,data:[e[o]],car:[e[o]]}),a[e[o][t]]=e[o];return r}function _(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"time",a={},r=[];e=e||[];for(var o=0;o<e.length;o++)r.push({time:e[o][t],car_date:e[o][t].substring(0,10),breakfast:e[o].breakfast,networks:e[o].networks,describe:e[o].describe,otherrequirements:e[o].otherrequirements,type:e[o].type,room_budget:e[o].room_budget,purpose:e[o].purpose,offer_remarks:e[o].offer_remarks,comments:e[o].comments,data:[e[o]],car:[e[o]]}),a[e[o][t]]=e[o];return r}},"53ca":function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0");function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}},"5c62":function(e,t,a){},"97aa":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"project-added"},[a("el-form",{ref:"ruleForm",staticStyle:{overflow:"hidden"},attrs:{"label-width":"110px",model:e.FormData,rules:e.rules}},[0!=e.userList.length?a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"项目经理",prop:"project_manager"}},[a("el-select",{attrs:{placeholder:"选择项目经理"},model:{value:e.FormData.project_manager,callback:function(t){e.$set(e.FormData,"project_manager",t)},expression:"FormData.project_manager"}},e._l(e.userList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.real_name,value:e.id}})})),1)],1)],1):e._e(),0!=e.userList.length?a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"项目专员",prop:"project_specialist"}},[a("el-select",{attrs:{placeholder:"选择项目专员"},model:{value:e.FormData.project_specialist,callback:function(t){e.$set(e.FormData,"project_specialist",t)},expression:"FormData.project_specialist"}},e._l(e.userList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.real_name,value:e.id}})})),1)],1)],1):e._e(),a("el-col",[a("el-form-item",{attrs:{label:"订单号",prop:"event_orderform_num"}},[e.FormData.event_orderform_num?a("p",{staticClass:"orderid"},[e._v(" 已选择订单编号: "+e._s(e.FormData.event_orderform_num)+" ")]):e._e(),e.FormData.id?e._e():a("el-button",{on:{click:function(t){e.selectOrderStatus=!0}}},[e._v("选择订单")]),e.FormData.id?e._e():a("p",{staticClass:"ordertj"},[a("span",[e._v("推荐 添加订单号可以将项目关联到订单上，方便查阅")])])],1)],1),a("el-col",[a("el-form-item",{attrs:{label:"会议名称",prop:"event_name"}},[a("el-input",{attrs:{placeholder:"会议名称",disabled:e.FormData.id},model:{value:e.FormData.event_name,callback:function(t){e.$set(e.FormData,"event_name",t)},expression:"FormData.event_name"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"开始日期",prop:"start_date"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.FormData.start_date,callback:function(t){e.$set(e.FormData,"start_date",t)},expression:"FormData.start_date"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"结束日期",prop:"end_date"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.FormData.end_date,callback:function(t){e.$set(e.FormData,"end_date",t)},expression:"FormData.end_date"}})],1)],1),a("el-col",[a("el-form-item",{attrs:{label:"客户公司名",prop:"customer_company_name"}},[a("el-input",{attrs:{placeholder:"客户公司名"},model:{value:e.FormData.customer_company_name,callback:function(t){e.$set(e.FormData,"customer_company_name",t)},expression:"FormData.customer_company_name"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"客户姓名",prop:"customer_name"}},[a("el-input",{attrs:{placeholder:"客户姓名"},model:{value:e.FormData.customer_name,callback:function(t){e.$set(e.FormData,"customer_name",t)},expression:"FormData.customer_name"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"联系电话",prop:"contact_number"}},[a("el-input",{attrs:{placeholder:"联系电话"},model:{value:e.FormData.contact_number,callback:function(t){e.$set(e.FormData,"contact_number",t)},expression:"FormData.contact_number"}})],1)],1),a("el-col",[a("el-form-item",{attrs:{label:"联系邮箱",prop:"contact_email"}},[a("el-input",{attrs:{placeholder:"联系邮箱"},model:{value:e.FormData.contact_email,callback:function(t){e.$set(e.FormData,"contact_email",t)},expression:"FormData.contact_email"}})],1)],1),a("el-col",[a("el-form-item",{attrs:{label:"参与人数",prop:"number_of_participants"}},[a("el-input",{attrs:{placeholder:"参与人数"},model:{value:e.FormData.number_of_participants,callback:function(t){e.$set(e.FormData,"number_of_participants",t)},expression:"FormData.number_of_participants"}})],1)],1),a("el-col",[a("div",{staticClass:"btnGroup"},[a("el-button",{attrs:{type:"primary"},on:{click:e.add}},[e._v(e._s(null==e.itemData?"立即添加":"确认修改"))])],1)])],1),a("el-dialog",{attrs:{title:"选择订单",visible:e.selectOrderStatus,modal:!1,width:"60%"},on:{"update:visible":function(t){e.selectOrderStatus=t}}},[a("selectOrder",{on:{selected:e.selectedorder}})],1)],1)},o=[],n=(a("e9c4"),a("0e5c"),a("2654")),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"orderList"},[a("div",{staticClass:"tips"},[e._v(" 只有已签约的订单可以被关联，行程关联订单后，将不能重新关联其他订单，请谨慎选择 ")]),a("div",{staticClass:"content"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData.List,stripe:""}},[a("el-table-column",{attrs:{prop:"num",label:"订单号"}}),a("el-table-column",{attrs:{prop:"event_name",label:"活动名称"}}),a("el-table-column",{attrs:{prop:"company_name",label:"客户公司名"}}),a("el-table-column",{attrs:{label:"操作",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"tools_btn",attrs:{size:"mini",type:"text"},on:{click:function(a){return e.select(t.$index,t.row)}}},[e._v("查看")]),a("el-button",{staticClass:"tools_btn",attrs:{size:"mini",type:"text"},on:{click:function(a){return e.onselected(t.$index,t.row)}}},[e._v("选择")])]}}])})],1),a("el-pagination",{staticClass:"pages",attrs:{background:"",layout:"prev, pager, next",total:e.tableData.Counts,"current-page":e.tableData.CurrentPage},on:{"current-change":e.currentChange}})],1)])},s=[],l={name:"orderList",data:function(){return{addProjectStatus:!1,itemData:null,tableData:{CurrentPage:1,List:[]}}},methods:{select:function(e,t){this.$router.push({name:"orderInfo_Hotel",params:{id:t.id}})},offShelf:function(e,t){var a=this;this.$api.casefrozen({id:t.id},"POST").then((function(e){a.$message({message:"冻结成功！",type:"success"}),a.GetList()}))},onDelete:function(e,t){var a=this;this.$api.casedelete({id:t.id},"POST").then((function(e){a.$message({message:"删除成功！",type:"success"}),a.GetList()}))},GetList:function(){var e=this;this.$api.orderformList({Page:this.tableData.CurrentPage,Rows:5},"POST").then((function(t){e.tableData=t}))},currentChange:function(e){this.tableData.CurrentPage=e,this.GetList()},save:function(e){var t=this;this.$api.casesave(e,"POST").then((function(a){t.$message({message:e.id?"修改成功！":"添加成功！",type:"success"}),t.addProjectStatus=!1,e.id||(t.tableData.CurrentPage=1),t.GetList()}))},onselected:function(e,t){this.$emit("selected",t)}},mounted:function(){this.GetList()}},c=l,u=(a("aad0"),a("2877")),m=Object(u["a"])(c,i,s,!1,null,"541b6b42",null),d=m.exports,p={components:{selectOrder:d},props:{itemData:null|JSON},data:function(){return{selectOrderStatus:!1,FormData:{project_manager:"",project_specialist:"",event_orderform_id:"",event_orderform_num:"",event_name:"",start_date:"",end_date:"",customer_company_name:"",customer_name:"",contact_number:"",contact_email:"",number_of_participants:""},waitUpload:[],rules:{project_manager:[{required:!0,message:"项目经理不能为空",trigger:"change"}],project_specialist:[{required:!0,message:"项目专员不能为空",trigger:"change"}],event_orderform_id:[{required:!0,message:"订单不能为空",trigger:"change"}],event_name:[{required:!0,message:"会议名称不能为空",trigger:"change"}],start_date:[{required:!0,message:"请填写开始时间",trigger:"change"}],end_date:[{required:!0,message:"请填写结束时间",trigger:"change"}],customer_company_name:[{required:!0,message:"请填写客户公司名称",trigger:"change"}],customer_name:[{required:!0,message:"请填写客户姓名",trigger:"change"}],contact_number:[{required:!0,message:"请填写联系电话",trigger:"change"},{validator:n["i"],trigger:"blur"}],contact_email:[{required:!0,message:"请填写联系邮箱",trigger:"change"},{validator:n["h"],trigger:"blur"}],number_of_participants:[{required:!0,message:"请填写参与人数",trigger:"change"},{validator:n["e"],trigger:"change"}]},userList:[]}},mounted:function(){var e=this;null!=this.itemData&&(this.FormData=JSON.parse(JSON.stringify(this.itemData))),this.$api.memberList({Page:1,Rows:999},"POST").then((function(t){e.userList=t.List}))},methods:{add:function(){var e=this;this.$refs["ruleForm"].validate((function(t){if(!t)return console.log("error submit!!"),!1;e.$emit("onColse",e.FormData)}))},handlePreviewImage:function(e){this.waitUpload.push(e)},selectedorder:function(e){this.FormData.event_orderform_id=e.id,this.FormData.event_orderform_num=e.num,this.FormData.event_name=e.event_name,this.FormData.start_date=e.event_startdate,this.FormData.end_date=e.event_enddate,this.FormData.customer_company_name=e.company_name,this.FormData.customer_name=e.fullname,this.FormData.contact_number=e.mobile,this.FormData.contact_email=e.email,this.FormData.number_of_participants=e.attendee_no,this.selectOrderStatus=!1}}},f=p,_=(a("01fb"),Object(u["a"])(f,r,o,!1,null,"14188050",null));t["a"]=_.exports},aad0:function(e,t,a){"use strict";a("5c62")}}]);