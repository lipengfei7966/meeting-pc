(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-da0ddf76"],{"0e5c":function(t,e,a){"use strict";a("d3b7");var n=a("5829"),i=a("2b0e");e["a"]=function(t){return new Promise((function(e,a){var o=[],s={},r=t.length;console.log(t.length,t);var l=function a(){return 0==t.length?e(o):String(t[0].file).IsPicture()?(t.shift(),a()):void n["a"].upload({file:t[0].file},"POST",{type:"form"}).then((function(n){console.log(n);var l=!0;if(void 0!=n&&""==n.FilePath&&""==n.OriginalFileName&&(console.log("重复了"),n=void 0,l=!1),void 0==n&&l){i["default"].prototype.$alert("网络不稳定, 文件上传失败, 请重新上传","提示",{confirmButtonText:"确定",callback:function(t){i["default"].prototype.$message({message:"上传失败的文件已标记",type:"warning"})}});var c=r-t.length;return e({tag:c,uploadImageList:o})}s=n,o.push(s),t.shift(),a()}))};l()}))}},"475d":function(t,e,a){},"5c57":function(t,e,a){"use strict";a("475d")},"5ec9":function(t,e,a){},"7d53":function(t,e,a){"use strict";a("5ec9")},f48b:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=this,a=e.$createElement,n=e._self._c||a;return n("div",{staticClass:"CaseStudy"},[n("div",{staticClass:"title"},[e._v("案例管理")]),n("div",{staticClass:"content"},[n("div",{staticClass:"tools"},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addCaseStudyStatus=!0}}},[e._v("添加新案例")])],1),n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData.List,stripe:"",height:"100%"}},[n("el-table-column",{attrs:{type:"index",width:"50"}}),n("el-table-column",{attrs:{prop:"name",label:"案例名称"}}),n("el-table-column",{attrs:{prop:"content",label:"案例介绍",width:"200"}}),n("el-table-column",{attrs:{prop:"statusname",label:"状态"}}),n("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{staticClass:"tools_btn",attrs:{size:"mini",type:"text"},on:{click:function(a){return e.update(t.$index,t.row)}}},[e._v("编辑")]),"0017-1"===t.row.status?n("el-popconfirm",{attrs:{"confirm-button-text":"冻结","cancel-button-text":"取消",icon:"el-icon-info","icon-color":"red",title:"确定要冻结此案例吗？"},on:{confirm:function(a){return e.offShelf(t.$index,t.row)}}},[n("el-button",{staticClass:"tools_btn",attrs:{slot:"reference",size:"mini",type:"text"},slot:"reference"},[e._v("冻结")])],1):n("el-popconfirm",{attrs:{"confirm-button-text":"激活","cancel-button-text":"取消",icon:"el-icon-info","icon-color":"red",title:"确定要激活此案例吗？"},on:{confirm:function(a){return e.onShelf(t.$index,t.row)}}},[n("el-button",{staticClass:"tools_btn",attrs:{slot:"reference",size:"mini",type:"text"},slot:"reference"},[e._v("激活")])],1),n("el-popconfirm",{attrs:{"confirm-button-text":"删除","cancel-button-text":"取消",icon:"el-icon-info","icon-color":"red",title:"确定要删除此案例吗？"},on:{confirm:function(a){return e.onDelete(t.$index,t.row)}}},[n("el-button",{staticClass:"tools_btn",attrs:{slot:"reference",size:"mini",type:"text"},slot:"reference"},[e._v("删除")])],1)]}}])})],1),n("el-pagination",{staticClass:"pages",attrs:{background:"",layout:"prev, pager, next",total:e.tableData.Counts,"current-page":e.tableData.CurrentPage},on:{"current-change":e.currentChange}})],1),n("el-dialog",{attrs:{title:"添加新案例",visible:e.addCaseStudyStatus,"before-close":function(e){t.itemData=null,e()},width:"500px"},on:{"update:visible":function(t){e.addCaseStudyStatus=t}}},[e.addCaseStudyStatus?n("caseStudyAdded",{attrs:{"item-data":e.itemData},on:{onColse:e.save}}):e._e()],1)],1)},i=[],o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"case-study-added"},[a("el-form",{ref:"ruleForm",attrs:{"label-width":"110px",model:t.FormData,rules:t.rules}},[a("el-form-item",{attrs:{label:"案例名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"案例名称"},model:{value:t.FormData.name,callback:function(e){t.$set(t.FormData,"name",e)},expression:"FormData.name"}})],1),a("el-form-item",{attrs:{label:"案例介绍",prop:"content"}},[a("el-input",{attrs:{type:"textarea",placeholder:"案例介绍",rows:"5"},model:{value:t.FormData.content,callback:function(e){t.$set(t.FormData,"content",e)},expression:"FormData.content"}})],1),a("el-form-item",{attrs:{label:"上传案例图片",prop:"picture"}},[a("el-upload",{ref:"upload",attrs:{action:"","on-change":t.handleChangeAttach,"on-remove":t.handleRemoveAttach,"auto-upload":!1,"file-list":this.waitUpload,multiple:!1,accept:".jpg,.jpeg,.png"}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[t._v("从电脑选择文件")]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v(" 只能上传jpg/png文件,大小不超过2M (可上传多张) ")]),t.FormData.picture?a("div",{staticClass:"yl"},t._l(t.FormData.picture,(function(t,e){return a("img",{key:"image_"+e,attrs:{src:t,alt:""}})})),0):t._e()],1)],1),a("div",{staticClass:"btnGroup"},[a("el-button",{attrs:{type:"primary"},on:{click:t.add}},[t._v(t._s(null==t.itemData?"立即添加":"确认修改"))])],1)],1)],1)},s=[],r=(a("e9c4"),a("ac1f"),a("1276"),a("d3b7"),a("159b"),a("0e5c")),l={props:{itemData:null|JSON},data:function(){return{FormData:{name:"",picture:[],content:""},waitUpload:[],rules:{name:[{required:!0,message:"请输入案例名称",trigger:"change"}],content:[{required:!0,message:"请输入介绍",trigger:"change"}]}}},mounted:function(){null!=this.itemData&&(this.FormData=JSON.parse(JSON.stringify(this.itemData)),this.FormData.picture=this.FormData.picture.split(","))},methods:{add:function(){var t=this;this.$refs["ruleForm"].validate((function(e){if(!e)return console.log("error submit!!"),!1;var a=[];t.waitUpload.forEach((function(t,e){var n={key:e,file:t.raw};a.push(n)})),Object(r["a"])(a).then((function(e){var a=[];for(var n in e)a.push(e[n].FilePath);t.FormData.picture=a.toString(),t.$emit("onColse",t.FormData)}))}))},handleChangeAttach:function(t,e){var a="image/jpeg"===t.raw.type,n="image/png"===t.raw.type,i=t.size/1024/1024<2;if(!a&&!n||!i)return a&&n?this.$message.error("上传图片大小不能超过 2MB!"):this.$message.error("上传图片只能是 JPG 或者 PNG 格式!"),void this.$refs.upload.handleRemove(t);this.waitUpload=e},handleRemoveAttach:function(t,e){this.waitUpload=e}}},c=l,u=(a("7d53"),a("2877")),d=Object(u["a"])(c,o,s,!1,null,"50dfe3c6",null),p=d.exports,f={name:"CaseStudy",components:{caseStudyAdded:p},data:function(){return{addCaseStudyStatus:!1,itemData:null,tableData:{CurrentPage:1,List:[]}}},methods:{update:function(t,e){this.itemData=e,this.addCaseStudyStatus=!0},onShelf:function(t,e){var a=this;this.$api.caseactivation({id:e.id},"POST").then((function(t){console.log(t),a.$message({message:"激活成功！",type:"success"}),a.GetList()}))},offShelf:function(t,e){var a=this;this.$api.casefrozen({id:e.id},"POST").then((function(t){console.log(t),a.$message({message:"冻结成功！",type:"success"}),a.GetList()}))},onDelete:function(t,e){var a=this;this.$api.casedelete({id:e.id},"POST").then((function(t){a.$message({message:"删除成功！",type:"success"}),a.GetList()}))},GetList:function(){var t=this;this.$api.caselist({Page:this.tableData.CurrentPage,Rows:10},"POST").then((function(e){t.tableData=e}))},currentChange:function(t){this.tableData.CurrentPage=t,this.GetList()},save:function(t){var e=this;this.$api.casesave(t,"POST").then((function(a){console.log(a),e.$message({message:t.id?"修改成功！":"添加成功！",type:"success"}),e.addCaseStudyStatus=!1,t.id||(e.tableData.CurrentPage=1),e.GetList()}))}},mounted:function(){this.GetList()}},m=f,h=(a("5c57"),Object(u["a"])(m,n,i,!1,null,"1f3cb41f",null));e["default"]=h.exports}}]);